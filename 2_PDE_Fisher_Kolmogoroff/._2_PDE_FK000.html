<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Geographic models with focus on Fisher Kolmogoroff equation">



<style type="text/css">
    /* blueish style */

    /* Color definitions:  http://www.december.com/html/spec/color0.html
       CSS examples:       http://www.w3schools.com/css/css_examples.asp */

    body {
      margin-top: 1.0em;
      background-color: #ffffff;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    h1 { font-size: 1.8em; color: #1e36ce; }
    h2 { font-size: 1.6em; color: #1e36ce; }
    h3 { font-size: 1.4em; color: #1e36ce; }
    a { color: #1e36ce; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Introduction ', 2, None, '___sec0'),
              (' Fisher-Kolmogoroff equation ', 2, None, '___sec1'),
              (' Simple system for spatial spread ', 2, None, '___sec2'),
              (' Verifying the solution ', 2, None, '___sec3'),
              (' Constant solution ', 3, None, '___sec4'),
              (' Manufactured solution ', 3, None, '___sec5'),
              (' Convergence rate ', 3, None, '___sec6'),
              (' The spatial error ', 3, None, '___sec7'),
              (' The temporal error ', 3, None, '___sec8'),
              (' Travelling wave in 2D ', 2, None, '___sec9'),
              (' A gaussian wave ', 3, None, '___sec10'),
              (' Change in initial flow ', 3, None, '___sec11'),
              (' Change in lambda ', 3, None, '___sec12'),
              (' Epidemic in an English Boarding School 1978 ',
               1,
               None,
               '___sec13'),
              (' Zombiefication ', 1, None, '___sec14'),
              (' Start from the middle ', 3, None, '___sec15'),
              (' Variation in diffusion ', 3, None, '___sec16'),
              (' Where does the infected one arises ', 3, None, '___sec17'),
              (' Lock in different areas ', 3, None, '___sec18'),
              (' Appendix ', 1, None, '___sec19'),
              (' Discretization ', 2, None, '___sec20'),
              (' 2D Gaussian function from x=0 ', 2, None, '___sec21'),
              (' 2D Gaussian function from x=0,y=0 ', 2, None, '___sec22'),
              (' 2D Gaussian function from x=0,y=0 with higher initial value ',
               2,
               None,
               '___sec23'),
              (' English Boarding School ', 2, None, '___sec24')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




    
<a name="part0000"></a>
<!-- begin top navigation -->
<a href="._2_PDE_FK001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- ------------------- main content ---------------------- -->


<title>Geographic models with focus on Fisher Kolmogoroff equation</title>

<center><h1>Geographic models with focus on Fisher Kolmogoroff equation</h1></center>  <!-- document title -->

<p>
<!-- author(s): Torbj&#248;rn Seland -->

<center>
<b>Torbj&#248;rn Seland</b> 
</center>


<p>
<!-- institution(s) -->
<p>
<center><h4>Nov 7, 2014</h4></center> <!-- date -->

<h2>Table of contents</h2>

&nbsp; &nbsp; &nbsp; <a href="#___sec0"> Introduction </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec1"> Fisher-Kolmogoroff equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Simple system for spatial spread </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec3"> Verifying the solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec4"> Constant solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec5"> Manufactured solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec6"> Convergence rate </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec7"> The spatial error </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec8"> The temporal error </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec9"> Travelling wave in 2D </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec10"> A gaussian wave </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec11"> Change in initial flow </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec12"> Change in lambda </a><br>
<a href="#___sec13"> Epidemic in an English Boarding School 1978 </a><br>
<a href="._2_PDE_FK001.html#___sec14"> Zombiefication </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK001.html#___sec15"> Start from the middle </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK001.html#___sec16"> Variation in diffusion </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec17"> Where does the infected one arises </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec18"> Lock in different areas </a><br>
<a href="._2_PDE_FK002.html#___sec19"> Appendix </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec20"> Discretization </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec21"> 2D Gaussian function from x=0 </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec22"> 2D Gaussian function from x=0,y=0 </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec23"> 2D Gaussian function from x=0,y=0 with higher initial value </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec24"> English Boarding School </a><br>
</p>

<h2>Introduction  <a name="___sec0"></a></h2>
This chapter will introduce a new model for epidemic diseases. While the first chapter was based on a ODE system, will this chapter expand the system to consist of a geographic spread of epidemics. The two first sections will be based on chapters from Murray, while the last part will consist of a modelling of the zombiefication problem explained in chapter 1.

<h2>Fisher-Kolmogoroff equation  <a name="___sec1"></a></h2>

<h2>Simple system for spatial spread  <a name="___sec2"></a></h2>
While the systems in the previous chapter only consisted of the temporal variable <b>t</b> in the functions, a spatial variable, <b>x</b> will now be introduced. This means that the position has an effect on the change in each class. The system that will be shown here, will be based on the simple ODE system presented in the previous chapter. The difference will be the diffusion part added to each equation. The system can be seen under 
$$
\begin{equation} \tag{1}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -rIS + D\nabla ^2 S\\
	\frac{\partial I}{\partial t} &= rIS- aI + D\nabla ^2 I\\
	\frac{\partial R}{\partial t} &= aI + D\nabla ^2 R
	\end{aligned}
\end{equation}
$$

All three classes have the same diffusion coefficient, \( D \). \( rIS \) and \( aI \) will work in the same way as in the ODE system. Since this model taking into account the position, the idea is here to model a group of infective that moves into a uniform population with susceptible, which is spread around with the density \( S_0 \). Then the geotemporal spread can be seen. The problem will be consider as one-dimensional. The system will first be nondimensionalise by writing 
$$
\begin{equation} \tag{2}
	\begin{aligned}
	I^* =\frac{I}{S_0},&\quad I^* = \frac{I}{S_0},&\quad R^*= \frac{R}{S_0},&\\
	x^* =\left(\frac{rS_0}{D}\right)^{1/2}x,&\quad t^*=rS_0t,&\quad \lambda =\frac{a}{rS_0},&
	\end{aligned}
\end{equation}
$$

\( S_0 \) is here used as a representative population. Now the model<a href="#mjx-eqn-1">(1)</a> can be expressed under. Here the asterisks have been dropped.
$$
\begin{equation} \tag{3}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2},\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2},\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

The three parameters \( r \), \( a \) and \( D \) have now been replaced by \( \lambda \). The <em>reproduction rate</em> that was presented for the ODE model in the previous chapter can be seen by \( 1/\lambda  \). This has here a couple of equivalent meanings. \( 1/\lambda \) can be seen as the number of secondary infections produced by one primary infected. It can also be used to measure two different time scales. The first one, \( 1/(rS_0) \), measure the contagious time of the disease. The second one can look at the life expectancy for an infective. This can be described \( 1/a \).
<br />
<br />
The problem that this part will focus on, is the travelling wave. Here seen by a pulse of infected into a group of susceptible. Then a travelling wave solution has to be set,
$$
\begin{equation}
I(x,t)=I(z),\quad S(x,t)=S(z),\quad R(x,t) = R(z),\quad z = x-ct,
\end{equation}
$$

Here the value \( c \) will be the wave speed. This represents a wave of constant shape that travels in the positive x-direction. These can now be inserted into <a href="#mjx-eqn-3">(3)</a>. This gives the following ordinary system
$$
\begin{equation} \tag{4}
	\begin{aligned}
	S'' + cS' - IS &= 0,\\
	I'' + cI' + I(S-\lambda)&=0\\
	R'' + cR  + I\lambda &=0
	\end{aligned}
\end{equation}
$$

This gives an eigenvalue problem to find the range of \( \lambda \) so that \( c \) always will be positive. The values of \( S \), \( I \) and \( R \) also has to stay nonnegative. This leads to
$$
\begin{equation} 
	\begin{aligned}
	0 \leq S(-\infty) < S(\infty)&=1\\
	I(-\infty)=I(\infty)&=0,\\
	1 \geq R(-\infty)\geq R(\infty) &= 0
	\end{aligned}
\end{equation}
$$


<p>
<!-- MOVIE:[plots/Travelling_wave.webm, height=500 width=600] This simulation is based on <a href="#mjx-eqn-4">(4)</a> with \( \lambda=0.5 \). The initial data is sat to \( S(x,0)=1 \) and \( R(x,0)=0 \). The left side of the <em>Infective</em> class, $I(0,0), is based on a gaussian curve. The rest is sat to be zero. -->

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 1:  <a name="fig:1D_sub"></a> A gauss curve is inserted on the left side. This causes a travelling wave. The size is measured at \( x=15 \) and can be seen in figure (<a href="#fig:1D_tw">2</a>). </p></center>
<p><img src="plots/trav_wave_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 2:  <a name="fig:1D_tw"></a> This shows the epidemic wave measures at at \( x=15 \) in figure(<a href="#fig:1D_sub">1</a>) </p></center>
<p><img src="plots/epidemic_wave_z_lambda_0_5.png" align="bottom" ></p>
</center>

<p>
The system<a href="#mjx-eqn-4">(4)</a> is a fourth order phase space system. The lower bound time speed for \( c \) can be found. J.D Murray shows this in <em>kite{Murray}</em>. The <em>Infective</em> class in the system<a href="#mjx-eqn-4">(4)</a> can be linearised when \( z\rightarrow \infty \) $S\rightarrow 1$ and \( I \rightarrow 0 \). The result then become 
$$
\begin{equation}
	I'' + cI' + I(S-\lambda) \approx 0 
\end{equation}
$$

This can be found by
$$
\begin{equation}
I(z) \varpropto \exp\left[(-c \pm {c^2 -4(1-\lambda)}^{1/2})z/2\right]
\end{equation}
$$

It is required that \( I(z)\rightarrow 0 \), but not under. This means that the solution cannot oscillate around 0. If a travelling wave exist, it has to satisfy
$$
\begin{equation}
	c \geq 2(1-\lambda)^{1/2}, \lambda< 1
\end{equation}
$$

If \( \lambda > 1 \), no travelling wave will exist. Then the disease will die out. The terms defined in <a href="#mjx-eqn-2">(2)</a> will give the threshold conditions,
$$
\begin{equation}
	\lambda = \frac{a}{rS_0} < 1
\end{equation}
$$

This is the same value that was given for the ODE model in the previous chapter.

<h2>Verifying the solution  <a name="___sec3"></a></h2>

<h3>Constant solution  <a name="___sec4"></a></h3>

To verify this solution a couple of tests can be done one the system. The first test will be a constant test, where a known constant solution is given. A look at the previous system will give an idea on performing the test.
$$
\begin{equation} \tag{7}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2},\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2},\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

By setting the solutions to constants, \( S = C_s,I=C_i,R=C_r \), the value of \( C_i \) has to be 0. This is a poor test and several bugs can escape. The following system can be expanded by adding \( \beta R \) to the system. This give the chance to check the value of \( R \) and the constants can be set to a different value than 0.  
$$
\begin{equation} \tag{6}
	\begin{aligned}
	C_IC_S &= \beta C_r \\
	C_IC_S &= \lambda C_I \\
	\lambda C_I &= -\beta C_R 
	\end{aligned}
\end{equation}
$$

The constant values can freely be chosen. Here they are sat to \( C_S = 1.2,C_I=0.8,C_R=0.6 \). This give \( \lambda=1.2 \) and \( \beta=1.6 \). A test can be made

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_constant_solution</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Test problem where u=u_const is the exact solution, to be</span>
<span style="color: #BA2121; font-style: italic">    reproduced (to machine precision) by any relevant method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution</span>(t):
        <span style="color: #008000; font-weight: bold">return</span> C_s,C_i,C_r
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">lam</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> C_s

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">beta</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (C_s<span style="color: #666666">*</span>C_i)<span style="color: #666666">/</span><span style="color: #008000">float</span>(C_r)

    <span style="color: #408080; font-style: italic">#Constant values</span>
    C_s <span style="color: #666666">=</span> <span style="color: #666666">1.2</span>
    C_i <span style="color: #666666">=</span> <span style="color: #666666">0.8</span>
    C_r <span style="color: #666666">=</span> <span style="color: #666666">0.6</span>
    
    <span style="color: #408080; font-style: italic">#lam = C_s</span>
    <span style="color: #408080; font-style: italic">#beta = (lam*C_i)/float(C_r)</span>
    
    T <span style="color: #666666">=</span> <span style="color: #666666">2</span>; Nt <span style="color: #666666">=</span> <span style="color: #666666">200</span>
    X <span style="color: #666666">=</span> <span style="color: #666666">20</span>; Nx <span style="color: #666666">=</span> <span style="color: #666666">40</span>
    S_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_s
    I_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_i
    R_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_r
    
    t,x,S,I,R <span style="color: #666666">=</span> simple_PDE(T,Nx,Nt,X,lam,beta,S_1,I_1,R_1)
    
    S_e,I_e,R_e <span style="color: #666666">=</span> exact_solution(t)
    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(S_e <span style="color: #666666">-</span> S)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I_e <span style="color: #666666">-</span> I)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(R_e <span style="color: #666666">-</span> R)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol
</pre></div>
<p>
This test was fine and next test that can be done on the system is a Manufactured solution

<h3>Manufactured solution  <a name="___sec5"></a></h3>

By constructing a function to each equation in the system <a href="#mjx-eqn-3">(3)</a>, a manufactured solution can be created. Here \( S \),$I$ and \( R \) are pre produced. The system will be
$$
\begin{equation} \tag{7}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2}+f(x,t),\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2}+g(x,t),\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2}+h(x,t),
	\end{aligned}
\end{equation}
$$

where \( f \),$g$ and \( h \) are constructed functions to achieve the expected results for \( S \), \( I \) and \( R \). In this case the functions will be:
$$
\begin{equation}
	\begin{aligned}
	f(x,t) = \frac{\partial S}{\partial t} + IS - \frac{\partial^2 S}{\partial x^2}\\
	g(x,t) = \frac{\partial I}{\partial t} - IS + \lambda I - \frac{\partial^2 I}{\partial x^2}\\
	h(x,t) = \frac{\partial R}{\partial t} -\lambda I - \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

When choosing the expected function for the classes, it is important that the fulfill the boundary conditions
$$
\begin{equation}
    u_x(0,t) = u_x(X,t) = 0
\end{equation}
$$

The quantities have here been sat to:
$$
\begin{equation}
	\begin{aligned}
    S(x,t) = cos(\frac{\pi}{X}x)t\\
    I(x,t) = cos(\frac{\pi}{X}x)t\\
    R(x,t) = cos(\frac{\pi}{X}x)t
	\end{aligned}
\end{equation}
$$

Now <code>sympy</code> can be used to do the calculations

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x,t,lam <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;x t lam&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s_simple</span>(x,t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> cos(pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span> 
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">i_simple</span>(x,t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> cos(pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span> 
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">r_simple</span>(x,t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> cos(pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span> 
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">for</span> x_point <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">0</span>,<span style="color: #666666">1</span>:
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;s_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span>, <span style="color: #666666">%</span> x_point,
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">for</span> x_point <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">0</span>,<span style="color: #666666">1</span>:
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;s_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(s_simple(x,t),x)<span style="color: #666666">.</span>subs(x,x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;i_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(i_simple(x,t),x)<span style="color: #666666">.</span>subs(x,x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;r_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(r_simple(x,t),x)<span style="color: #666666">.</span>subs(x,x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span> 
s_x(<span style="color: #666666">0</span>,t):  <span style="color: #666666">0</span>
i_x(<span style="color: #666666">0</span>,t):  <span style="color: #666666">0</span>
r_x(<span style="color: #666666">0</span>,t):  <span style="color: #666666">0</span>
s_x(<span style="color: #666666">1</span>,t):  <span style="color: #666666">0</span>
i_x(<span style="color: #666666">1</span>,t):  <span style="color: #666666">0</span>
r_x(<span style="color: #666666">1</span>,t):  <span style="color: #666666">0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> s_simple(x,t)
<span style="color: #666666">&gt;&gt;&gt;</span> i <span style="color: #666666">=</span> i_simple(x,t)
<span style="color: #666666">&gt;&gt;&gt;</span> r <span style="color: #666666">=</span> r_simple(x,t)
<span style="color: #666666">&gt;&gt;&gt;</span> f <span style="color: #666666">=</span> diff(s,t)<span style="color: #666666">+</span>i<span style="color: #666666">*</span>s<span style="color: #666666">-</span>diff(diff(s,x),x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> f<span style="color: #666666">.</span>simplify()
(t<span style="color: #666666">**2*</span>cos(pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>cos(pi<span style="color: #666666">*</span>x)
<span style="color: #666666">&gt;&gt;&gt;</span> g <span style="color: #666666">=</span> diff(i,t)<span style="color: #666666">-</span>i<span style="color: #666666">*</span>s<span style="color: #666666">+</span>lam<span style="color: #666666">*</span>i<span style="color: #666666">-</span>diff(diff(i,x),x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> g<span style="color: #666666">.</span>simplify()
(lam<span style="color: #666666">*</span>t <span style="color: #666666">-</span> t<span style="color: #666666">**2*</span>cos(pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>cos(pi<span style="color: #666666">*</span>x)
<span style="color: #666666">&gt;&gt;&gt;</span> h <span style="color: #666666">=</span> diff(r,t)<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>i<span style="color: #666666">-</span>diff(diff(r,x),x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> h<span style="color: #666666">.</span>simplify()
(<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>t <span style="color: #666666">+</span> pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>cos(pi<span style="color: #666666">*</span>x)
</pre></div>
<p>
Which give
$$
\begin{equation}
	\begin{aligned}
	f(x,t) &= (t^2\cos(\pi x) + \pi^2t + 1)\cos(\pi x)\\
	g(x,t) &= (\lambda t - t^2\cos(\pi x) + \pi^2t + 1)\cos(\pi x)\\
	h(x,t) &= (-\lambda t + \pi^2t + 1)\cos(\pi x)
	\end{aligned}
\end{equation}
$$


<p>
The following manufactured test will then be
<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_manufactured_solution</span>(T,Nt,X,Nx):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Test problem where u=c*t+I is the exact solution, to be</span>
<span style="color: #BA2121; font-style: italic">    reproduced (to machine precision) by any relevant method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_S</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_I</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_R</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t


    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">beta</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> exact_solution_S(t,x)<span style="color: #666666">*</span>exact_solution_I(t,x)<span style="color: #666666">/</span>exact_solution_R(t,x)
    lam <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (t<span style="color: #666666">**2*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) 

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (lam<span style="color: #666666">*</span>t <span style="color: #666666">-</span> t<span style="color: #666666">**2*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">h</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>t <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)
        

    dx <span style="color: #666666">=</span> X<span style="color: #666666">/</span><span style="color: #008000">float</span>(Nx)
    dt <span style="color: #666666">=</span> T<span style="color: #666666">/</span><span style="color: #008000">float</span>(Nt)
    S_1 <span style="color: #666666">=</span> exact_solution_S(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
    I_1 <span style="color: #666666">=</span> exact_solution_I(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
    R_1 <span style="color: #666666">=</span> exact_solution_R(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
     
    t,x,S,I,R <span style="color: #666666">=</span> simple_PDE(T,Nx,Nt,X,lam,beta,S_1,I_1,R_1,f,g,h)
    S_e <span style="color: #666666">=</span> exact_solution_S(t[<span style="color: #666666">-1</span>],x)
    I_e <span style="color: #666666">=</span> exact_solution_I(t[<span style="color: #666666">-1</span>],x)
    R_e <span style="color: #666666">=</span> exact_solution_R(t[<span style="color: #666666">-1</span>],x)
    
    difference_S <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(S_e <span style="color: #666666">-</span> S)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>

    
    <span style="color: #408080; font-style: italic">#for i in range(4):</span>
    <span style="color: #408080; font-style: italic">#    print &quot;n&quot;,i,&quot;S_e&quot;,exact_solution_S(t[i],x)</span>
    
    <span style="color: #408080; font-style: italic">#print &quot;S&quot;,S</span>
    <span style="color: #408080; font-style: italic">#t_tot = np.sum(t[:-1])</span>
    <span style="color: #408080; font-style: italic">#print &quot;t_tot&quot;,t_tot</span>
    <span style="color: #408080; font-style: italic">#difference_exp = t_tot*dt*np.cos(x*np.pi)*((2*(np.cos(np.pi*dx)-1))/dx**2+np.pi**2)</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff_exp&quot;, (abs(difference_exp)).max()</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;diff&quot;</span>,difference_S
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
    
    difference_I <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I_e <span style="color: #666666">-</span> I)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff&quot;,difference_I</span>
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
   
    difference_R <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(R_e <span style="color: #666666">-</span> R)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff&quot;,difference_R</span>
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
    <span style="color: #008000; font-weight: bold">return</span> difference_S,difference_I,difference_R
</pre></div>

<h3>Convergence rate  <a name="___sec6"></a></h3>

The program can be controlled by checking the convergence rate. The error term can be described as  
$$
\begin{equation} \tag{8}
    \epsilon = C_x\Delta x^2 + C_t \Delta t
\end{equation}
$$

With equation(ref{eq:error}, the expected convergence rate can be found for both \( \Delta x \) and \( \Delta t \). To be able to separate the \( \Delta \)'s, the other value has to be close to eliminated. If the value for \( \Delta x \) wants to be found,  \( \Delta t \ll \Delta x \) has to be fullfilled. This will lead to \( C_t\Delta t \approx 0 \), and the error term for \( \Delta x \) can be found. The opposite thing can  be done for \( \Delta t \). A table for the error is produced for different values for \( \Delta t = 0.05 \) and \( \Delta x=0.1 \).

<p>
<table border="1">
<thead>
<tr><th align="center">      </th> <th align="center">  dx  </th> <th align="center"> dx/2 </th> <th align="center"> dx/4 </th> <th align="center"> dx/8 </th> </tr>
</thead>
<tbody>
<tr><td align="center">   dt        </td> <td align="center">   9.8E-3    </td> <td align="center">   -         </td> <td align="center">   -         </td> <td align="center">   -         </td> </tr>
<tr><td align="center">   dt/4      </td> <td align="center">   9.9E-3    </td> <td align="center">   2.5E-3    </td> <td align="center">   -         </td> <td align="center">   -         </td> </tr>
<tr><td align="center">   dt/8      </td> <td align="center">   9.9E-3    </td> <td align="center">   2.5E-3    </td> <td align="center">   6.1E-4    </td> <td align="center">   -         </td> </tr>
<tr><td align="center">   dt/16     </td> <td align="center">   9.9E-3    </td> <td align="center">   2.5E-3    </td> <td align="center">   6.1E-4    </td> <td align="center">   1.5E-4    </td> </tr>
</tbody>
</table>
<!-- 0.00988006143376,0.00246039081619,-,- -->
<!-- 0.00988361769746,0.00246127510994,0.000614719954035 -->
<!-- 0.00988450717896,0.00246149628689,0.000614775174047,0.000153656409034 -->

<h3>The spatial error  <a name="___sec7"></a></h3>

The table above gives an insight on how the error develops when reducing \( \Delta t \) and \( \Delta x \). By studying the row where \( \Delta t/16 \), the \( C_t \Delta t \) can be seen as close to negligible in equation(ref{eq:error}. The error can then be expressed 
$$
\begin{equation}
    \epsilon \propto \Delta x^r
\end{equation}
$$

The value is expected to be \( r=2 \), since Crank Nicolson is used in the spatial discretization. This gives a 2.order error. By comparing the error for different \( \Delta x \), the convergence rate, \( r \), can be expressed, 
$$
\begin{equation} \tag{9}
 r_{12} \simeq \frac{\log(\epsilon_1/\epsilon_2)}{\log(\Delta x_1/\Delta x_2)}
\end{equation}
$$

Since the table above has four different error values, these can be used to give three different convergence rates. \( \Delta x_1 = dx, \Delta x_2 = dx/2... \). The same labeling will be done for the different error values, \( \epsilon \).
<table border="1">
<thead>
<tr><th align="center">           ------          </th> <td align="center">\( \epsilon_1/\epsilon_2 \)</td> <td align="center">\( \epsilon_2/\epsilon_3 \)</td> <td align="center">\( \epsilon_3/\epsilon_4 \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   r                              </td> <td align="center">   2.0056                         </td> <td align="center">   2.0014                         </td> <td align="center">   2.0004                         </td> </tr>
</tbody>
</table>

<h3>The temporal error  <a name="___sec8"></a></h3>

The temporal error is quite hard to find because the <em>Stability criteria</em> which is about
$$
\begin{equation} \tag{10}
 2\Delta t \leq \Delta x^2
\end{equation}
$$

This results in the case that \( \Delta x \ll \Delta t \) is impossible, because this only leads to an unstable solution. By looking at the column for \( \frac{\Delta x}{8} \), the only stable solution is for \( {\Delta t}{16} \). Therefore the technique used for the spatial error cannot be used here. By studying the diagonal numbers in the table, the expected convergence rate is fulfilled for both \( \Delta x \), which gives \( r = 2 \) and for \( \Delta t \) that gives \( r=1 \)

<h2>Travelling wave in 2D  <a name="___sec9"></a></h2>
The model can be discretized for a 2D simulation since an epidemic disease will spread geographically. The non dimensional system <a href="#mjx-eqn-3">(3)</a> used in the 1D simulation above can be discretized with Forward Euler in time and Crank Nicolson in space
$$
\begin{equation}
	\begin{aligned}
    \frac{S^{n+1}_{i,j}-S^n_{i,j}}{\Delta t} &= -I^{n}_{i,j}S^{n}_{i,j} + \left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{I^{n+1}_{i,j}-I^n_{i,j}}{\Delta t} &= I^{n}_{i,j}S^{n}_{i,j} -\lambda I^{n}_{i,j} + \left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{R^{n+1}_{i,j}-R^n_{i,j}}{\Delta t} &= \lambda I^{n}_{i,j}+\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right) 
	\end{aligned}
\end{equation}
$$

Now the known values can be placed on the right side. The system will then be
$$
\begin{equation}
	\begin{aligned}
    S^{n+1}_{i,j} &= S^{n}_{i,j}+\Delta t\left(-I^{n}_{i,j}S^{n}_{i,j} + \left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right)\right) \\
    I^{n+1}_{i,j} &= I^{n}_{i,j}+\Delta t\left(I^{n}_{i,j}S^{n}_{i,j} -\lambda I^{n}_{i,j} + \left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right)\right) \\
    R^{n+1}_{i,j} &= R^{n}_{i,j}+\Delta t\left(\lambda I^{n}_{i,j}+\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right)\right) 
	\end{aligned}
\end{equation}
$$

This results in an explicit system, which is easy to code. It consist of known values on the right side and only one unknown on the left side.

<h3>A gaussian wave  <a name="___sec10"></a></h3>

In the PDE system for the 1D equation, a Gaussian quantity of infected humans was placed on the left side in the initial value. This resulted in a wave of infected spread along the x-axis. A similar thing can be done for the 2D simulation. A couple of simulations have been done for the 2D system. The first simulation is run for a Gaussian function along \( x=0 \) and the second simulation is run for a Gaussian function from \( x=0,y=0 \) for the infected humans as initial value. Both simulations can be seen in the Appendix.  

<p>
By studying the travelling wave at a certain point, the size of the epidemic wave can be measured and compared. In these two 2D simulations, the wave will be measured in the point (15,15) while the travelling wave in the 1D simulation was measured in point(15). The two travelling waves can be seen in the figure(<a href="#fig:2D_trav_wave">3</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 3:  <a name="fig:2D_trav_wave"></a> Travelling wave measured at point (15,15) with two different initial values for the Infected class. The initial value is sat as a Gaussian line along (0,y) in the left plot and as a Gaussian point (0,0) in the right plot </p></center>
<p><img src="plots/Trav_wave_2D.png" align="bottom" height=400 width=800></p>
</center>

<p>
The shape of these two travelling waves are similar. The only difference is the time when the wave occur. The plot for 1D wave in fig(<a href="#fig:1D_tw">2</a>) has the same shape. With a closer study, the area under the function can be measured for all three cases. The result can be seen in the table below.   

<p>
<!-- 1D -->
<!-- 1.4340793845 -->
<!-- 1.43143259034 dt = \( 1\cdot10^{-3} \), dx = 0.05 -->
<!-- 1.43195870243 dt = 0.0002, dx^2 = 0.000625 -->
<!-- 2D wave line: -->
<!-- 1.43345609926 dt =0.0004, dx^2 =  0.0016 -->
<!-- 2D wave point: -->
1.43352971688
<table border="1">
<thead>
<tr><th align="center">   1D wave   </th> <th align="center"> 2D wave line</th> <th align="center">2D wave point</th> </tr>
</thead>
<tbody>
<tr><td align="center">   1.43             </td> <td align="center">   1.43             </td> <td align="center">   1.43             </td> </tr>
</tbody>
</table>
<p>
The area in all three cases are similar. The size and shape will not be affected based on the expansion from 1D to 2D. But by studying the figure(<a href="#fig:2D_trav_wave">3</a>), the waves occur at different time in the two 2D simulations. This is caused by the distance from the start position for the Gaussian wave. The first subplot that starts with a Gaussian function along the \( x=0 \) axis, gets a wave of infected wash along the x axis. This can be seen as a wave on the beach. Everyone that have the same distance from the ocean will be hit simultaneously. The travelling wave for the 1D simulation and the first subplot occur at the same time, because they are measured at the same distance from the starting point. The last plot is also measured at (15,15), but occur later. Since the wave starts at point (0,0), the distance to (15,15) is 21.21. This means that the wave will start about 6 time steps later. This is also reasonable by looking at the plot.

<h3>Change in initial flow  <a name="___sec11"></a></h3>

Another test that can be done to the travelling wave, is to check if the size of the initial wave will affect the travelling wave. The simulation is run with the same parameter as for the three simulations above and the only difference is the initial value for the infected group. The Gaussian wave of infected are placed a point (0,0) as for right subplot in figure(<a href="#fig:2D_trav_wave">3</a>).The simulation can be seen in figure(<a href="#fig:initial_value">4</a>).  
<!-- Volume ordinary = 0.3141592653589793 -->
<!-- Volume extreme = 157.07963267948966 -->
<!-- Volume under graph 1.43345609926 -->

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 4:  <a name="fig:initial_value"></a> A major flow of infected spread outwards the field. After a certain time, the wave has past the area and the number in each class stabilize. </p></center>
<p><img src="plots/2D_initial_variable_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
By measuring the travelling wave at (15,15), the size and shape can be compared with the second subplot in figure(<a href="#fig:2D_trav_wave">3</a>). This is done in figure(<a href="#fig:initial_trav_wave">5</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 5:  <a name="fig:initial_trav_wave"></a> The travelling wave with a major increase of infected at the initial time. </p></center>
<p><img src="plots/TW_2D_initial_z_lambda_0_5.png" align="bottom" height=600 width=800></p>
</center>

<p>
The figure(<a href="#fig:initial_trav_wave">5</a>) shows a similar size and shape as for the other simulations run earlier. By increasing the initial value, the size of the travelling wave cannot be affected. But there is a difference in the time when the wave occur. In this simulation where the initial value is higher, the travelling wave reaches the measuring point (15,15) earlier. This can be explained by the idea of a ball dropped from height. If the ball is released or thrown to the ground, will only affect the acceleration of the ball, but not the terminal velocity. After a certain time the released ball and the thrown ball will reach the same maximum speed. This is also the case for the speed of the travelling wave.

<h3>Change in lambda  <a name="___sec12"></a></h3>

The one thing that affects the speed and size, is the \( \lambda \) variable in the PDE system<a href="#mjx-eqn-3">(3)</a>. This \( \lambda \) is a combination of \( a \), which controls deaths among infected, \( r \), which control the number of infected in a meeting between an infected and a susceptible. The last parameter in \( \lambda \) is the concentration of Susceptible. By changing this parameter, the travelling wave will change in both size and shape. In figure(<a href="#fig:change_lambda">6</a>), the simulation is run with four different values of \( \lambda \).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 6:  <a name="fig:change_lambda"></a> The travelling wave simulated with \( \lambda \) values in the range of 0.01 to 1 </p></center>
<p><img src="plots/2D_lambda_variable.png" align="bottom" height=600 width=800></p>
</center>

<p>
To understand the result in figure(<a href="#fig:change_lambda">6</a>), the \( \lambda  \) function can be study,
$$
\begin{equation} \tag{11}
 \lambda =\frac{a}{rS_0},
\end{equation}
$$

When \( \lambda \rightarrow 0 \), this cause a major and aggressive travelling wave. In figure(<a href="#fig:change_lambda">6</a>), \( \lambda \) is run with the value 0.01 in the first subplot. This result in a travelling wave of infected that eradicates the number of Susceptible in a short time. The wave stars decreasing when all Susceptible are infected. By looking at the equation<a href="#mjx-eqn-11">(11)</a>, a small value is caused by a small \( a \) compared to \( r \) and \( S_0 \). If \( a \) is low, this result in few deaths/immune in the infected class. This means that this class will grow and be able to infect even more humans from the Susceptible class. The same thing will happen if \( r \) is large. A result of this will cause an aggressive disease that will infect major part of the population. The same result will happen if \( S_0 \) is large. Then there are several possible humans to infect. Therefore a outburst of a disease is more critically in a city than in the wilderness far from other humans.
<br />
<br />
If \( \lambda \) increases above 1, the disease will not be able to spread. Then the number of infected will decrease, since the number of dead/immune infected are higher than the infected susceptible. After a certain time, the number of infected will die out. If \( \lambda \) stays at 1, the number of infected will be equal the whole time.

<h1>Epidemic in an English Boarding School 1978  <a name="___sec13"></a></h1>
I the previous chapter an example from the English boarding school was presented. This example was based on the book from J.D Murray and was modeled for a ODE system. By using the parameters a similar result should appear for the PDE system. The school had 763 students where one of the students brought with him a disease back to the school. The following number was used for the ODE system in chapter one. \( N=763, S_0=762,I_0=1,R_0=0,\rho=202 \) and \( r = 2.18\cdot 10^{-3} \). 
<br />
<br />
The first simulation that is done on the PDE system is produced with an uniform distributed concentration of the three classes all over the area. A person has a given volume of one cubic. The total volume of the whole group is spread over the area. The area is sat to be 10 x 10, which means that the height of one person will be \( 1/100 \). Since the Infected group only consist of one person, the total height will be 0.01 for the whole area. The Susceptible group consist of 762 students and the total height in each point will be 7.62. The simulation can be seen in the Appendix. 
<br />
<br />
The results from figure(<a href="#fig:Eng_PDE_uni">7</a>) are equal with the result from the ODE system modeled in the previous chapter.This can be seen in the table <a href="#table:english_numbers">table:english_numbers</a>  This is as expected since the diffusion term i negligible in this system and that it in reality is group of separate ODE systems modeled over an area.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 7:  <a name="fig:Eng_PDE_uni"></a> English Boarding School modeled over a uniform distributed area. </p></center>
<p><img src="plots/2D_british_school_number.png" align="bottom" height=600 width=800></p>
</center>

<p>
<a name="table:english_numbers"></a>
<table border="1">
<thead>
<tr><th align="center">                </th> <th align="center">   ODE system   </th> <th align="center">PDE uniform dist</th> <th align="center">   PDE center   </th> <th align="center">   PDE corner   </th> </tr>
</thead>
<tbody>
<tr><td align="center">   5 Days              </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">                       </td> <td align="center">   449.28              </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Infective           </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   10 Days             </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Infective           </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   15 Days             </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Infective           </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> <td align="center">                       </td> </tr>
</tbody>
</table>
<p>
Introducing a Gaussian distribution

<p>

<div>
<video  loop controls width='600' height='500' preload='none'>
    <source src='plots/2D_british_school_gauss.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>The sick one is placed in the center of the School area.</em></p>


<p>
<center><p><img src="plots/2D_british_school_gauss_sub.png" align="bottom" height=600 width=800></p></center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  This seems to have no effect and the spread of the disease is similar to the one above. But if a student is lucky to stand in one corner, he has a greater chance to stay healthy </p></center>
<p><img src="plots/2D_british_school_gauss_number.png" align="bottom" height=600 width=800></p>
</center>

<p>
Gaussain from the corner. This one gives other results. It has a slower diffusion.

<p>

<div>
<video  loop controls width='600' height='500' preload='none'>
    <source src='plots/2D_british_school_gauss_corner.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>A wave of infected moves towards the school yard</em></p>


<p>
<center><p><img src="plots/2D_british_school_gauss_corner_sub.png" align="bottom" height=600 width=800></p></center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 9:  This simulation gives another result. Here the number of infected increase later than in the previous examples </p></center>
<p><img src="plots/2D_british_school_gauss_corner_number.png" align="bottom" height=600 width=800></p>
</center>

<p>
<p>
<!-- begin bottom navigation -->
<a href="._2_PDE_FK001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

