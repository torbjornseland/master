<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Geographic models">



<style type="text/css">
    /* blueish style */

    /* Color definitions:  http://www.december.com/html/spec/color0.html
       CSS examples:       http://www.w3schools.com/css/css_examples.asp */

    body {
      margin-top: 1.0em;
      background-color: #ffffff;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    h1 { font-size: 1.8em; color: #1e36ce; }
    h2 { font-size: 1.6em; color: #1e36ce; }
    h3 { font-size: 1.4em; color: #1e36ce; }
    a { color: #1e36ce; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Introduction ', 1, None, '___sec0'),
              (' Simple system for spatial spread ', 1, None, '___sec1'),
              (' Travelling wave 1D ', 2, None, '___sec2'),
              (' Verifying the solution ', 2, None, '___sec3'),
              (' Constant solution ', 3, None, '___sec4'),
              (' Manufactured solution ', 3, None, '___sec5'),
              (' Convergence rate ', 3, None, '___sec6'),
              (' The spatial error ', 3, None, '___sec7'),
              (' The temporal error ', 3, None, '___sec8'),
              (' Travelling wave in 2D ', 2, None, '___sec9'),
              (' A gaussian wave ', 3, None, '___sec10'),
              (' Change in initial flow ', 3, None, '___sec11'),
              (' Change in lambda ', 3, None, '___sec12'),
              (' Epidemic in an English Boarding School 1978 ',
               1,
               None,
               '___sec13'),
              (' Introducing a Gaussian distribution of infective ',
               3,
               None,
               '___sec14'),
              (' Zombiefication ', 1, None, '___sec15'),
              (' Where does the infected one arises ', 3, None, '___sec16'),
              (' Lock in different areas ', 2, None, '___sec17'),
              (' Ten minutes at Frederikkeplassen ', 3, None, '___sec18'),
              (' random distribution ', 3, None, '___sec19'),
              (' Appendix ', 1, None, '___sec20'),
              (' Sympy to find manufactured solution ', 3, None, '___sec21'),
              (' Discretization ', 2, None, '___sec22'),
              (' 2D Gaussian function from x=0 ', 2, None, '___sec23'),
              (' 2D Gaussian function from x=0,y=0 ', 2, None, '___sec24'),
              (' 2D Gaussian function from x=0,y=0 with higher initial value ',
               2,
               None,
               '___sec25'),
              (' English Boarding School ', 2, None, '___sec26'),
              (' Gaussian from the corner ', 3, None, '___sec27'),
              (' A long simulation on 100 Days ', 3, None, '___sec28'),
              (' Zombiefication ', 2, None, '___sec29'),
              (' Verify the initial phase ', 3, None, '___sec30'),
              (' Three phases ', 3, None, '___sec31'),
              (' middle town ', 3, None, '___sec32'),
              (' large town ', 3, None, '___sec33'),
              (' Bibliography ', 1, None, '___sec34')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




    
<a name="part0000"></a>
<!-- begin top navigation -->
<a href="._2_PDE_FK001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- ------------------- main content ---------------------- -->


<title>Geographic models </title>

<center><h1>Geographic models </h1></center>  <!-- document title -->

<p>
<!-- author(s): Torbj&#248;rn Seland -->

<center>
<b>Torbj&#248;rn Seland</b> 
</center>


<p>
<!-- institution(s) -->
<p>
<center><h4>Nov 25, 2014</h4></center> <!-- date -->

<h2>Table of contents</h2>

<a href="#___sec0"> Introduction </a><br>
<a href="#___sec1"> Simple system for spatial spread </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Travelling wave 1D </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec3"> Verifying the solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec4"> Constant solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec5"> Manufactured solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec6"> Convergence rate </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec7"> The spatial error </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec8"> The temporal error </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec9"> Travelling wave in 2D </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec10"> A gaussian wave </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec11"> Change in initial flow </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec12"> Change in lambda </a><br>
<a href="#___sec13"> Epidemic in an English Boarding School 1978 </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec14"> Introducing a Gaussian distribution of infective </a><br>
<a href="._2_PDE_FK001.html#___sec15"> Zombiefication </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK001.html#___sec16"> Where does the infected one arises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK001.html#___sec17"> Lock in different areas </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK001.html#___sec18"> Ten minutes at Frederikkeplassen </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK001.html#___sec19"> random distribution </a><br>
<a href="._2_PDE_FK002.html#___sec20"> Appendix </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec21"> Sympy to find manufactured solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec22"> Discretization </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec23"> 2D Gaussian function from x=0 </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec24"> 2D Gaussian function from x=0,y=0 </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec25"> 2D Gaussian function from x=0,y=0 with higher initial value </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec26"> English Boarding School </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec27"> Gaussian from the corner </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec28"> A long simulation on 100 Days </a><br>
&nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec29"> Zombiefication </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec30"> Verify the initial phase </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec31"> Three phases </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec32"> middle town </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._2_PDE_FK002.html#___sec33"> large town </a><br>
<a href="._2_PDE_FK002.html#___sec34"> Bibliography </a><br>
</p>

<h1>Introduction  <a name="___sec0"></a></h1>
This chapter will introduce a new model for epidemic diseases. By expand the ODE system from previous chapter to also consist a term for geographic spread of. The first section <em>Simple system for spatial spread</em> will build on the simple SIR model presented in previous chapter and be based on <em>Geographic spread and Control of epidemics</em> by Murray <a href="._2_PDE_FK002.html#murray2003mathematical">[1]</a>. The parameters from <em>English Boarding School</em> in previous chaper will be used for the model and the result will be compared between the models. The position of the infected student will be compared against the number of infected each day. The last section,*Zombiefication*, will study and expand the system from Langtangen, Mardal and R&#248;tnes <a href="._2_PDE_FK002.html#zombie-math">[2]</a>. The results and parameter values used to calculate <em>Walking Dead</em> will be used to simulate the geographic result.

<h1>Simple system for spatial spread  <a name="___sec1"></a></h1>
A spatial variable, <b>x</b> will now be introduced to the model. This result in both temporal and spatial variations. The difference from a standard ODE system will be the diffusion part added to each equation. The system can be seen in eq<a href="#mjx-eqn-1">(1)</a>. 
$$
\begin{equation} \tag{1}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -rIS + D\nabla ^2 S\\
	\frac{\partial I}{\partial t} &= rIS- aI + D\nabla ^2 I\\
	\frac{\partial R}{\partial t} &= aI + D\nabla ^2 R
	\end{aligned}
\end{equation}
$$

With the following conditions for the boundary and initial values
$$
\begin{equation} \tag{2}
	\begin{aligned}
	u_x(0,t) &= u_x(X,t) = 0,\quad u = S,I,R\\
	u(x,0) &= f_u(x),\quad u= S,I,R
	\end{aligned}
\end{equation}
$$

This result in Neumann conditions at the boundary. The following implementation can be used at the boundary
$$
\begin{equation}
	\begin{aligned}
	\frac{u_{-1}^n - u_1^n}{2\Delta x} &= 0
	u_{-1}^n &= u_1^n
	\end{aligned}
\end{equation}
$$

This is solved by adding an extra point on each side, called ghost points. The values in these points are updated each time step with values from \( u_1^n \) and \( u_{X-1}^n \) each round. All three classes, \( S,I,R \) have the same diffusion coefficient, \( D \), for this system. This give the three groups the same diffusion speed. This can vary between systems. Section <em>Zombiefication</em>, will contain various diffusion constants. The two parts \( rIS \) and \( aI \) will work in the same way as in the ODE system. Since this model taking the position into account, the idea is to model a group of infective that moves into a uniform population with susceptible, which is spread around with the density \( S_0 \). Then the geotemporal spread can be seen. The problem will first be consider as one-dimensional. The system can be nondimensionalise by writing 
$$
\begin{equation} \tag{3}
	\begin{aligned}
	I^* =\frac{I}{S_0},&\quad I^* = \frac{I}{S_0},&\quad R^*= \frac{R}{S_0},&\\
	x^* =\left(\frac{rS_0}{D}\right)^{1/2}x,&\quad t^*=rS_0t,&\quad \lambda =\frac{a}{rS_0},&
	\end{aligned}
\end{equation}
$$

\( S_0 \) is used as a representative population. Now the model<a href="#mjx-eqn-1">(1)</a> can be expressed as in eq<a href="#mjx-eqn-4">(4)</a>. The asterisks have been dropped to make it easier to read.
$$
\begin{equation} \tag{4}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2},\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2},\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

The three parameters \( r \), \( a \) and \( D \) have been replaced by \( \lambda \). The <em>reproduction rate</em> that was presented for the ODE model can be seen as \( 1/\lambda  \). This has a couple of equivalent meanings. \( 1/\lambda \) can be seen as the number of secondary infections produced by one primary infected. It can also be used to measure two different time scales. The first one, \( 1/(rS_0) \), measure the contagious time of the disease. The second one can look at the life expectancy for an infective. This can be described \( 1/a \).

<h2>Travelling wave 1D  <a name="___sec2"></a></h2>
This section will focus on the travelling wave. The travelling wave describe how a group of infected, in this case, travels through a geographic area of humans. This will be shown by sending a pulse of infected into a group of susceptible. A travelling wave solution will be described as follows,
$$
\begin{equation} \tag{5}
I(x,t)=I(z),\quad S(x,t)=S(z),\quad R(x,t) = R(z),\quad z = x-ct,
\end{equation}
$$

The value \( c \) describe the wave speed. This represents a wave of constant shape that travels in the positive x-direction. <a href="#mjx-eqn-5">(5)</a> can be inserted into <a href="#mjx-eqn-4">(4)</a>. This result in the ordinary system<a href="#mjx-eqn-6">(6)</a>
$$
\begin{equation} \tag{6}
	\begin{aligned}
	S'' + cS' - IS &= 0,\\
	I'' + cI' + I(S-\lambda)&=0\\
	R'' + cR  + I\lambda &=0
	\end{aligned}
\end{equation}
$$

This gives an eigenvalue problem. The value of \( \lambda \) needs to stay in a range where \( c > 0 \) is fulfilled. The values \( S \), \( I \) and \( R \) have to stay nonnegative. This leads to
$$
\begin{equation} 
	\begin{aligned}
	0 \leq S(-\infty) < S(\infty)&=1\\
	I(-\infty)=I(\infty)&=0,\\
	1 \geq R(-\infty)\geq R(\infty) &= 0
	\end{aligned}
\end{equation}
$$


<p>
An epidemic wave can be seen in figure(<a href="#fig:1D_sub">1</a>). The value of \( \lambda \) is sat to 0.5. The initial value for <em>Susceptible</em> is 1 for the area and the <em>Removed</em> to 0. The <em>Infected</em> class has a Gauss curve around 0 at initial time. In the four subplot, the epidemic wave travel towards the other side. The value \( z \), which is defined in <a href="#mjx-eqn-5">(5)</a>, is used to plot the travelling wave measured at a specific point, in this case 15. This travelling wave is shown in figure(<a href="#fig:1D_tw">2</a>).       

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 1:  <a name="fig:1D_sub"></a> The system (ref{eq:ord_diff_sys}. A gaussian curve with height 0.2 placed on the left side. This causes an epidemic wave controlled by the parameter \( \lambda=0.5 \). The size is measured at point \( x=15 \) and can be seen in figure (<a href="#fig:1D_tw">2</a>). </p></center>
<p><img src="plots/trav_wave_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 2:  <a name="fig:1D_tw"></a> This shows the travelling wave measures at at \( x=15 \) in figure(<a href="#fig:1D_sub">1</a>) </p></center>
<p><img src="plots/epidemic_wave_z_lambda_0_5.png" align="bottom" ></p>
</center>

<p>
The system<a href="#mjx-eqn-6">(6)</a> is a fourth order phase space system. The lower bound for \( c \) can be found. J.D Murray shows this in <a href="._2_PDE_FK002.html#murray2003mathematical">[1]</a>. The <em>Infective</em> class in system<a href="#mjx-eqn-6">(6)</a> can be linearised when \( z\rightarrow \infty \). This leads to \( S\rightarrow 1 \) and \( I \rightarrow 0 \). The result then become 
$$
\begin{equation}
	I'' + cI' + I(S-\lambda) \approx 0 
\end{equation}
$$

This can be found by
$$
\begin{equation}
I(z) \varpropto \exp\left[(-c \pm {c^2 -4(1-\lambda)}^{1/2})z/2\right]
\end{equation}
$$

Since a concentration cannot be negative, it is required that \( I(z)\rightarrow 0 \). Therefore the solution has to avoid oscillation around 0. If a travelling wave exist, it has to satisfy
$$
\begin{equation}
	c \geq 2(1-\lambda)^{1/2}, \lambda < 1
\end{equation}
$$

If \( \lambda > 1 \), no travelling wave will exist. Then the disease will die out. The terms defined in <a href="#mjx-eqn-3">(3)</a> will give the threshold conditions,
$$
\begin{equation}
	\lambda = \frac{a}{rS_0} < 1
\end{equation}
$$

This is the same value that was given for the ODE model in the previous chapter.

<h2>Verifying the solution  <a name="___sec3"></a></h2>
To verify the implementation of the solution, a couple of tests can be done one the system. The system will be tested again a constant solution and a manufactured solution.

<h3>Constant solution  <a name="___sec4"></a></h3>

A constant solution use preproduced constant values for for the concentrations \( S \), \( I \) and \( R \). These can be replaced by \( S = C_s,I=C_i,R=C_r \). The value of \( C_i \) can only be 0 in system<a href="#mjx-eqn-4">(4)</a>. This results in a poor test where several bugs can escape. The system can be expanded by adding a term \( \beta R \) to the <em>Susceptible</em> class and subtract the same term from the <em>Removed</em> class. Then all three values can be tested. The system will then look: 
$$
\begin{equation} \tag{9}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \beta R + \frac{\partial^2 S}{\partial x^2},\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2},\\
	\frac{\partial R}{\partial t} &= \lambda I - \beta R + \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

By deriving <a href="#mjx-eqn-9">(9)</a>, the following system <a href="#mjx-eqn-8">(8)</a> has to be solved
$$
\begin{equation} \tag{8}
	\begin{aligned}
	C_iC_s &= \beta C_r \\
	C_iC_s &= \lambda C_i \\
	\lambda C_i &= -\beta C_r 
	\end{aligned}
\end{equation}
$$


<p>
The values \( \beta \) and \( \lambda \) are based on the constants. These can be chosen freely. Here they are sat to \( C_s = 1.2,C_i=0.8,C_r=0.6 \). This result in \( \lambda= C_s = 1.2 \) and \( \beta= \frac{C_s C_i}{C_r}=1.6 \). A test is made in python and can be seen in the code.

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_constant_solution</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Test problem where u=u_const is the exact solution, to be</span>
<span style="color: #BA2121; font-style: italic">    reproduced (to machine precision) by any relevant method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution</span>(t):
        <span style="color: #008000; font-weight: bold">return</span> C_s,C_i,C_r
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">lam</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> C_s

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">beta</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (C_s<span style="color: #666666">*</span>C_i)<span style="color: #666666">/</span><span style="color: #008000">float</span>(C_r)

    <span style="color: #408080; font-style: italic">#Constant values</span>
    C_s <span style="color: #666666">=</span> <span style="color: #666666">1.2</span>
    C_i <span style="color: #666666">=</span> <span style="color: #666666">0.8</span>
    C_r <span style="color: #666666">=</span> <span style="color: #666666">0.6</span>
    
    <span style="color: #408080; font-style: italic">#lam = C_s</span>
    <span style="color: #408080; font-style: italic">#beta = (lam*C_i)/float(C_r)</span>
    
    T <span style="color: #666666">=</span> <span style="color: #666666">2</span>; Nt <span style="color: #666666">=</span> <span style="color: #666666">200</span>
    X <span style="color: #666666">=</span> <span style="color: #666666">20</span>; Nx <span style="color: #666666">=</span> <span style="color: #666666">40</span>
    S_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_s
    I_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_i
    R_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_r
    
    t,x,S,I,R <span style="color: #666666">=</span> simple_PDE(T,Nx,Nt,X,lam,beta,S_1,I_1,R_1)
    
    S_e,I_e,R_e <span style="color: #666666">=</span> exact_solution(t)
    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(S_e <span style="color: #666666">-</span> S)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I_e <span style="color: #666666">-</span> I)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(R_e <span style="color: #666666">-</span> R)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol
</pre></div>
<p>
The test was run with no error, and the three constant values were produced correctly. This test is not good enough by it self to qualify the program, but an error here would result in a large error in the program that had to be fixed before the next test.

<h3>Manufactured solution  <a name="___sec5"></a></h3>

By constructing a function to each equation in the system <a href="#mjx-eqn-4">(4)</a>, a manufactured solution can be created. Here \( S \),$I$ and \( R \) are pre produced. The system will be
$$
\begin{equation} \tag{9}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2}+f(x,t),\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2}+g(x,t),\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2}+h(x,t),
	\end{aligned}
\end{equation}
$$

where \( f \),$g$ and \( h \) are functions to achieve the expected results for \( S \), \( I \) and \( R \). In this case the functions will be:
$$
\begin{equation}
	\begin{aligned}
	f(x,t) = \frac{\partial S}{\partial t} + IS - \frac{\partial^2 S}{\partial x^2}\\
	g(x,t) = \frac{\partial I}{\partial t} - IS + \lambda I - \frac{\partial^2 I}{\partial x^2}\\
	h(x,t) = \frac{\partial R}{\partial t} -\lambda I - \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

When choosing the expected function for the classes, it is important that the boundary conditions from <a href="#mjx-eqn-2">(2)</a> is fulfilled.
$$
\begin{equation}
    u_x(0,t) = u_x(X,t) = 0
\end{equation}
$$

The quantities have been sat to:
$$
\begin{equation}
	\begin{aligned}
    S(x,t) = cos(\frac{\pi}{X}x)t\\
    I(x,t) = cos(\frac{\pi}{X}x)t\\
    R(x,t) = cos(\frac{\pi}{X}x)t
	\end{aligned}
\end{equation}
$$

Now <code>sympy</code> can be used to do the calculations for the three functions \( f \), \( g \) and \( h \). The program can be seen in the Appendix. This result in the following equations seen in <a href="#mjx-eqn-10">(10)</a> 

<p>
Which give
$$
\begin{equation} \tag{10}
	\begin{aligned}
	f(x,t) &= (t^2\cos(\pi x) + \pi^2t + 1)\cos(\pi x)\\
	g(x,t) &= (\lambda t - t^2\cos(\pi x) + \pi^2t + 1)\cos(\pi x)\\
	h(x,t) &= (-\lambda t + \pi^2t + 1)\cos(\pi x)
	\end{aligned}
\end{equation}
$$

A similar test made for the constant solution can be used here. While the constant test expected a difference on machine precition, this is not the case here. In this test, an expected convergence rate can be measured.

<p>
The following manufactured test will then be
<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_manufactured_solution</span>(T,Nt,X,Nx):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Test problem where u=c*t+I is the exact solution, to be</span>
<span style="color: #BA2121; font-style: italic">    reproduced (to machine precision) by any relevant method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_S</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_I</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_R</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t


    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">beta</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> exact_solution_S(t,x)<span style="color: #666666">*</span>exact_solution_I(t,x)<span style="color: #666666">/</span>exact_solution_R(t,x)
    lam <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (t<span style="color: #666666">**2*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) 

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (lam<span style="color: #666666">*</span>t <span style="color: #666666">-</span> t<span style="color: #666666">**2*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">h</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>t <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)
        

    dx <span style="color: #666666">=</span> X<span style="color: #666666">/</span><span style="color: #008000">float</span>(Nx)
    dt <span style="color: #666666">=</span> T<span style="color: #666666">/</span><span style="color: #008000">float</span>(Nt)
    S_1 <span style="color: #666666">=</span> exact_solution_S(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
    I_1 <span style="color: #666666">=</span> exact_solution_I(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
    R_1 <span style="color: #666666">=</span> exact_solution_R(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
     
    t,x,S,I,R <span style="color: #666666">=</span> simple_PDE(T,Nx,Nt,X,lam,beta,S_1,I_1,R_1,f,g,h)
    S_e <span style="color: #666666">=</span> exact_solution_S(t[<span style="color: #666666">-1</span>],x)
    I_e <span style="color: #666666">=</span> exact_solution_I(t[<span style="color: #666666">-1</span>],x)
    R_e <span style="color: #666666">=</span> exact_solution_R(t[<span style="color: #666666">-1</span>],x)
    
    difference_S <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(S_e <span style="color: #666666">-</span> S)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>

    
    <span style="color: #408080; font-style: italic">#for i in range(4):</span>
    <span style="color: #408080; font-style: italic">#    print &quot;n&quot;,i,&quot;S_e&quot;,exact_solution_S(t[i],x)</span>
    
    <span style="color: #408080; font-style: italic">#print &quot;S&quot;,S</span>
    <span style="color: #408080; font-style: italic">#t_tot = np.sum(t[:-1])</span>
    <span style="color: #408080; font-style: italic">#print &quot;t_tot&quot;,t_tot</span>
    <span style="color: #408080; font-style: italic">#difference_exp = t_tot*dt*np.cos(x*np.pi)*((2*(np.cos(np.pi*dx)-1))/dx**2+np.pi**2)</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff_exp&quot;, (abs(difference_exp)).max()</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;diff&quot;</span>,difference_S
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
    
    difference_I <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I_e <span style="color: #666666">-</span> I)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff&quot;,difference_I</span>
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
   
    difference_R <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(R_e <span style="color: #666666">-</span> R)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff&quot;,difference_R</span>
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
    <span style="color: #008000; font-weight: bold">return</span> difference_S,difference_I,difference_R
</pre></div>

<h3>Convergence rate  <a name="___sec6"></a></h3>

The program can be controlled by checking the convergence rate. The error term  for this equation can be described as  
$$
\begin{equation} \tag{11}
    \epsilon = C_x\Delta x^2 + C_t \Delta t
\end{equation}
$$

With equation<a href="#mjx-eqn-11">(11)</a>, the expected convergence rate can be found for both \( \Delta x \) and \( \Delta t \). To be able to separate the \( \Delta \)'s, the other value has to be close to eliminated. To study the value \( \Delta x \),  \( \Delta t \ll \Delta x \) has to be fullfilled. This will lead to \( C_t\Delta t \approx 0 \), and the error term for \( \Delta x \) can be found. The opposite thing can  be done for \( \Delta t \). A table for the error is produced for different values for \( \Delta t = 0.05 \) and \( \Delta x=0.1 \).

<p>
<a name="table:error_numbers"></a>
<table border="1">
<thead>
<tr><th align="center">                         </th> <td align="center">      \( \Delta x \)     </td> <td align="center"> \( \frac{\Delta x}{2} \)</td> <td align="center"> \( \frac{\Delta x}{4} \)</td> <td align="center"> \( \frac{\Delta x}{8} \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   \( \Delta t      \)          </td> <td align="center">   9.8E-3                       </td> <td align="center">   -                            </td> <td align="center">   -                            </td> <td align="center">   -                            </td> </tr>
<tr><td align="center">   \( \frac{\Delta t}{4}  \)    </td> <td align="center">   9.9E-3                       </td> <td align="center">   2.5E-3                       </td> <td align="center">   -                            </td> <td align="center">   -                            </td> </tr>
<tr><td align="center">   \( \frac{\Delta t}{8}  \)    </td> <td align="center">   9.9E-3                       </td> <td align="center">   2.5E-3                       </td> <td align="center">   6.1E-4                       </td> <td align="center">   -                            </td> </tr>
<tr><td align="center">   \( \frac{\Delta t}{16} \)    </td> <td align="center">   9.9E-3                       </td> <td align="center">   2.5E-3                       </td> <td align="center">   6.1E-4                       </td> <td align="center">   1.5E-4                       </td> </tr>
</tbody>
</table>
<!-- 0.00988006143376,0.00246039081619,-,- -->
<!-- 0.00988361769746,0.00246127510994,0.000614719954035 -->
<!-- 0.00988450717896,0.00246149628689,0.000614775174047,0.000153656409034 -->

<h3>The spatial error  <a name="___sec7"></a></h3>

The (<a href="#table:error_numbers">table:error_numbers</a>) gives information about the error when \( \Delta t \) and \( \Delta x \) are reduced. By studying the row where \( \Delta t/16 \), the \( C_t \Delta t \) can be seen as close to negligible in equation<a href="#mjx-eqn-11">(11)</a>. The error can then be expressed 
$$
\begin{equation}
    \epsilon \propto \Delta x^r
\end{equation}
$$

The value is expected to be \( r=2 \), since Crank Nicolson is used in the spatial discretization. This gives a 2.order error. By comparing the error for different \( \Delta x \), the convergence rate, \( r \), can be expressed, 
$$
\begin{equation} \tag{12}
 r_{12} \simeq \frac{\log(\epsilon_1/\epsilon_2)}{\log(\Delta x_1/\Delta x_2)}
\end{equation}
$$

Since the table above has four different error values, these can be used to give three different convergence rates. \( \Delta x_1 = \Delta x, \Delta x_2 = \Delta x/2... \). The same labeling will be done for the different error values, \( \epsilon \).
<table border="1">
<thead>
<tr><th align="center">                           </th> <td align="center">\( \epsilon_1/\epsilon_2 \)</td> <td align="center">\( \epsilon_2/\epsilon_3 \)</td> <td align="center">\( \epsilon_3/\epsilon_4 \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   r                              </td> <td align="center">   2.0056                         </td> <td align="center">   2.0014                         </td> <td align="center">   2.0004                         </td> </tr>
</tbody>
</table>
<p>
Here the rate goes towards 2, and a 2.order convergence rate seems to be fulfilled.

<h3>The temporal error  <a name="___sec8"></a></h3>

The temporal error is hard to find since the <em>Stability criteria</em> expect \( \Delta t \) to fulfill the criteria in <a href="#mjx-eqn-13">(13)</a> to avoid oscillations.
$$
\begin{equation} \tag{13}
 2\Delta t \leq \Delta x^2
\end{equation}
$$

This results in the case that \( \Delta x \ll \Delta t \) is impossible, because this only leads to an unstable solution. By looking at the column for \( \frac{\Delta x}{8} \), the only stable solution is for \( \frac{\Delta t}{16} \). Therefore the technique used for the spatial error cannot be used here. By studying the diagonal numbers in the table, the expected convergence rate is fulfilled for both \( \Delta x \), which gives \( r = 2 \) and for \( \Delta t \) that gives \( r=1 \)

<h2>Travelling wave in 2D  <a name="___sec9"></a></h2>
The system <a href="#mjx-eqn-4">(4)</a> can be discretized for a 2D area. This is more realistic when simulating a geographic spread of an epidemic disease. The non dimensional system  can be discretized with Forward Euler in time and Crank Nicolson in space
$$
\begin{equation} \tag{14}
	\begin{aligned}
    \frac{S^{n+1}_{i,j}-S^n_{i,j}}{\Delta t} &= -I^{n}_{i,j}S^{n}_{i,j} + \left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{I^{n+1}_{i,j}-I^n_{i,j}}{\Delta t} &= I^{n}_{i,j}S^{n}_{i,j} -\lambda I^{n}_{i,j} + \left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{R^{n+1}_{i,j}-R^n_{i,j}}{\Delta t} &= \lambda I^{n}_{i,j}+\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right) 
	\end{aligned}
\end{equation}
$$

The known values can be placed on the right side. The system will then be
$$
\begin{equation}
	\begin{aligned}
    S^{n+1}_{i,j} &= S^{n}_{i,j}+\Delta t\left(-I^{n}_{i,j}S^{n}_{i,j} + \left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right)\right) \\
    I^{n+1}_{i,j} &= I^{n}_{i,j}+\Delta t\left(I^{n}_{i,j}S^{n}_{i,j} -\lambda I^{n}_{i,j} + \left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right)\right) \\
    R^{n+1}_{i,j} &= R^{n}_{i,j}+\Delta t\left(\lambda I^{n}_{i,j}+\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right)\right) 
	\end{aligned}
\end{equation}
$$

This results in an explicit system, which is easy to code. It consist of known values on the right side and only one unknown on the left side.

<h3>A gaussian wave  <a name="___sec10"></a></h3>

In the PDE system for the 1D equation, a Gaussian quantity of infected humans was placed on the left side in the initial value. This resulted in a wave of infected spread along the x-axis. A similar thing can be done for the 2D simulation. A couple of similar simulations have been produced for the 2D system. The first simulation is calculated with a Gaussian function along \( x=0 \) for the <em>Infected</em> at initial time. The second simulation has placed the Gaussian function at point \( x=0,y=0 \) for the <em>Infected</em> group at initial value. Both simulations can be seen in the Appendix.  
<br />
<br />
By studying the travelling wave at a certain point, the size of the epidemic wave can be measured and compared. In these two 2D simulations in figure(<a href="#fig:2D_trav_wave">3</a>), the wave will be measured in the point (15,15) while the travelling wave in the 1D simulation was measured at point(15). The two travelling waves can be seen in the figure(<a href="#fig:2D_trav_wave">3</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 3:  <a name="fig:2D_trav_wave"></a> Travelling wave measured at point (15,15) with two different initial values for the Infected class. The initial value is sat as a Gaussian line along (0,y) in the left plot and as a Gaussian point (0,0) in the right plot </p></center>
<p><img src="plots/Trav_wave_2D.png" align="bottom" height=400 width=800></p>
</center>

<p>
The shape of the two travelling waves in figure(<a href="#fig:2D_trav_wave">3</a>) are similar. The only difference is the time when the wave occur. The plot for 1D wave in fig(<a href="#fig:1D_tw">2</a>) has the same shape. With a closer study, the area under the function can be measured for all three cases. The result can be seen in the (<a href="#table:wave_values">table:wave_values</a>)   

<p>
<!-- 1D -->
<!-- 1.4340793845 -->
<!-- 1.43143259034 dt = \( 1\cdot10^{-3} \), dx = 0.05 -->
<!-- 1.43195870243 dt = 0.0002, dx^2 = 0.000625 -->
<!-- 2D wave line: -->
<!-- 1.43345609926 dt =0.0004, dx^2 =  0.0016 -->
<!-- 2D wave point: -->
<!-- 1.43352971688 -->

<p>
<a name="table:wave_values"></a>
<table border="1">
<thead>
<tr><th align="center">   1D wave   </th> <th align="center"> 2D wave line</th> <th align="center">2D wave point</th> </tr>
</thead>
<tbody>
<tr><td align="center">   1.43             </td> <td align="center">   1.43             </td> <td align="center">   1.43             </td> </tr>
</tbody>
</table>
<p>
The area in all three simulations moves towards the same area when \( \Delta t \) and \( \Delta x \) are reduced. The size and shape will not change by  expanding the system from 1D to 2D. But by studying the figure(<a href="#fig:2D_trav_wave">3</a>), the wave occur at different times. This is caused by the distance from the start position for the Gaussian wave. The first subplot that starts with a Gaussian function along the \( x=0 \) axis gets a wave of infected wash along the x axis. This can be seen as a wave on the beach. Everyone that have the same distance from the ocean will be hit simultaneously. The travelling wave for the 1D simulation and the first subplot occur at the same time, because they are measured at the same distance from the starting point. The last plot is also measured at (15,15), but occur later. Since the wave starts at point (0,0), the distance to (15,15) is 21.21. This means that the wave will reach the point 6.21 time steps later. This is also reasonable by looking at the plot.

<h3>Change in initial flow  <a name="___sec11"></a></h3>

By increasing the initial wave of <em>Infected</em>, the start value of <em>Infected</em> can be study. The simulation is run with the same parameters as for the three simulations above and the only difference is the initial value for the infected group. The Gaussian wave of infected are placed a point (0,0) as for right subplot in figure(<a href="#fig:2D_trav_wave">3</a>).The simulation can be seen in figure(<a href="#fig:initial_value">4</a>).  
<!-- Volume ordinary = 0.3141592653589793 -->
<!-- Volume extreme = 157.07963267948966 -->
<!-- Volume under graph 1.43345609926 -->

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 4:  <a name="fig:initial_value"></a> A major flow of infected spread outwards the field. After a certain time, the wave has past the area and the number in each class stabilize. </p></center>
<p><img src="plots/2D_initial_variable_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
By measuring the travelling wave at point(15,15), the size and shape can be compared with the second subplot in figure(<a href="#fig:2D_trav_wave">3</a>). The travelling wave for this simulation can be seen in figure(<a href="#fig:initial_trav_wave">5</a>) and the area for the travelling wave is measured to 1.43, which is similar with the three other simulations.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 5:  <a name="fig:initial_trav_wave"></a> The travelling wave with a major increase of infected at the initial time. </p></center>
<p><img src="plots/TW_2D_initial_z_lambda_0_5.png" align="bottom" height=600 width=800></p>
</center>

<p>
By increasing the initial value for the <em>Infected</em> group, the size of the travelling will not be affected. But there is a difference in the time when the wave occur. In the simulation where the initial value is higher, the travelling wave reaches the measuring point (15,15) earlier. This can be explained by the idea of a ball dropped from a large height. If the ball is released or thrown to the ground, will only affect the acceleration of the ball, not the terminal velocity. After a certain time the released ball and the thrown ball will reach the same maximum speed. This is also the case for the speed of the travelling wave.

<h3>Change in lambda  <a name="___sec12"></a></h3>

The one thing that affects the speed and size, is the \( \lambda \) variable in the PDE system<a href="#mjx-eqn-4">(4)</a>. This \( \lambda \) is a combination of \( a \), which controls deaths among infected, \( r \), which control the number of infected in a meeting between an infected and a susceptible. The last parameter in \( \lambda \) is the concentration of Susceptible. By changing this parameter, the travelling wave will change in both size and shape. In figure(<a href="#fig:change_lambda">6</a>), the simulation is run with four different values of \( \lambda \).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 6:  <a name="fig:change_lambda"></a> The travelling wave simulated with \( \lambda \) values in the range of 0.01 to 1. </p></center>
<p><img src="plots/2D_lambda_variable.png" align="bottom" height=600 width=800></p>
</center>

<p>
To understand the result in figure(<a href="#fig:change_lambda">6</a>), the \( \lambda  \) function can be study,
$$
\begin{equation} \tag{15}
 \lambda =\frac{a}{rS_0},
\end{equation}
$$

A major and aggressive travelling wave is caused by \( \lambda \rightarrow 0 \). In figure(<a href="#fig:change_lambda">6</a>), \( \lambda \) is run with the value 0.01 in the first subplot. This results in a travelling wave of infected that eradicates the <em>Susceptible</em> group in a short time. The wave starts to decreasing when all <em>Susceptible</em> are infected. By looking at the equation<a href="#mjx-eqn-15">(15)</a>, a small value is caused by a small \( a \) compared to \( r \) and \( S_0 \). If \( a \) is low, this result in few deaths/immune in the infected class. This means that this class will grow and be able to infect even more from the <em>Susceptible</em> class. The same thing will happen if \( r \) is large. A result of this will cause an aggressive disease that infects  a major part of the population. The same result will happen if \( S_0 \) is large. Then there are several possible humans to infect. Therefore a outburst of a disease is more critically in a city than in the wilderness, far from other humans.
<br />
<br />
If \( \lambda \) increases above 1, the disease will not be able to spread. The number of infected will decrease, since the number of dead/immune caused by the <em>Infected</em> group is higher than the amount of <em>Infected</em> humans from the <em>Susceptible</em> group. After a certain time, the number of infected will die out. If \( \lambda \) stays at 1, the number of infected will be equal the whole time.

<h1>Epidemic in an English Boarding School 1978  <a name="___sec13"></a></h1>
An example from an English boarding school was presented in the previous chapter . This example was based on the book from J.D Murray <a href="._2_PDE_FK002.html#murray2002mathematical">[3]</a>, and was modeled for a ODE system. A similar result should appear for the PDE system with same parameter values and a uniform distribution of the groups. The school had 763 students where one of the students brought a disease back to the school. The following number was used for the ODE system in chapter one. \( N=763, S_0=762,I_0=1,R_0=0,\rho=202 \) and \( r = 2.18\cdot 10^{-3} \). 
<br />
<br />
The first simulation is produced with uniform distributed concentration, this is done to verify the implementation. A person is defined as one cubic. The total volume of the whole group is spread over the area. The area is sat to be 100 m x 100 m, which result in an average height of \( 1/10000 \) m per person. This is to get an uniformed distribution. This would of course be more difficult in the real life, particular if the person should be alive. Since the <em>Infected</em> group only consist of one person, the total height will be 0.0001 for the whole area. The <em>Susceptible</em> group consist of 762 students and the total height in each point will be 0.0762 The simulation can be seen in the Appendix. 
<br />
<br />
The results from the first subplot in figure(<a href="#fig:british_number">7</a>) are equal with the result from the ODE system modeled in the previous chapter.This can be seen in (<a href="#table:british_number_table">table:british_number_table</a>). This is as expected since the diffusion term is negligible in this system and simulation is a group of separate ODE systems modeled at each point over an area.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 7:  <a name="fig:british_number"></a> English Boarding School modeled with three different initial values for the infected student. The amount of students in each group modeled over 15 days. Subplot 1: uniform distribution. Subplot 2: The student is placed as a Gaussian function in center. Subplot 3: The student is placed as a Gaussian function in the corner (0,0). </p></center>
<p><img src="plots/british_number.png" align="bottom" height=1000 width=400></p>
</center>

<p>
<a name="table:british_number_table"></a>
<table border="1">
<thead>
<tr><th align="center">                   </th> <th align="center">     ODE system    </th> <th align="center">  PDE uniform dist </th> <th align="center">     PDE center    </th> <th align="center">     PDE corner    </th> </tr>
</thead>
<tbody>
<tr><td align="center">   5 Days                 </td> <td align="center">   -----------            </td> <td align="center">   -------------------    </td> <td align="center">   -----------            </td> <td align="center">   -----------            </td> </tr>
<tr><td align="center">   Susceptible            </td> <td align="center">   444.62                 </td> <td align="center">   444.62                 </td> <td align="center">   748.03                 </td> <td align="center">   757.33                 </td> </tr>
<tr><td align="center">   Infective              </td> <td align="center">   209.56                 </td> <td align="center">   209.56                 </td> <td align="center">   7.36                   </td> <td align="center">   2.35                   </td> </tr>
<tr><td align="center">   Removed                </td> <td align="center">   108.82                 </td> <td align="center">   108.82                 </td> <td align="center">   7.60                   </td> <td align="center">   3.32                   </td> </tr>
<tr><td align="center">   10 Days                </td> <td align="center">   -----------            </td> <td align="center">   -------------------    </td> <td align="center">   -----------            </td> <td align="center">   -----------            </td> </tr>
<tr><td align="center">   Susceptible            </td> <td align="center">   37.59                  </td> <td align="center">   37.59                  </td> <td align="center">   697.71                 </td> <td align="center">   743.58                 </td> </tr>
<tr><td align="center">   Infective              </td> <td align="center">   117.59                 </td> <td align="center">   117.59                 </td> <td align="center">   24.43                  </td> <td align="center">   6.66                   </td> </tr>
<tr><td align="center">   Removed                </td> <td align="center">   607.82                 </td> <td align="center">   607.82                 </td> <td align="center">   40.86                  </td> <td align="center">   12.76                  </td> </tr>
<tr><td align="center">   15 Days                </td> <td align="center">   -----------            </td> <td align="center">   -------------------    </td> <td align="center">   -----------            </td> <td align="center">   -----------            </td> </tr>
<tr><td align="center">   Susceptible            </td> <td align="center">   21.09                  </td> <td align="center">   21.09                  </td> <td align="center">   597.01                 </td> <td align="center">   717.02                 </td> </tr>
<tr><td align="center">   Infective              </td> <td align="center">   17.30                  </td> <td align="center">   17.30                  </td> <td align="center">   46.96                  </td> <td align="center">   12.37                  </td> </tr>
<tr><td align="center">   Removed                </td> <td align="center">   724.62                 </td> <td align="center">   724.62                 </td> <td align="center">   119.03                 </td> <td align="center">   33.61                  </td> </tr>
</tbody>
</table>
<!-- dx = 0.04 -->
<!-- dx^2 = 1.6E-3 -->
<!-- ODE = 1.5E-4 -->

<h3>Introducing a Gaussian distribution of infective  <a name="___sec14"></a></h3>

An assumption to make is that a person is not able to be evenly distributed over an area. In this example with only one infected student at initial time, the chance of being infected increase as closer you get to the infected student. The student in placed as a Gaussian function in the middle of the school yard, to see if this affect the result. The height is sat to 1 and the volume of the Gauss function is sat to 1 cubic. The simulation can be seen in figure(<a href="#fig:gauss_sub">8</a>) and the total total amount of students can be be seen in figure(<a href="#fig:british_number">7</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  <a name="fig:gauss_sub"></a> The student is placed in the center of the school yard as a Gaussian finction with height= 1 m and volume = 1 m^3. </p></center>
<p><img src="plots/2D_british_school_gauss_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
The results from the uniform distributed and Gaussian distributed simulations shows variously results. The difference between the simulations is the placement of the infective. This change has a major impact. Since the only one that can be infected with the Gaussian distribution are the students close to the infective, it restrict the spread of the epidemic. While the chance of getting infected in this area is higher. The figure(<a href="#fig:gauss_sub">8</a>) shows that the amount of infective quickly grow in the center, where the infected was placed. The last subplot also show that the amount of removed in the center are closed to the maximum of the initial value of Susceptible. While the students along the boundary of the school yard seems to be unaffected after 15 days. This simulation shows that the placement of the infective has a major role in the simulation.
<br />
<br />
The placement of the infective, here as a Gaussian function, also affects the outcome. The last subplot in Fi.(<a href="#fig:british_number">7</a>) describes a simulation where the Gaussian function is placed in the corner(0,0). The total volume of the function is increased to 4 since only a quarter of the function is placed in the area. The table (<a href="#table:british_number_table">table:british_number_table</a>) shows that the total number of infected is lower than for the centered placed Gaussian. The infected student is only able to spread the disease to a quarter of the population compared to the infected one in the center. The simulation can be seen in the Appendix.
<br />
<br />
If the simulations are run for a longer time, the difference between each class will decrease. After 100 days there will be about 18 susceptible students left in the uniform distributed group, compared to 25 students in both of the Gaussian groups. The simulations can be seen in the Appendix.

<p>
<p>
<!-- begin bottom navigation -->
<a href="._2_PDE_FK001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

