<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Geographic models">

<title>Geographic models</title>


<style type="text/css">
/* blueish style */

/* Color definitions:  http://www.december.com/html/spec/color0.html
   CSS examples:       http://www.w3schools.com/css/css_examples.asp */

body {
  margin-top: 1.0em;
  background-color: #ffffff;
  font-family: Helvetica, Arial, FreeSans, san-serif;
  color: #000000;
}
h1 { font-size: 1.8em; color: #1e36ce; }
h2 { font-size: 1.6em; color: #1e36ce; }
h3 { font-size: 1.4em; color: #1e36ce; }
a { color: #1e36ce; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Introduction ', 1, None, '___sec0'),
              (' Simple system for spatial spread ', 1, None, '___sec1'),
              (' Travelling wave 1D ', 2, None, '___sec2'),
              (' Verifying the solution ', 2, None, '___sec3'),
              (' Constant solution ', 3, None, '___sec4'),
              (' Manufactured solution ', 3, None, '___sec5'),
              (' Convergence rate ', 3, None, '___sec6'),
              (' The spatial error ', 3, None, '___sec7'),
              (' The temporal error ', 3, None, '___sec8'),
              (' Travelling wave in 2D ', 2, None, '___sec9'),
              (' A gaussian wave ', 3, None, '___sec10'),
              (' Change in initial flow ', 3, None, '___sec11'),
              (' Change in lambda ', 3, None, '___sec12'),
              (' Epidemic in an English Boarding School 1978 ',
               1,
               None,
               '___sec13'),
              (' Introducing a Gaussian distribution of infective ',
               3,
               None,
               '___sec14'),
              (' Zombiefication ', 1, None, '___sec15'),
              (' Where does the infected one arises ', 3, None, '___sec16'),
              (' Lock in different areas ', 2, None, '___sec17'),
              (' Ten minutes at Frederikkeplassen ', 3, None, '___sec18'),
              (' random distribution ', 3, None, '___sec19'),
              (' Appendix ', 1, None, '___sec20'),
              (' Sympy to find manufactured solution ', 3, None, '___sec21'),
              (' Discretization ', 2, None, '___sec22'),
              (' 2D Gaussian function from x=0 ', 2, None, '___sec23'),
              (' 2D Gaussian function from x=0,y=0 ', 2, None, '___sec24'),
              (' 2D Gaussian function from x=0,y=0 with higher initial value ',
               2,
               None,
               '___sec25'),
              (' English Boarding School ', 2, None, '___sec26'),
              (' Gaussian from the corner ', 3, None, '___sec27'),
              (' A long simulation on 100 Days ', 3, None, '___sec28'),
              (' Zombiefication ', 2, None, '___sec29'),
              (' Verify the initial phase ', 3, None, '___sec30'),
              (' Three phases ', 3, None, '___sec31'),
              (' middle town ', 3, None, '___sec32'),
              (' large town ', 3, None, '___sec33'),
              (' Bibliography ', 1, None, '___sec34')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<a name="part0002"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._2_PDE_FK001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="&laquo; Previous"></a></div>
</td><td>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1>Appendix  <a name="___sec20"></a></h1>

<h3>Sympy to find manufactured solution  <a name="___sec21"></a></h3>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x,t,lam <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;x t lam&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s_simple</span>(x,t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> cos(pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span> 
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">i_simple</span>(x,t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> cos(pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span> 
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">r_simple</span>(x,t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> cos(pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span> 
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">for</span> x_point <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">0</span>,<span style="color: #666666">1</span>:
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;s_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span>, <span style="color: #666666">%</span> x_point,
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">for</span> x_point <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">0</span>,<span style="color: #666666">1</span>:
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;s_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(s_simple(x,t),x)<span style="color: #666666">.</span>subs(x,x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;i_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(i_simple(x,t),x)<span style="color: #666666">.</span>subs(x,x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;r_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t): &quot;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(r_simple(x,t),x)<span style="color: #666666">.</span>subs(x,x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span> 
s_x(<span style="color: #666666">0</span>,t):  <span style="color: #666666">0</span>
i_x(<span style="color: #666666">0</span>,t):  <span style="color: #666666">0</span>
r_x(<span style="color: #666666">0</span>,t):  <span style="color: #666666">0</span>
s_x(<span style="color: #666666">1</span>,t):  <span style="color: #666666">0</span>
i_x(<span style="color: #666666">1</span>,t):  <span style="color: #666666">0</span>
r_x(<span style="color: #666666">1</span>,t):  <span style="color: #666666">0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> s_simple(x,t)
<span style="color: #666666">&gt;&gt;&gt;</span> i <span style="color: #666666">=</span> i_simple(x,t)
<span style="color: #666666">&gt;&gt;&gt;</span> r <span style="color: #666666">=</span> r_simple(x,t)
<span style="color: #666666">&gt;&gt;&gt;</span> f <span style="color: #666666">=</span> diff(s,t)<span style="color: #666666">+</span>i<span style="color: #666666">*</span>s<span style="color: #666666">-</span>diff(diff(s,x),x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> f<span style="color: #666666">.</span>simplify()
(t<span style="color: #666666">**2*</span>cos(pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>cos(pi<span style="color: #666666">*</span>x)
<span style="color: #666666">&gt;&gt;&gt;</span> g <span style="color: #666666">=</span> diff(i,t)<span style="color: #666666">-</span>i<span style="color: #666666">*</span>s<span style="color: #666666">+</span>lam<span style="color: #666666">*</span>i<span style="color: #666666">-</span>diff(diff(i,x),x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> g<span style="color: #666666">.</span>simplify()
(lam<span style="color: #666666">*</span>t <span style="color: #666666">-</span> t<span style="color: #666666">**2*</span>cos(pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>cos(pi<span style="color: #666666">*</span>x)
<span style="color: #666666">&gt;&gt;&gt;</span> h <span style="color: #666666">=</span> diff(r,t)<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>i<span style="color: #666666">-</span>diff(diff(r,x),x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> h<span style="color: #666666">.</span>simplify()
(<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>t <span style="color: #666666">+</span> pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>cos(pi<span style="color: #666666">*</span>x)
</pre></div>

<h2>Discretization  <a name="___sec22"></a></h2>
$$
\begin{equation} \tag{23}
	\begin{aligned} 
	\frac{dS}{dt} =& \Sigma -\beta SZ - \delta_SS + \nabla(\gamma_s(x)\nabla S) \\
	\frac{dI}{dt} =& \beta SZ - \varrho I - \delta_II+\nabla(\gamma_I(x)\nabla I)\\
	\frac{dZ}{dt} =& \varrho I- (\alpha+\omega(t))SZ + \zeta R+ \nabla(\gamma_Z(x)\nabla Z)\\
	\frac{dR}{dt} =& \delta_SS +\delta_II -\zeta R + (\alpha+\omega(t))SZ 
	\end{aligned}
\end{equation}
$$

The calculations will be shown for the diffusion part in the first equation. This idea will be used for the whole system

$$
\begin{equation}
	\begin{aligned}
	\frac{dS}{dt} =& \nabla(\gamma_s(x)\nabla S) \\
    \frac{S^{n+1}_{i,j}-S^n_{i,j}}{\Delta t} &= \left(\gamma(x_{i+1/2,j})\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y}\right) 
	\end{aligned}
\end{equation}
$$

<h2>2D Gaussian function from x=0  <a name="___sec23"></a></h2>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 13:  The PDE system <a href="._2_PDE_FK000.html#mjx-eqn-4">(4)</a> simulated for a 2D system with \( \lambda=0.5 \). A gauss wave from \( x=0 \). </p></center>
<p><img src="plots/2D_gauss_sub.png" align="bottom" height=600 width=800></p>
</center>

<h2>2D Gaussian function from x=0,y=0  <a name="___sec24"></a></h2>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 14:  A gaussian function from \( x=0,y=0 \) based on the PDE system <a href="._2_PDE_FK000.html#mjx-eqn-4">(4)</a> with \( \lambda=0.5 \) </p></center>
<p><img src="plots/2D_gauss_one_sub.png" align="bottom" height=600 width=800></p>
</center>

<h2>2D Gaussian function from x=0,y=0 with higher initial value  <a name="___sec25"></a></h2>

<h2>English Boarding School  <a name="___sec26"></a></h2>

<p>
<center><p><img src="plots/2D_british_school_sub.png" align="bottom" height=600 width=800></p></center>

<h3>Gaussian from the corner  <a name="___sec27"></a></h3>

<p>
<center><p><img src="plots/2D_british_school_gauss_corner_sub.png" align="bottom" height=600 width=800></p></center>

<h3>A long simulation on 100 Days  <a name="___sec28"></a></h3>

<p>
<center><p><img src="plots/2D_british_school_long_number.png" align="bottom" height=600 width=800></p></center>

<p>
<center><p><img src="plots/2D_british_school_gauss_long_number.png" align="bottom" height=600 width=800></p></center>

<p>
<center><p><img src="plots/2D_british_school_gauss_corner_long_number.png" align="bottom" height=600 width=800></p></center>

<h2>Zombiefication  <a name="___sec29"></a></h2>

<h3>Verify the initial phase  <a name="___sec30"></a></h3>

<p>
<center><p><img src="plots/2D_zombie_initial_cond_sub.png" align="bottom" height=600 width=800></p></center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 15:  Creates the same results as for the ODE system </p></center>
<p><img src="plots/2D_zombie_initial_cond_number.png" align="bottom" height=600 width=800></p>
</center>

<h3>Three phases  <a name="___sec31"></a></h3>

<p>
<center><p><img src="plots/2D_zombie_three_phases_sub.png" align="bottom" height=600 width=800></p></center>

<h3>middle town  <a name="___sec32"></a></h3>

<p>
<center><p><img src="plots/2D_zombie_three_phases_zombie_middle_town_surface_sub.png" align="bottom" height=600 width=800></p></center>

<h3>large town  <a name="___sec33"></a></h3>

<p>
<center><p><img src="plots/2D_zombie_three_phases_zombie_large_town_sub.png" align="bottom" height=600 width=800></p></center>

<p>
<!-- MOVIE:[plots/2D_gaussian.webm, height=500 width=600] Travelling wave modeled with the same values as for 1D. -->
<!-- MOVIE:[plots/2D_one_corner.webm, height=500 width=600] Starting the travelling wave from the corner. -->
<!-- MOVIE:[plots/2D_initial_variable.webm, height=500 width=600] Travelling wave with a greater initial wave. -->
<!-- MOVIE:[plots/2D_british_school.webm, height=500 width=600] Acts like the ODE system -->
<!-- MOVIE:[plots/2D_british_school_gauss.webm, height=500 width=600] The sick one is placed in the center of the School area. -->
<!-- MOVIE:[plots/2D_british_school_gauss_corner.webm, height=500 width=600] A wave of infected moves towards the school yard -->
<!-- MOVIE:[plots/2D_zombie_initial_cond.webm, height=500 width=600] -->
<!-- MOVIE:[plots/2D_zombie_three_phases.webm, height=500 width=600] -->
<!-- MOVIE:[plots/2D_zombie_three_phases_zombie_small_town.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_zombie_small_town_surface.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_zombie_middle_town.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_zombie_middle_town_surface.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_zombie_large_town.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_zombie_large_town_surface.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_blindern_area_contourf.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->
<!-- MOVIE:[plots/2D_zombie_three_phases_blindern_area_3_ph_contourf.webm, height=500 width=600] Created with different diffusion constants. The groups of susceptible are placed in three different areas. -->

<h1>Bibliography  <a name="___sec34"></a></h1>

<p>
<!-- begin bibliography -->

<ol>
 <li> <a name="murray2003mathematical"></a> <b>J. Murray</b>. 
    <em>Mathematical Biology II: Spatial Models and Biomedical Applications</em>,
    Springer,
    2003,
    <a href="http://books.google.no/books?id=2d-RLuD\_MX8C" target="_self"><tt>http://books.google.no/books?id=2d-RLuD\_MX8C</tt></a>.</li>
 <li> <a name="zombie-math"></a> <b>H. P. Langtangen, K.-A. Mardal and P. R\otnes</b>. 
    Escaping the Zombie Threat by Mathematics,
    Zombies in the Academy: living death in higher education,
    edited by <b>C. M. A. Whelan and R. Walker</b>,
    University of Chicago Press,
    Chapter 3.6,
    pp. pp. x-y,
    2013.</li>
 <li> <a name="murray2002mathematical"></a> <b>J. Murray</b>. 
    <em>Mathematical Biology: I. an Introduction</em>,
    Springer,
    2002,
    <a href="http://books.google.no/books?id=4WbpP90Gk1YC" target="_self"><tt>http://books.google.no/books?id=4WbpP90Gk1YC</tt></a>.</li>
</ol>

<!-- end bibliography -->

<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._2_PDE_FK001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="&laquo; Previous"></a></div>
</td><td>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

