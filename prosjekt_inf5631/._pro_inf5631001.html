<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Project inf5631">



<style type="text/css">
    /* blueish style */

    /* Color definitions:  http://www.december.com/html/spec/color0.html
       CSS examples:       http://www.w3schools.com/css/css_examples.asp */

    body {
      margin-top: 1.0em;
      background-color: #ffffff;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    h1 { font-size: 1.8em; color: #1e36ce; }
    h2 { font-size: 1.6em; color: #1e36ce; }
    h3 { font-size: 1.4em; color: #1e36ce; }
    a { color: #1e36ce; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' The model: Reaction diffusion equation ',
               1,
               None,
               '___sec0'),
              (' Reaction term ', 1, None, '___sec1'),
              (' Fisher-Kolmogoroff term ', 2, None, '___sec2'),
              (" Fisher's equation ", 3, None, '___sec3'),
              (' Carrying capacity ', 3, None, '___sec4'),
              (' Reproduction rate ', 3, None, '___sec5'),
              (' Spatial diffusion ', 1, None, '___sec6'),
              (' Boundary conditions ', 3, None, '___sec7'),
              (' Linear equation ', 2, None, '___sec8'),
              (' Nonlinear equation ', 2, None, '___sec9'),
              (' Picard ', 3, None, '___sec10'),
              (' Ordinary u ', 3, None, '___sec11'),
              (' Spatial derivation wrapped with an absolute value ',
               3,
               None,
               '___sec12'),
              (' Absolute value powered by m ', 3, None, '___sec13'),
              (' Solution for the biological equation ', 1, None, '___sec14'),
              (' Constant ', 3, None, '___sec15'),
              (' Ordinary ', 3, None, '___sec16'),
              (' Absolute value ', 3, None, '___sec17'),
              (' Absolute powered up ', 3, None, '___sec18'),
              (' Further work ', 1, None, '___sec19'),
              (' Changes in the Boundary conditions ', 2, None, '___sec20'),
              (' Dirichlet boundary condition ', 3, None, '___sec21'),
              (' Neumann boundary condition ', 3, None, '___sec22'),
              (" Newton's method ", 2, None, '___sec23')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




    
<a name="part0001"></a>
<!-- begin top navigation -->
<a href="._pro_inf5631000.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._pro_inf5631002.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- !split -->

<h1>Spatial diffusion  <a name="___sec6"></a></h1>
The first part of the RD equation describe the spatial flow and how the values in \( u \) are
affected by their neighbours.  
$$
\begin{equation}
	u_t = \nabla \cdot \alpha(u)\nabla u
\end{equation}
$$

This part consist of the function \( \alpha(u) \). This
affects the diffusion of the model. 
To solve this numerically, we need to discretize the equation.
$$
\begin{equation*}
	\left[D_t^-u=D_x(\alpha(u) D_x u)\right]
\end{equation*}
$$

I use Backward Euler for the time discrete and Crank Nicolson for the spatial
discrete. 
$$
\begin{align*}
	\frac{u^n_i-u^{n-1}_i}{\Delta t}=& \frac{1}{\Delta x^2}\left(\alpha_{i+\frac{1}{2}}(u_{i+1}-u_i)-\alpha_{i-\frac{1}{2}}(u_{i}-u_{i-1})\right)\\
	u^{n-1}_i=&u^n_i- \frac{\Delta t}{\Delta x^2}\left(\alpha_{i+\frac{1}{2}}(u_{i+1}-u_i)-\alpha_{i-\frac{1}{2}}(u_{i}-u_{i-1})\right)
\end{align*}
$$

Then we are able to put this into a linear equation as the section above. 
$$
\begin{equation}
A =
\left(
\begin{array}{cccccccccc}
A_{0,0} & A_{0,1} & 0
&\cdots &
\cdots & \cdots & \cdots &
\cdots & 0 \\
A_{1,0} & A_{1,1} & A_{1,2} & \ddots &   & &  & &  \vdots \\
0 & A_{2,1} & A_{2,2} & A_{2,3} &
\ddots & &  &  & \vdots \\
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\
\vdots & &  & 0 & A_{i,i-1} & A_{i,i} & A_{i,i+1} & \ddots & \vdots \\
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\
\vdots & & & &  &\ddots  & \ddots &\ddots  & A_{N_x-1,N_x} \\
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & A_{N_x,N_x-1} & A_{N_x,N_x}
\end{array}
\right)
\tag{14}
\end{equation}
$$

Our matrix \( A \) will then be tridiagonal with the values.
$$
\begin{align} \tag{2}
A_{i,i} =& 1+\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}})+\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}}))
\end{align}                               
$$

We can see that in the cases where we replace
\( \alpha(u) \) with a function that contains \( u \), we will get a nonlinear equation.

<h3>Boundary conditions  <a name="___sec7"></a></h3>

I have specified the boundary conditions in the first section to be zero. This has to be implemented in the linear function.
Our matrix A will then be
$$
\begin{align*}
A_{0,0} &= 1,\\
A_{0,1} &= 0,\\
A_{N_x,N_x-1} &= 0,\\
A_{N_x,N_x} &= 1
\end{align*}
$$

And the b array with known values will be
$$
\begin{align*}
b_0 &= 0,\\
b_i &= u^{n-1}_i,\quad i=1,\ldots,N_x-1,\\
b_{N_x} &= 0 
\end{align*}
$$

This decision affects the equilibrium state.

<h2>Linear equation  <a name="___sec8"></a></h2>
The only solution for a linear equation is to replace \( \alpha \) by a
constant.
$$
\begin{equation}
	\alpha(u) = k
\end{equation}
$$

We can then use our matrix from<a href="#mjx-eqn-2">(2)</a> and insert the function. This gives us
the matrix:
$$
\begin{align*} \tag{3}
A_{i,i} =& 1+\frac{\Delta t}{\Delta x^2}(2k)=1+\frac{2k\Delta t}{\Delta x^2}\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(k)=-\frac{k \Delta t}{\Delta x^2}\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(k)=-\frac{k \Delta t}{\Delta x^2}\\
\end{align*}                               
$$

The movies under represents different values for \( k \)

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/constant.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>constant</em></p>


<p>
Here it is quite clearly that the size of \( \alpha \) controls the speed of the
diffusion. A large \( \alpha \) will get the function faster towards zero.

<h2>Nonlinear equation  <a name="___sec9"></a></h2>
We will get a nonlinear solution for all \( \alpha \)'s that include \( u \). 
I will as in the previous section use Picard to solve it. There are also
other methods to solve nonlinear equation like Newton's method. This method often demands
a little bit more work, but is often more efficiency.

<h3>Picard  <a name="___sec10"></a></h3>

<h3>Ordinary u  <a name="___sec11"></a></h3>

$$
\begin{equation}
	\alpha(u) = u\\
\end{equation}
$$


<p>
Since we only used CN for one step in the general calculation for \( \alpha \), we need to use arithmetic mean
to be able to get values from \( u \).
$$
\begin{equation*}
	\alpha_{i\pm\frac{1}{2}} =\frac{1}{2}(\alpha_i+\alpha_{i\pm1}) 
\end{equation*}
$$


<p>
Then we can insert \( u \) in the matrix<a href="#mjx-eqn-2">(2)</a>.
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(u_{i+1}+2u_{i}+u_{i-1})\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(u_{i}+u_{i-1})\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(u_{i+1}+u_{i})
\end{align*}                               
$$

This gives us a nonlinear problem. We can here replace \( u \) by \( u\_ \)
as explained in the section \emph{Time Derivative}.
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(u\__{i+1}+2u\__{i}+u\__{i-1})\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(u\__{i}+u\__{i-1})\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(u\__{i+1}+u\__{i})
\end{align*}                               
$$

I will do a couple of different setup for this function. First I will try to plot
a simulation where I only use the previous value \( u\_ \) in my matrix. Then I will add
an error measure that use several Picard iterations.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='submovies/ordinary_sub.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>ordinary with different tolerance for Picard</em></p>


<p>
These results show us the behavior of \( u\_ \) when it varies from the previous
time step up to the current time step. The simulation without any Picard
iteration, gives us a wall that spreads in each direction. This wall becomes
smaller the closer \( u\_ \) goes towards \( u \). 

<p>
An important aspect to be aware of when working with
diffusion equation, is that the result after a certain time will be close to  equal in all
the simulations. This happens because of the equilibrium principle. An example
of this is the temperature in a room. The diffusion will cause it to go towards a smooth and
balanced temperature in each point of the room. Therefore it is more interesting
to look at the movement towards the equilibrium than the final result.

<h3>Spatial derivation wrapped with an absolute value  <a name="___sec12"></a></h3>

$$
\begin{equation}
\alpha(u) = |\nabla(u)|
\end{equation}
$$

Since we now have used CN one time on this, we can do it again. This will give
us integer numbers to use in \( u \).
$$
\begin{align*}
\alpha(u_{i+\frac{1}{2}}) =& \left|\nabla(u_{i+\frac{1}{2}})\right|\\
\alpha(u_{i+\frac{1}{2}}) =& \left|\frac{u_{i+1}-u_i}{\Delta x}\right|
\end{align*}
$$

We can do the same thing for \( \alpha_{i-\frac{1}{2}} \) and insert them both in
the matrix.
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_i-u_{i-1}}{\Delta x}\right|+ \left|\frac{u_{i+1}-u_i}{\Delta x}\right|)\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_i-u_{i-1}}{\Delta x}\right|)\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_{i+1}-u_i}{\Delta x}\right|)
\end{align*}                               
$$

To use this with Picard, we need to replace \( u\_=u \). We can also move \( \Delta x \)
out of the fraction, because \( \Delta x > 0 \).
$$
\begin{align} \tag{4}
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|+ \left|u\__{i+1}-u\__i\right|)\notag\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|)\notag\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__{i+1}-u\__i\right|)
\end{align}                               
$$


<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='movies/spatial_abs_std.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>abs_std</em></p>


<p>

<div>
<video  loop controls width='375' height='300' preload='none'>
    <source src='movies/spatial_abs_std_picard_tol__5.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>abs_std_picard tol = 10^-5</em></p>


<p>
This also starts with a wall in each directions and then develops into smaller steps that nearly disappears when t gets larger.
While the Picard solution gives a smoother curve.

<h3>Absolute value powered by m  <a name="___sec13"></a></h3>

$$
\begin{equation}
	\alpha(u) = |\nabla(u)|^m
\end{equation}
$$

This equation is solved in the exact same as the equation above. We can then use
the matrix <a href="#mjx-eqn-4">(4)</a> and insert the power.
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|^m+ \left|u\__{i+1}-u\__i\right|^m)\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|^m)\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__{i+1}-u\__i\right|^m)
\end{align*}
$$


<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/abs_std_power.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>Powered by m</em></p>


<p>
Here the length of the simulation, \( T \) is sat to be quite large. This is to show the effect of the power in
this function. We can see that it quite fast moves towards zero when the power is low. But it seems that the equilibrium state for all these are at zero. The power only affect the speed.

<p>
<p>
<!-- begin bottom navigation -->
<a href="._pro_inf5631000.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._pro_inf5631002.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

