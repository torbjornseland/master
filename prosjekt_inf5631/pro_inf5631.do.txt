TITLE: Project inf5631 
AUTHOR: Torbj√∏rn Seland
DATE: today

TOC: on

##doconce format html pro_inf5631
##doconce split_html pro_inf5631 
======= Reaction diffusion equation =======
The efficiency of computers has increased vastly over the last few decades, giving scientists and engineers new tools to describe the dynamics of the world around us. It has also affected the way biological processes are viewed and described. This project will focus on numerical methods to solve the reaction diffusion equation which is described below. Reaction-diffusion systems explain how the concentration of one or more substances changes under the influence of the local chemical reactions, here $f(u)$ and diffusion which cause a spatial dispersion. This system are applied in fields as chemistry, biology, geology, physics and ecology. 
!bt
\begin{align} label{eq:reaction_diffusion}
u_t =& \nabla \cdot \alpha(u)\nabla u + f(u)\\
u(x,0) =& I(x)\notag \\
u(0,t)=& 0\notag \\
u(L,t)=& 0\notag
\end{align}
!et
Here, $u$ denotes the concentration of the substance in
one spatial dimension. To get a better understanding, the model will be split up the model. The right side of the equation consist of two parts. The first part describes the spatial flow while the second describes the reaction term.
===== Fisher-Kolmogoroff equation =====
My main focus in this project will be at the Fisher-Kolmogoroff equation. This was proposed as a one-dimensional model by Fisher(1937) to describe the spread of an advantageous gene in a population. Kolmogoroff et al.(1937) did a study of this equation and obtained some of the basic analytical results [1(Mathematical Biology, I an introduction, 11.Reaction Diffusion)].
If we in out general equation (ref{eq:reaction_diffusion}) set $\alpha(u)=k$ and $f(u) = ru(1-\frac{u}{m})$. We will 
get the equation
!bt
\begin{equation}
\frac{\partial u}{\partial t} = k\frac{\partial^2u}{\partial x^2}+ru(1-\frac{u}{m})
\end{equation}
!et
=== Travelling wavefront ===
A good reason to study this equation, is because it is the prototype equation which admits travelling wavefront solutions. This is also a good equation for develop many of the standard techniques to analyse a single-species model with diffusion dispersal.[2,(Mathematical Biology, I an introduction, 13.Biological waves, 440)] When we now want to investigate the travelling wavefront. Then it is convenient to rescale the equation, by writing.
!bt
t* = rt,	x* = x(\frac{r}{k})^{1/2}
!et
The equation then become when we set $m=1$. $m$ describes the carrying capacity which in the travelling wavefront will be between 0 and 1.
!bt
\begin{equation} label{eq:trav_wave}
\frac{\partial u}{\partial t} = \frac{\partial^2u}{\partial x^2}+u(1-\frac{u}{m})
\end{equation}
!et

Since $m=1$ the steady states are $u=0$ and $u=1$, which are respectively unstable and stable.
If the solution represents a travelling wave, then the shape of the wave will move with the speed $c$. We
are then able to show the travelling wave stationary.
!bt
u(x,t) = u(x-ct) = U(z), x-ct = z
!et
Here we use $U(z)$ instead of $u(u)$. This is just to avoid any confusion of the terminology. We also assume
that $c \geq 0$. Substituting this traveling wavefront into (ref{eq:trav_wave}), we get
!bt
U'' +cU' + U(1-U) = 0
!et
======= Reaction term =======
The reaction term describes the change in concentration in a certain point. This variation is only affected
by the local chemical reaction.(Blir litt likt beskrivelsen i "The model")
!bt
\begin{equation}
u_t = f(u)
\end{equation}
!et
To see the properties of this equation, it can be discretized and solved numerically for
different values of $f(u)$.

!bt
\begin{align*}
u_t =& f(u)\\
\frac{u^n_i-u^{n-1}_i}{\Delta t}=& f(u^n_i)\\
u^n_i-\Delta t f(u^n_i) =& u^{n-1}_i
\end{align*}
!et
This gives a linear equation $Au = b$ that easy can be solved.
===== Fisher-Kolmogoroff term =====
A Fisher-Kolmogoroff term, now referred to as FK, is a nonlinear term which often arises from biological applications. It takes the form $f(u) = ru(1-u/m)$, where $r$ describes the linear reproduction and $m$ the carrying capacity of this environment. The solution will then be.
!bt
\begin{equation}
f(u) = ru(1-\frac{u}{m})
\end{equation}
!et

!bt
\begin{align*}
u^n_i-\Delta t *ru^n_i(1-\frac{u^n_i}{m}) =& u^{n-1}_i\\
u^n_i(1-\Delta t r(1-\frac{u^n_i}{m})) =& u^{n-1}_i
\end{align*}
!et

Since this equation gives us a nonlinear equation, we can use Picard Iteration to solve
it. The idea with Picard Iteration is to replace one of the $u$ in the nonlinear part of the equation with $u\_$. $u\_$ will in the first
iteration be sat to the value from the previous step $u\_1$. 

!bt
\begin{equation*}
	u\_ = u^{n-1}
\end{equation*}
!et

We can check the correct value $u$ against our pre produced $u\_$ each round. If the difference between
them are less than a predefined limit, the new solution is accepted. If not, the new $u\_$ will be a combination of $u\_$ and $u$. How we weight the combination is called relaxation 

!bt
\begin{equation*}
u\_ = \gamma u + (1-\gamma)u\_, 0<= \gamma <=1
\end{equation*}
!et

Our new equation will then be

!bt
\begin{align*}
	u^n_i(1- \Delta t r(1-\frac{u\__i^n}{m}))=& u^{n-1}_i\\
\end{align*}
!et

Since $u\_$ is an approximation to $u$, we need to refine $u\_$ until it fulfil the expectations.

=== Fisher's equation ===
The values from FK is sat to $r=1$ and $m=1$. This is called Fisher's equation.The reaction term in Fisher will look like this.

MOVIE: [paramovies/constant_fisher_few_points.webm, height=300,width=375]Fisher with ten points

MOVIE: [movies/time_der_r_1_0_m_1_0.webm, height=300,width=375] r= 1, m= 1 

=== Carrying capacity ===
First it can be interesting to look at the changes in the carrying capacity of
the function.

MOVIE: [paramovies/time.webm, height=300,width=375]time

Here we can see that they all goes towards their carrying capacity and stabilizes here.
I have set $r=1$ in all of this simulations. The displacement from intial conditions to
final conditions is quite similar in all of the cases.

=== Reproduction rate ===
We can do a similar thing with the reproduction $r$.

MOVIE: [paramovies/time_r.webm, height=300,width=375]time_r

This controls the speed of the movement. A larger reproduction will get in faster
to the steady state, that $m$ controls.The carrying capacity is sat to $m=0.8$.

!split
======= Spatial diffusion =======
The first part of the RD equation describes the spatial flow and how the values in $u$ are
affected by their neighbours.  
!bt
\begin{equation}
	u_t = \nabla \cdot \alpha(u)\nabla u
\end{equation}
!et
This part consist of the function $\alpha(u)$. This
affects the diffusion of the model. 
To solve this numerically, we need to discretize the equation.
!bt
\begin{equation*}
	\left[D_t^-u=D_x(\alpha(u) D_x u)\right]
\end{equation*}
!et
I use Backward Euler for the time discrete and Crank Nicolson for the spatial
discrete. 
!bt
\begin{align*}
	\frac{u^n_i-u^{n-1}_i}{\Delta t}=& \frac{1}{\Delta x^2}\left(\alpha_{i+\frac{1}{2}}(u_{i+1}-u_i)-\alpha_{i-\frac{1}{2}}(u_{i}-u_{i-1})\right)\\
	u^{n-1}_i=&u^n_i- \frac{\Delta t}{\Delta x^2}\left(\alpha_{i+\frac{1}{2}}(u_{i+1}-u_i)-\alpha_{i-\frac{1}{2}}(u_{i}-u_{i-1})\right)
\end{align*}
!et
Then we are able to put this into a linear equation as the section above. 
!bt
\begin{equation}
A =
\left(
\begin{array}{cccccccccc}
A_{0,0} & A_{0,1} & 0
&\cdots &
\cdots & \cdots & \cdots &
\cdots & 0 \\
A_{1,0} & A_{1,1} & A_{1,2} & \ddots &   & &  & &  \vdots \\
0 & A_{2,1} & A_{2,2} & A_{2,3} &
\ddots & &  &  & \vdots \\
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\
\vdots & &  & 0 & A_{i,i-1} & A_{i,i} & A_{i,i+1} & \ddots & \vdots \\
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\
\vdots & & & &  &\ddots  & \ddots &\ddots  & A_{N_x-1,N_x} \\
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & A_{N_x,N_x-1} & A_{N_x,N_x}
\end{array}
\right)
\tag{14}
\end{equation}
!et
Our matrix $A$ will then be tridiagonal with the values.
!bt
\begin{align} label{eq:matrix_spatial}
A_{i,i} =& 1+\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}})+\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}}))
\end{align}                               
!et
We can see that in the cases where we replace
$\alpha(u)$ with a function that contains $u$, we will get a nonlinear equation.
=== Boundary conditions ===
I have specified the boundary conditions in the first section to be zero. This has to be implemented in the linear function.
Our matrix A will then be
!bt
\begin{align*}
A_{0,0} &= 1,\\
A_{0,1} &= 0,\\
A_{N_x,N_x-1} &= 0,\\
A_{N_x,N_x} &= 1
\end{align*}
!et
And the b array with known values will be
!bt
\begin{align*}
b_0 &= 0,\\
b_i &= u^{n-1}_i,\quad i=1,\ldots,N_x-1,\\
b_{N_x} &= 0 
\end{align*}
!et
This decision affects the equilibrium state. 
===== Linear equation =====
The only solution for a linear equation is to replace $\alpha$ by a
constant.
!bt
\begin{equation}
	\alpha(u) = k
\end{equation}
!et
We can then use our matrix from(ref{eq:matrix_spatial}) and insert the function. This gives us
the matrix:
!bt
\begin{align*} label{eq:matrix_constant}
A_{i,i} =& 1+\frac{\Delta t}{\Delta x^2}(2k)=1+\frac{2k\Delta t}{\Delta x^2}\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(k)=-\frac{k \Delta t}{\Delta x^2}\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(k)=-\frac{k \Delta t}{\Delta x^2}\\
\end{align*}                               
!et
The movies under represents different values for $k$

MOVIE: [paramovies/constant.webm, height=300,width=375]constant 

##N=Nx=200,T=L=10

Here it is quite clearly that the size of $\alpha$ controls the speed of the
diffusion. A large $\alpha$ will get the function faster towards zero. 

===== Nonlinear equation =====
We will get a nonlinear solution for all $\alpha$'s that include $u$. 
I will as in the previous section use Picard Iteration to solve it. There are also
other methods to solve nonlinear equation like Newton's method. This method often demands
a little bit more work, but is often more efficiency. 
=== Picard Iteration ===
=== Ordinary u ===
!bt
\begin{equation}
	\alpha(u) = u\\
\end{equation}
!et

Since we only used CN for one step in the general calculation for $\alpha$, we need to use arithmetic mean
to be able to get values from $u$.
!bt
\begin{equation*}
	\alpha_{i\pm\frac{1}{2}} =\frac{1}{2}(\alpha_i+\alpha_{i\pm1}) 
\end{equation*}
!et

Then we can insert $u$ in the matrix(ref{eq:matrix_spatial}).
!bt
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(u_{i+1}+2u_{i}+u_{i-1})\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(u_{i}+u_{i-1})\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(u_{i+1}+u_{i})
\end{align*}                               
!et
This gives us a nonlinear problem. We can here replace $u$ by $u\_$
as explained in the section \emph{Time Derivative}.
!bt
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(u\__{i+1}+2u\__{i}+u\__{i-1})\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(u\__{i}+u\__{i-1})\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(u\__{i+1}+u\__{i})
\end{align*}                               
!et
I will do a couple of different setup for this function. First I will try to plot
a simulation where I only use the previous value $u\_$ in my matrix. Then I will add
an error measure that use several Picard Iteration iterations.

MOVIE: [submovies/ordinary_sub.webm, height=300,width=375]ordinary with different tolerance for Picard Iteration

These results show us the behavior of $u\_$ when it varies from the previous
time step up to the current time step. The simulation without any Picard Iteration
iteration, gives us a wall that spreads in each direction. This wall becomes
smaller the closer $u\_$ goes towards $u$. 

An important aspect to be aware of when working with
diffusion equation, is that the result after a certain time will be close to  equal in all
the simulations. This happens because of the equilibrium principle. An example
of this is the temperature in a room. The diffusion will cause it to go towards a smooth and
balanced temperature in each point of the room. Therefore it is more interesting
to look at the movement towards the equilibrium than the final result.

=== Spatial derivation wrapped with an absolute value ===
!bt
\begin{equation}
\alpha(u) = |\nabla(u)|
\end{equation}
!et
Since we now have used CN one time on this, we can do it again. This will give
us integer numbers to use in $u$.
!bt
\begin{align*}
\alpha(u_{i+\frac{1}{2}}) =& \left|\nabla(u_{i+\frac{1}{2}})\right|\\
\alpha(u_{i+\frac{1}{2}}) =& \left|\frac{u_{i+1}-u_i}{\Delta x}\right|
\end{align*}
!et
We can do the same thing for $\alpha_{i-\frac{1}{2}}$ and insert them both in
the matrix.
!bt
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_i-u_{i-1}}{\Delta x}\right|+ \left|\frac{u_{i+1}-u_i}{\Delta x}\right|)\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_i-u_{i-1}}{\Delta x}\right|)\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_{i+1}-u_i}{\Delta x}\right|)
\end{align*}                               
!et
To use this with Picard Iteration, we need to replace $u\_=u$. We can also move $\Delta x$
out of the fraction, because $\Delta x > 0$.
!bt
\begin{align} label{eq:matrix_absolute}
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|+ \left|u\__{i+1}-u\__i\right|)\notag\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|)\notag\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__{i+1}-u\__i\right|)
\end{align}                               
!et

MOVIE: [movies/spatial_abs_std.webm, height=300,width=375]abs_std

MOVIE: [movies/spatial_abs_std_picard_tol__5.webm,height=300,width=375]abs_std_picard tol = 10^-5

This also starts with a wall in each directions and then develops into smaller steps that nearly disappears when t gets larger.
While the Picard Iteration solution gives a smoother curve. 
=== Absolute value powered by m ===
!bt
\begin{equation}
	\alpha(u) = |\nabla(u)|^m
\end{equation}
!et
This equation is solved in the exact same as the equation above. We can then use
the matrix (ref{eq:matrix_absolute}) and insert the power.
!bt
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|^m+ \left|u\__{i+1}-u\__i\right|^m)\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__i-u\__{i-1}\right|^m)\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^3}(\left|u\__{i+1}-u\__i\right|^m)
\end{align*}
!et

MOVIE: [paramovies/abs_std_power.webm, height=300,width=375]Powered by m

Here the length of the simulation, $T$ is sat to be quite large. This is to show the effect of the power in
this function. We can see that it quite fast moves towards zero when the power is low. But it seems that the equilibrium state for all these are at zero. The power only affect the speed.

!split
======= Solution for the biological equation =======
Now we can try to combine the reaction term with the spatial part. The reaction-diffusion equation(ref{eq:reaction_diffusion}) can be inserted in a matrix. This is done by using the two linear equation from the earlier sections.
Since we only use FK equation for $f(u)$, I will insert this in the matrix.
!bt
\begin{align} label{eq:matrix_reaction_diffusion}
A_{i,i} =& 1+\Delta t(r(1-\frac{u^n_i}{m})+\frac{\alpha(u_{i+\frac{1}{2}})+\alpha(u_{i-\frac{1}{2}})}{\Delta x^2})\notag\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}}))
\end{align}                               
!et
=== Constant ===
Here we will see how the reaction term and the spatial diffusion term affects each other. We
know from the section above that the reaction term will go towards equlibrium state which is sat by M.
The diffusion term will at the same time try to drag the function towards its equlibrium state. The reaction term is defined as
a Fisher Kolmogoroff equation, while the diffusion part has different values of $k$.

##MOVIE: [paramovies/reac_constant.webm, height=300,width=375]r=1,M=1

MOVIE: [paramovies/reac_constant_2.webm, height=300,width=375]r=1,M=1

The setup for this simulation is a standard Fisher for the reaction term. While the constant $\alpha$ varies 
from 0.01 up to 10. This equation really show how their strengths afffects each other. When $\alpha=0.01$ it is not able to drag the diffusion towards zero. The reaction term is able to push it up. But when $\alpha=10$, it diffuse fast to zero. An interesting observation is when $\alpha=1$. The simulations under shows how the capacity and reproduction rate changes.

MOVIE: [paramovies/reac_constant_M.webm, height=300,width=375]r=1,$\alpha$=1

Here they goes towards their capacity, but $\alpha$ drag them down at the boundary.

MOVIE: [paramovies/reac_constant_r.webm, height=300,width=375]M=1,$\alpha$=1

When $r$ is to weak, it is not able to get it up to the capacity state, which are 1. But as $r$ gets stronger, more 
of the equation fills the capacity

=== Ordinary ===
I have here done the same as for the constant simulation above. We can see that these simulations act quite similar to the
constant solution above. But If we look at $r=0.1$, the reaction term gets a larger influence.

MOVIE: [paramovies/reac_ordinary_r.webm, height=300,width=375]

MOVIE: [paramovies/reac_ordinary_M.webm, height=300,width=375]

=== Absolute value ===
The carrying capacity acts quite as expected, but the reaction term i more interesting to look at.

MOVIE: [paramovies/reac_abs_std_M.webm, height=300,width=375]

MOVIE: [paramovies/reac_abs_std_r.webm, height=300,width=375]

This simulation I run for a longer time. Usually the time step is sat to be 40, but here I have increased it to 80. 
The interesting observation here is $r=0.1$. This has usually been quite stable at a low level. But since the diffusion for $\alpha$
after a certain time step is quite weak, the reproduction rate is able to push it up.
is 
=== Absolute powered up ===

MOVIE: [paramovies/reac_abs_std_power.webm, height=300,width=375]

Here I have changed the power in the equation. I'm using a standard Fisher in the reaction term. We can see that the
diffusion equation gets weaker as the power increases. This gives the reaction term a chance to increase up to the capacity.
!split
======= Further work =======
===== Changes in the Boundary conditions =====
=== Dirichlet boundary condition ===
There are several ways to describe the boundary conditions for a differential equation.
In this paper I have used Dirichlet, where I decide that the boundaries shall be zero.
!bt
\begin{equation}
u = 0|_{\partial \Omega}
\end{equation}
!et
This can be described with attach a rope to each side and then pull in the rope. It will always
be zero at the edges.
=== Neumann boundary condition ===
Another way to look at the boundary is by reflecting boundaries. It can reflect it by $u=0$ which change the sign at the boundary. The way that we often use this, is by Neumann boundary condition. This we can describe
!bt
\begin{equation}
 \frac{\partial u}{\partial n} \equiv \normalvec\cdot\nabla u = 0
\end{equation}
!et
Where $\normalvec$ describes the normal vector.The boundaries can be described  
!bt
\left.\frac{\partial}{\partial n}\right\vert_{x=0,L} =
\frac{\partial}{\partial x}
!et
If we then discretize this at the boundaries, we get
!bt
\begin{align*}
\frac{u_{-1}^n - u_1^n}{2\Delta x} =& 0
u_{-1}^n =& u_1^n
\end{align*}
!et
We can do the same thing for $L$.
Under I have made a simulation where I compare Dirichlet with Neumann. I run them
both on the spatial part to see how it affects the diffusion.

MOVIE: [paramovies/reac_boundary.webm, height=300,width=375]

The interesting this here is to see that the Neumann preserves the area under the function, while Dirichlet smoothes it towards zero. The reason that Dirichlet goes towards zero is because of the value of the boundary. If we continue with the idea of a temperature in a room, the walls will have a large influence on the temperature. Neumann can be explained as wall covered with polystyrene(isopor),where the wall is totally isolated. With Dirichlet the walls has a specific temperature. In our example we sat it to zero, but any number would have caused an equilibrium state.  
===== Newton's method =====
Newtons method is another way to handle nonlinear equations. 
!bt
\begin{equation}
	F(u) = 0
\end{equation}
!et
This method linearizes the equation by using Taylor series expansion around
$u\_$. This only keeping only the linear part.
!bt
\begin{align*}
	F(u) &= F(u_{-}) + F'(u_{-})(u - u_{-}) + \frac{1}{2}F''(u_{-})(u-u_{-})^2
	+\cdots  \\
	& \approx F(u_{-}) + F'(u_{-})(u - u_{-}) = \hat F(u)
\end{align*}
!et
The linear equation will be
!bt
\begin{equation}
	u = u_{-} - \frac{F(u_{-})}{F'(u_{-})}
\end{equation}
!et
This method require a Jacobian matrix. This means that we need to differentiate $F(u) = A(u)u - b(u)$ for all the 
values of $u$. Our $F$ will be
!bt
\begin{equation*}
F_i = A_{i,i-1}(u_{i-1},u_i)u_{i-1}+A_{i,i}(u_{i-1},u_{i},u_{i+1})u_{i}+A_{i,i+1}(u_i,u_{i+1})u_{i+1}-b_i(u^{n-1}_i)
\end{equation*}
!et


!bt
\begin{align*}
J_{i,i}=& \frac{\partial F_i}{\partial u_i}=\frac{\partial A_{i,i-1}}{\partial u_i}u_{i-1}
+ \frac{\partial A_{i,i}}{\partial u_i}u_i+ A_{i,i}
+ \frac{\partial A_{i,i+1}}{\partial u_i}u_{i+1}
- \frac{\partial b_i}{\partial u_{i}}\\ 
J_{i,i-1}=& \frac{\partial F_i}{\partial u_{i-1}}=\frac{\partial A_{i,i-1}}{\partial u_{i-1}}u_{i-1}
+ A_{i,i-1}+\frac{\partial A_{i,i}}{\partial u_{i-1}}u_i
- \frac{\partial b_i}{\partial u_{i-1}}\\ 
J_{i,i+1}=& \frac{\partial F_i}{\partial u_{i+1}}= \frac{\partial A_{i,i}}{\partial u_{i+1}}u_i
+ \frac{\partial A_{i,i+1}}{\partial u_{i+1}}u_{i+1}+A_{i,i+1}
- \frac{\partial b_i}{\partial u_{i+1}}\\ 
\end{align*}
!et
Since this demands a lot of calculating, I will show how to do it for the first
$J_{i,i}$. I calculate each subsection in one line
!bt
\begin{align*}
\frac{\partial A_{i,i-1}}{\partial u_i}u_{i-1}=&-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_i)u_{i-1})\\
\frac{\partial A_{i,i}}{\partial u_i}u_i=&\frac{\Delta t}{2\Delta x^2}(2\alpha'(u_i)u_{i})\\
A_{i,i}=&1+\frac{\Delta t}{2\Delta x^2}(\alpha(u_{i+1})+2\alpha(u_i)+\alpha(u_{i-1}))\\
\frac{\partial A_{i,i+1}}{\partial u_i}u_{i+1}=&-\frac{\Delta t}{\Delta x^2}(\alpha'(u_i)u_{i+1})\\
- \frac{\partial b_i}{\partial u_{i}}=& -b'(u_i)\\
\end{align*}
!et
This gives us the matrix
!bt
\begin{align*}
J_{i,i} =&-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_i)u_{i-1})+\frac{\Delta t}{2\Delta x^2}(2\alpha'(u_i)u_{i})\\
+&1+\frac{\Delta t}{2\Delta x^2}(\alpha(u_{i+1})+2\alpha(u_i)+\alpha(u_{i-1}))-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_i)u_{i+1})-b'(u_i)\\
J_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i-1})u_{i-1})-\frac{\Delta t}{2\Delta x^2}(\alpha(u_{i-1})+\alpha(u_i))+\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i-1})u_{i})\\
J_{i,i+1} =&\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i+1})u_{i})-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i+1})u_{i+1})-\frac{\Delta t}{2\Delta x^2}(\alpha(u_i)+\alpha(u_{i+1}))
\end{align*}
!et
This matrix can be used to compute the Newton's method. We just need to replace $\alpha(u)$ by the function. 
