<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Project inf5631">



<style type="text/css">
    /* blueish style */

    /* Color definitions:  http://www.december.com/html/spec/color0.html
       CSS examples:       http://www.w3schools.com/css/css_examples.asp */

    body {
      margin-top: 1.0em;
      background-color: #ffffff;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    h1 { font-size: 1.8em; color: #1e36ce; }
    h2 { font-size: 1.6em; color: #1e36ce; }
    h3 { font-size: 1.4em; color: #1e36ce; }
    a { color: #1e36ce; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Density-Dependent Diffusion- Reaction Diffusion Model ',
               1,
               None,
               '___sec0'),
              (' Fisher-Kolmogoroff equation ', 2, None, '___sec1'),
              (' Travelling wavefront ', 2, None, '___sec2'),
              (' Reaction term ', 1, None, '___sec3'),
              (' Fisher-Kolmogoroff term ', 2, None, '___sec4'),
              (" Fisher's equation ", 3, None, '___sec5'),
              (' Carrying capacity ', 3, None, '___sec6'),
              (' Reproduction rate ', 3, None, '___sec7'),
              (' Spatial diffusion ', 1, None, '___sec8'),
              (' Boundary conditions ', 3, None, '___sec9'),
              (' Linear system/equation ', 2, None, '___sec10'),
              (' Nonlinear equation ', 2, None, '___sec11'),
              (' Picard Iteration ', 3, None, '___sec12'),
              (' $\\alpha(u)$ as a linear function ', 3, None, '___sec13'),
              (' Spatial derivative wrapped with an absolute value ',
               3,
               None,
               '___sec14'),
              (' Spatial derivative wrapped with an absolute value powered by m ',
               3,
               None,
               '___sec15'),
              (' Solution for the biological equation ', 1, None, '___sec16'),
              (' Fisher-Komogoroff equation ', 3, None, '___sec17'),
              (' $\\alpha(u)= u$ ', 3, None, '___sec18'),
              (' $\\alpha(u)=|\\nabla u|$ ', 3, None, '___sec19'),
              (' $\\alpha(u)=|\\nabla u|^m$ ', 3, None, '___sec20'),
              (' Further work ', 1, None, '___sec21'),
              (' Changes in the Boundary conditions ', 2, None, '___sec22'),
              (' Dirichlet boundary condition ', 3, None, '___sec23'),
              (' Neumann boundary condition ', 3, None, '___sec24'),
              (" Newton's method ", 2, None, '___sec25')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




    
<!-- ------------------- main content ---------------------- -->


<title>Project inf5631 </title>

<center><h1>Project inf5631 </h1></center>  <!-- document title -->

<p>
<!-- author(s): Torbj&#248;rn Seland -->

<center>
<b>Torbj&#248;rn Seland</b> 
</center>


<p>
<!-- institution(s) -->
<p>
<center><h4>Jun 13, 2014</h4></center> <!-- date -->

<h2>Table of contents</h2>

<a href="#___sec0"> Density-Dependent Diffusion- Reaction Diffusion Model </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec1"> Fisher-Kolmogoroff equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Travelling wavefront </a><br>
<a href="#___sec3"> Reaction term </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec4"> Fisher-Kolmogoroff term </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec5"> Fisher's equation </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec6"> Carrying capacity </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec7"> Reproduction rate </a><br>
<a href="#___sec8"> Spatial diffusion </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec9"> Boundary conditions </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec10"> Linear system/equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec11"> Nonlinear equation </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec12"> Picard Iteration </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec13"> \( \alpha(u) \) as a linear function </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec14"> Spatial derivative wrapped with an absolute value </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec15"> Spatial derivative wrapped with an absolute value powered by m </a><br>
<a href="#___sec16"> Solution for the biological equation </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec17"> Fisher-Komogoroff equation </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec18"> \( \alpha(u)= u \) </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec19"> \( \alpha(u)=|\nabla u| \) </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec20"> \( \alpha(u)=|\nabla u|^m \) </a><br>
<a href="#___sec21"> Further work </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec22"> Changes in the Boundary conditions </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec23"> Dirichlet boundary condition </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec24"> Neumann boundary condition </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec25"> Newton's method </a><br>
</p>

<h1>Density-Dependent Diffusion- Reaction Diffusion Model  <a name="___sec0"></a></h1>
The efficiency of computers has increased vastly over the last few decades, giving scientists and engineers new tools to describe the dynamics of the world around us. It has also affected the way biological processes are viewed and described. This project will focus on numerical methods to solve the reaction diffusion equation which is described below. Reaction-diffusion systems explain how the concentration of one or more substances changes under the influence of the local chemical reactions, here \( f(u) \) and diffusion which cause a spatial dispersion. These systems are applied in fields as chemistry, biology, geology, physics and ecology. 
$$
\begin{align} \label{eq:reaction_diffusion}
u_t =& \nabla \cdot \alpha(u)\nabla u + f(u)\\
u(x,0) =& I(x)\notag \\
u(0,t)=& 0\notag \\
u(L,t)=& 0\notag
\end{align}
$$

This model is a \( \textit{Density-Dependent Diffusion-Reaction Diffusion Model} \), because of the \( \alpha(u) \) function in the diffusion part. When \( \alpha(u) \) is sat to be a constant, the model will be a ordinary \( \textit{Reaction Diffusion model} \) [MB,I,449]. Here, \( u \) denotes the concentration of the substance in one spatial dimension. This project will include a general introduction to the Fisher-Kolmogoroff equation, which is a reaction diffusion equation. To verify the numerical solution, this will be compared to an analytical solution by using travelling wavefront. The last part will be a study on the affect of the reaction and diffusion term.

<h2>Fisher-Kolmogoroff equation  <a name="___sec1"></a></h2>
The main focus in this project will be at the Fisher-Kolmogoroff equation, now referred as FK . This was proposed as a one-dimensional model by Fisher(1937) to describe the spread of an advantageous gene in a population. Kolmogoroff et al.(1937) did a study of this equation and obtained some of the basic analytical results [1(Mathematical Biology, I an introduction, 11.Reaction Diffusion)].The FK can be produced by replacing \( \alpha(u)=k \), where \( k \) is a constant, and \( f(u) = ru(1-\frac{u}{m}) \) in the general equation \eqref{eq:reaction_diffusion}.
$$
\begin{equation} \label{eq:fish_kol}
\frac{\partial u}{\partial t} = k\frac{\partial^2u}{\partial x^2}+ru(1-\frac{u}{m})
\end{equation}
$$

<h2>Travelling wavefront  <a name="___sec2"></a></h2>
There is a vast number of examples from the biology where an important reason to a developmental process seems to be the appearance of a travelling wave of chemical concentration[MB,I,437]. An example from the humans interaction, is the progressing wave of an epidemic. Here the spread of rabies epizootic through Europe is an example. 

<p>
A travelling wave is a wave that travels without any change in the shape and the speed can be given by a constant. This means that by following the wave with the same speed as the wave speed, it would be no changes in the wave. A mathematical expression for this is
$$
\begin{equation} \label{eq:wave_constant}
u(x,t) = u(x-ct) = u(z), z = x-ct
\end{equation}
$$

So if \( x-ct \) is a constant, then \( u \) will be a constant. If we look for a travelling wave solution of the \eqref{eq:wave_constant}, the partial differential equations can be written as ordinary differential equations. \( \frac{\partial u}\{\partial t} = -c\frac{du}{dz} \) and \( \frac{\partial u}\{\partial x} = \frac{du}{dz} \). A couple of physical assumptions that has to be done, are that \( u(z) \) has to be bounded by \( z \) and that the concentration of the quantities cannot be negative, for example the human population. Inserting the ordinary differential equations into a standard diffusion equation under
$$
\begin{equation}
\frac{\partial u}{\partial t} = k\frac{\partial^2u}{\partial x^2}
\end{equation}
$$

Will give

$$
\begin{equation}
k\frac{d^2u}{dx^2} + \frac{du}{dt} = 0,\hspace{8mm} \Rightarrow \hspace{8mm} u(z) = A + Be^{-cz/D} 
\end{equation}
$$


<p>
---------------------- Disse delene m&#229; settes bedre sammen--------- <br />
<br />
A good reason to study this equation, is because it is the prototype equation which admits travelling wavefront solutions. This is also a good equation for develop many of the standard techniques to analyse a single-species model with diffusion dispersal.[2,(Mathematical Biology, I an introduction, 13.Biological waves, 440)] When investigating the travelling wavefront, it is convenient to rescale the equation by writing
$$
t* = rt,	x* = x(\frac{r}{k})^{1/2}
$$

The carrying capacity, \( m \), will be sat to one. This gives a travelling wavefront between 0 and 1.
$$
\begin{equation} \label{eq:trav_wave}
\frac{\partial u}{\partial t} = \frac{\partial^2u}{\partial x^2}+u(1-u)
\end{equation}
$$

Since \( m=1 \), the steady states are \( u=0 \) and \( u=1 \), which are respectively unstable and stable. If the solution represents a travelling wave, the shape of the wave will move with the speed \( c \). The travelling wave can then be whown stationary.
$$
u(x,t) = u(x-ct) = U(z), x-ct = z
$$

\( U(z) \) will be used instead of \( u(u) \). This is to avoid any confusion of the terminology. The assumption \( c \geq 0 \) is done. Substituting this traveling wavefront into \eqref{eq:trav_wave}, gives
$$
U'' +cU' + U(1-U) = 0
$$

<h1>Reaction term  <a name="___sec3"></a></h1>
The reaction term describes the change in concentration in a certain point. This variation is only affected
by the local chemical reaction.(Blir litt likt beskrivelsen i "The model")
$$
\begin{equation}
u_t = f(u)
\end{equation}
$$

To see the properties of this equation, it can be discretized and solved numerically for
different values of \( f(u) \).

$$
\begin{align*}
u_t =& f(u)\\
\frac{u^n_i-u^{n-1}_i}{\Delta t}=& f(u^n_i)\\
u^n_i-\Delta t f(u^n_i) =& u^{n-1}_i
\end{align*}
$$

This gives a linear equation \( Au = b \) that easy can be solved.

<h2>Fisher-Kolmogoroff term  <a name="___sec4"></a></h2>
A Fisher-Kolmogoroff term, now referred to as FK, is a nonlinear term which often arises from biological applications. It takes the form \( f(u) = ru(1-u/m) \), where \( r \) describes the linear reproduction and \( m \) the carrying capacity of this environment. The solution will then be.
$$
\begin{equation}
f(u) = ru(1-\frac{u}{m})
\end{equation}
$$


$$
\begin{align*}
u^n_i-\Delta t *ru^n_i(1-\frac{u^n_i}{m}) =& u^{n-1}_i\\
u^n_i(1-\Delta t r(1-\frac{u^n_i}{m})) =& u^{n-1}_i
\end{align*}
$$


<p>
Since this equation gives a nonlinear equation, Picard Iteration can be used to solve the equation. The idea with Picard Iteration is to replace one of the \( u \) in the nonlinear part with \( u\_ \). \( u\_ \) will in the first iteration be sat to the value from the previous time step \( u\_1 \). 

$$
\begin{equation*}
	u\_ = u^{n-1}
\end{equation*}
$$


<p>
The correct value \( u \) can be compared with the pre produced \( u\_ \) each round. If the difference between
them are less than a predefined limit, the new solution is accepted. If not, the new \( u\_ \) will be a combination of \( u\_ \) and \( u \). How the combination is weighted is called relaxation. 

$$
\begin{equation*}
u\_ = \gamma u + (1-\gamma)u\_, 0<= \gamma <=1
\end{equation*}
$$


<p>
The new equation will be

$$
\begin{align*}
	u^n_i(1- \Delta t r(1-\frac{u\__i^n}{m}))=& u^{n-1}_i\\
\end{align*}
$$


<p>
Since \( u\_ \) is an approximation to \( u \), \( u\_ \) need to be refined until it fulfil the expectations.

<h3>Fisher's equation  <a name="___sec5"></a></h3>

The values from FK is sat to \( r=1 \) and \( m=1 \). This is called Fisher's equation.The reaction term in Fisher will look like this.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/constant_fisher_few_points.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>Fisher with ten points</em></p>


<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='movies/time_der_r_1_0_m_1_0.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>r= 1, m= 1</em></p>

<h3>Carrying capacity  <a name="___sec6"></a></h3>

First it can be interesting to look at the changes in the carrying capacity, here denoted as \( m \), of
the function. This simulation has the purpose to illustrate the efficiency of varying the carrying capacity.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/time.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>time</em></p>


<p>
All the simulations goes towards their carrying capacity and stabilizes here.The reproduction rate,$r$, has been set equal to one for all the simulations in order to isolate the effect of varying the carrying capacity. The time from initial conditions to final conditions is quite similar in all of the cases.

<h3>Reproduction rate  <a name="___sec7"></a></h3>

A similar simulation can be done for the reproduction rate,$r$. Here with focus on the effect of varying the reproduction.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/time_r.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>time_r</em></p>


<p>
This controls the speed of the movement. A larger reproduction will get in faster
to the steady state, that is controlled by \( m \). The carrying capacity is sat to \( m=0.8 \).

<p>
<!-- !split -->

<h1>Spatial diffusion  <a name="___sec8"></a></h1>
The first part of the RD equation describes the spatial flow and how the values in \( u \) are affected by their neighbours.  
$$
\begin{equation}
	u_t = \nabla \cdot \alpha(u)\nabla u
\end{equation}
$$

The function \( \alpha(u) \) has a major influence on the spatial term and affects the diffusion of the model. To solve this equation numerically, the equation needs to be discretized.
$$
\begin{equation*}
	\left[D_t^-u=D_x(\alpha(u) D_x u)\right]
\end{equation*}
$$

Backward Euler is used for the time discrete and Crank Nicolson for the spatial
discrete. 
$$
\begin{align*}
	\frac{u^n_i-u^{n-1}_i}{\Delta t}=& \frac{1}{\Delta x^2}\left(\alpha_{i+\frac{1}{2}}(u_{i+1}-u_i)-\alpha_{i-\frac{1}{2}}(u_{i}-u_{i-1})\right)\\
	u^{n-1}_i=&u^n_i- \frac{\Delta t}{\Delta x^2}\left(\alpha_{i+\frac{1}{2}}(u_{i+1}-u_i)-\alpha_{i-\frac{1}{2}}(u_{i}-u_{i-1})\right)
\end{align*}
$$

This is assembled to a linear system.
$$
\begin{equation}
A =
\left(
\begin{array}{cccccccccc}
A_{0,0} & A_{0,1} & 0
&\cdots &
\cdots & \cdots & \cdots &
\cdots & 0 \\
A_{1,0} & A_{1,1} & A_{1,2} & \ddots &   & &  & &  \vdots \\
0 & A_{2,1} & A_{2,2} & A_{2,3} &
\ddots & &  &  & \vdots \\
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\
\vdots & &  & 0 & A_{i,i-1} & A_{i,i} & A_{i,i+1} & \ddots & \vdots \\
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\
\vdots & & & &  &\ddots  & \ddots &\ddots  & A_{N_x-1,N_x} \\
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & A_{N_x,N_x-1} & A_{N_x,N_x}
\end{array}
\right)
\tag{14}
\end{equation}
$$

The matrix \( A \) will be tridiagonal with the values.
$$
\begin{align} \label{eq:matrix_spatial}
A_{i,i} =& 1+\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}})+\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}}))
\end{align}                               
$$

In the cases where the function \( \alpha(u) \) contains \( u \), it will provide a non-linear term.

<h3>Boundary conditions  <a name="___sec9"></a></h3>

The boundary conditions are specified to be zero. Implementing these boundary conditions requires changing the following terms in the matrix, A.
$$
\begin{align*}
A_{0,0} &= 1,\\
A_{0,1} &= 0,\\
A_{N_x,N_x-1} &= 0,\\
A_{N_x,N_x} &= 1
\end{align*}
$$

The b array with known values will be
$$
\begin{align*}
b_0 &= 0,\\
b_i &= u^{n-1}_i,\quad i=1,\ldots,N_x-1,\\
b_{N_x} &= 0 
\end{align*}
$$

This decision affects the equilibrium state.

<h2>Linear system/equation  <a name="___sec10"></a></h2>
The only solution for a linear equation is to replace \( \alpha \) by a constant.
$$
\begin{equation}
	\alpha(u) = k
\end{equation}
$$

The matrix from\eqref{eq:matrix_spatial} and insert the function for \( \alpha(u) \). This gives us
the matrix:
$$
\begin{align*} \label{eq:matrix_constant}
A_{i,i} =& 1+\frac{\Delta t}{\Delta x^2}(2k)=1+\frac{2k\Delta t}{\Delta x^2}\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(k)=-\frac{k \Delta t}{\Delta x^2}\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(k)=-\frac{k \Delta t}{\Delta x^2}\\
\end{align*}                               
$$

The movies under represents different values for \( k \)

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/constant.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>constant</em></p>


<p>
The size of \( \alpha \) controls the speed of the diffusion. A large \( \alpha \) will get the function faster towards equilibrium.

<h2>Nonlinear equation  <a name="___sec11"></a></h2>
All \( \alpha \)'s that include \( u \) will give a non-linear equation.Picard Iteration can be used to solve this non-linear equation. This method is explained thorough in \( \textit{Reaction term} \).

<h3>Picard Iteration  <a name="___sec12"></a></h3>

<h3>\( \alpha(u) \) as a linear function  <a name="___sec13"></a></h3>

$$
\begin{equation}
	\alpha(u) = u\\
\end{equation}
$$


<p>
Since Crank Nicolson is only applied for one step in the general calculation for \( \alpha \), arithmetic mean
can be used to get values from \( u \).
$$
\begin{equation*}
	\alpha_{i\pm\frac{1}{2}} =\frac{1}{2}(\alpha_i+\alpha_{i\pm1}) 
\end{equation*}
$$


<p>
Then \( u \) can be inserted in the matrix\eqref{eq:matrix_spatial}.
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(u_{i+1}+2u_{i}+u_{i-1})\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(u_{i}+u_{i-1})\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(u_{i+1}+u_{i})
\end{align*}                               
$$

This gives a nonlinear problem. \( u \) can here be replaced by \( u\_ \).
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(u\__{i+1}+2u\__{i}+u\__{i-1})\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(u\__{i}+u\__{i-1})\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(u\__{i+1}+u\__{i})
\end{align*}                               
$$

The function will be produced with different error tolerance. First a simulation where only the previous value \( u\_ \) is used in matrix A. This is equivalent to a very large error tolerance. Then the error tolerance will be reduced in order to carry out a proper Picard Iteration.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='submovies/ordinary_sub.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>ordinary with different tolerance for Picard Iteration</em></p>


<p>
These results show us the behavior of \( u\_ \) when it varies from a large error tolerance,the previous time step, up to a error tolerance of \( 10^{-7} \). The simulation without any Picard Iteration gives a discontinuity in each direction. This becomes smaller the closer \( u\_ \) goes towards \( u \). 

<p>
An important aspect to be aware of when working with diffusion equation, is that the result after a certain time will be close to equal in all the simulations. This happens because of the equilibrium principle. An example of this is the temperature in a room. The diffusion will cause it to go towards a smooth and balanced temperature in each point of the room. Therefore it is more interesting to look at the movement towards the equilibrium than the final result.

<h3>Spatial derivative wrapped with an absolute value  <a name="___sec14"></a></h3>

$$
\begin{equation}
\alpha(u) = |\nabla(u)|
\end{equation}
$$

Since CN in used one time on this, it can be used again. This will give integer numbers in spatial direction for \( u \).
$$
\begin{align*}
\alpha(u_{i+\frac{1}{2}}) =& \left|\nabla(u_{i+\frac{1}{2}})\right|\\
\alpha(u_{i+\frac{1}{2}}) =& \left|\frac{u_{i+1}-u_i}{\Delta x}\right|
\end{align*}
$$

The same can be done for \( \alpha_{i-\frac{1}{2}} \). Both solutions can be inserted in
the matrix A.
$$
\begin{align*} 
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_i-u_{i-1}}{\Delta x}\right|+ \left|\frac{u_{i+1}-u_i}{\Delta x}\right|)\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_i-u_{i-1}}{\Delta x}\right|)\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u_{i+1}-u_i}{\Delta x}\right|)
\end{align*}                               
$$

To use this with Picard Iteration, \( u\ \) need to replace \( u \). \( \Delta x \) can be moved out of the fraction, because \( \Delta x > 0 \).
$$
\begin{align} \label{eq:matrix_absolute}
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(\left|\frac{u\__i-u\__{i-1}}{\Delta x}\right|+ \left|\frac{u\__{i+1}-u\__i}{\Delta x}\right|)\notag\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u\__i-u\__{i-1}}{\Delta x}\right|)\notag\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u\__{i+1}-u\__i}{\Delta x}\right|)
\end{align}                               
$$

The first simulation consist of a large error tolerance while the second one has a tolerance of \( 10^{-5} \).

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='movies/spatial_abs_std.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>abs_std</em></p>


<p>

<div>
<video  loop controls width='375' height='300' preload='none'>
    <source src='movies/spatial_abs_std_picard_tol__5.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>abs_std_picard tol = 10^-5</em></p>


<p>
The first simulation starts with a discontinuity in each directions and smoothes out as the time gets larger.While the last plot with a small tolerance gives a smoother curve.

<h3>Spatial derivative wrapped with an absolute value powered by m  <a name="___sec15"></a></h3>

$$
\begin{equation}
	\alpha(u) = |\nabla(u)|^m
\end{equation}
$$

This equation is solved in the exact same manner as the equation above. The matrix\eqref{eq:matrix_absolute} A from the section above can be used. A power, \( m \), can be added in the matrix.
$$
\begin{align} \label{eq:matrix_absolute}
A_{i,i} =& 1+\frac{\Delta t}{2\Delta x^2}(\left|\frac{u\__i-u\__{i-1}}{\Delta x}\right|^m+ \left|\frac{u\__{i+1}-u\__i}{\Delta x}\right|^m)\notag\\
A_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u\__i-u\__{i-1}}{\Delta x}\right|^m)\notag\\
A_{i,i+1} =&-\frac{\Delta t}{2\Delta x^2}(\left|\frac{u\__{i+1}-u\__i}{\Delta x}\right|^m)
\end{align}                               
$$


<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/abs_std_power.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>Powered by m</em></p>


<p>
Here the length of the simulation, \( T \), is sat to be quite large. This is to show the effect of the power term in this function. The function moves quite fast towards zero when the power term is low. But it seems that the equilibrium state for all these are at zero. The power term only affects the speed.

<p>
<!-- !split -->

<h1>Solution for the biological equation  <a name="___sec16"></a></h1>
The combination of the reaction part and the spatial part gives the reaction-diffusion equation\eqref{eq:reaction_diffusion}. This can be inserted in a matrix. This is done by using the two linear equations from the earlier sections. Since FK is the only equation that has been studied in the reaction term,$f(u)$, this can be inserted in the matrix.
$$
\begin{align} \label{eq:matrix_reaction_diffusion}
A_{i,i} =& 1+\Delta t(r(1-\frac{u^n_i}{m})+\frac{\alpha(u_{i+\frac{1}{2}})+\alpha(u_{i-\frac{1}{2}})}{\Delta x^2})\notag\\
A_{i,i-1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i-\frac{1}{2}}))\notag\\
A_{i,i+1} =&-\frac{\Delta t}{\Delta x^2}(\alpha(u_{i+\frac{1}{2}}))
\end{align}                               
$$

<h3>Fisher-Komogoroff equation  <a name="___sec17"></a></h3>

This simulation shows how the reaction term and the spatial diffusion term affects each other.The reaction term will go towards equilibrium state which is sat by the carrying capacity,$M$, as shown in the section above. The diffusion term will at the same time try to drag the function towards its equlibrium state. The reaction term is defined as a Fisher Kolmogoroff term, while the diffusion part consist of different constant values,$k$, in the \( \alpha(u) \). This gives a Fisher Kolmogoroff equation \eqref{eq:fish_kol}

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_constant_2.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>r=1,M=1</em></p>


<p>
The setup for this simulation is a standard Fisher where \( r=1 \) and \( M=1 \), for the reaction term. While the constant \( \alpha \) varies from 0.01 up to 10. This equation shows how the parts affects each other. When \( \alpha=0.01 \), it is not able to drag the diffusion towards zero. The reaction term is able to push it up. But when \( \alpha=10 \), it diffuses fast to zero. An interesting observation is when \( \alpha=1 \). The simulations under shows how the capacity and reproduction rate changes.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_constant_M.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>r=1,$\alpha$=1</em></p>


<p>
Here they tend towards their capacity, but \( \alpha \) drags them down at the boundary.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_constant_r.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em>M=1,$\alpha$=1</em></p>


<p>
When \( r \) is to weak, the reproduction is to low to get it to the capacity state, which is 1. But as \( r \) gets stronger, it is able to push the function towards the carrying capacity, \( M \).

<h3>\( \alpha(u)= u \)  <a name="___sec18"></a></h3>

The simulations are produced in the same way as for the FK in the section above. And the results are quite similar. One difference between them is \( r=0.1 \). After decreasing for a certain time, the function starts to increase towards the carrying capacity.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_ordinary_M.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em></em></p>


<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_ordinary_r.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em></em></p>

<h3>\( \alpha(u)=|\nabla u| \)  <a name="___sec19"></a></h3>

The carrying capacity acts quite as expected, but the reaction term is more interesting to look at.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_abs_std_M.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em></em></p>


<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_abs_std_r.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em></em></p>


<p>
The simulation for changes in the reproduction is run for twice as long time as the other simulations. The interesting observation here is \( r=0.1 \). This has usually been quite stable at a low level. But since the diffusion for \( \alpha \) after a certain time step is quite weak, the reproduction rate is able to push it up.

<h3>\( \alpha(u)=|\nabla u|^m \)  <a name="___sec20"></a></h3>


<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_abs_std_power.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em></em></p>


<p>
The power term, \( m \), in the spatial diffusion term changes here. The reaction term consist of a standard Fisher. The strength of the diffusion term decreases as the power increases. This gives the reaction term a chance to increase up to the carrying capacity.
<!-- !split -->

<h1>Further work  <a name="___sec21"></a></h1>

<h2>Changes in the Boundary conditions  <a name="___sec22"></a></h2>

<h3>Dirichlet boundary condition  <a name="___sec23"></a></h3>

There are several ways to describe the boundary conditions for a differential equation.
Dirichlet has been used in this paper. The boundaries has been sat to zero.
$$
\begin{equation}
u = 0|_{\partial \Omega}
\end{equation}
$$


<p>
An analogous description of Dirichelt boundary conditions can be found in the wave equation. Attaching a rope to a wall, and inducing oscillations allows us to describe the displacement of the rope with the wave equation. The end of the rope attached to the wall will always have zero displacement since it is, in fact, attached.

<h3>Neumann boundary condition  <a name="___sec24"></a></h3>

Another way to look at the boundary conditions is by reflecting boundaries. The boundary can be sat to \( u=0 \),which change the sign at the boundary or \( u_x \), that reflects the same value. This can be implemented with Neumann boundary condition[http://hplgit.github.io/INF5620/doc/pub/._main_wave003.html#wave:pde2:Neumann].
$$
\begin{equation}
 \frac{\partial u}{\partial n} \equiv \emph{n}\cdot\nabla u = 0
\end{equation}
$$

Where \( \emph{n} \) describes the normal vector.The boundaries can be described  
$$
\left.\frac{\partial}{\partial n}\right\vert_{x=0,L} =
\frac{\partial}{\partial x}
$$

If the equation is discretized at the boundaries, it gives
$$
\begin{align*}
\frac{u_{-1}^n - u_1^n}{2\Delta x} =& 0
u_{-1}^n =& u_1^n
\end{align*}
$$

The same thing can be done for \( L \).
The simulation under compares Dirichlet with Neumann. The reaction term is sat to be zero to see how the boundary affects the diffusion term.

<p>

<div>
<video  loop controls width='375' height='365' preload='none'>
    <source src='paramovies/reac_boundary.webm' type='video/webm; codecs="vp8, vorbis"'>
</video>
</div>
<p><em></em></p>


<p>
Neumann preserves the area under the function, while Dirichlet smoothes it towards zero. Dirichlet goes towards zero because the boundary values are sat to be zero. Assume that the concentration of \( u \) is the temperature in a room. The walls will have a large influence on the temperature. Neumann can be explained as wall covered with styrofoam, where the walls are totally isolated. With Dirichlet, the walls has a specific temperature. Here the temperature is sat to be zero, but any number would have caused an equilibrium state.

<h2>Newton's method  <a name="___sec25"></a></h2>
Newtons method is another way to handle non linear equations. 
$$
\begin{equation}
	F(u) = 0
\end{equation}
$$

This method linearizes the equation by using Taylor series expansion around
\( u\_ \). Thus only keeping the linear part.
$$
\begin{align*}
	F(u) &= F(u_{-}) + F'(u_{-})(u - u_{-}) + \frac{1}{2}F''(u_{-})(u-u_{-})^2
	+\cdots  \\
	& \approx F(u_{-}) + F'(u_{-})(u - u_{-}) = \hat F(u)
\end{align*}
$$

The linear equation will be
$$
\begin{equation}
	u = u_{-} - \frac{F(u_{-})}{F'(u_{-})}
\end{equation}
$$

A Jacobian matrix is required for this method. \( F(u) = A(u)u - b(u) \) needs to be differentiate for all values of \( u \). \( F \) will be
$$
\begin{equation*}
F_i = A_{i,i-1}(u_{i-1},u_i)u_{i-1}+A_{i,i}(u_{i-1},u_{i},u_{i+1})u_{i}+A_{i,i+1}(u_i,u_{i+1})u_{i+1}-b_i(u^{n-1}_i)
\end{equation*}
$$


$$
\begin{align*}
J_{i,i}=& \frac{\partial F_i}{\partial u_i}=\frac{\partial A_{i,i-1}}{\partial u_i}u_{i-1}
+ \frac{\partial A_{i,i}}{\partial u_i}u_i+ A_{i,i}
+ \frac{\partial A_{i,i+1}}{\partial u_i}u_{i+1}
- \frac{\partial b_i}{\partial u_{i}}\\ 
J_{i,i-1}=& \frac{\partial F_i}{\partial u_{i-1}}=\frac{\partial A_{i,i-1}}{\partial u_{i-1}}u_{i-1}
+ A_{i,i-1}+\frac{\partial A_{i,i}}{\partial u_{i-1}}u_i
- \frac{\partial b_i}{\partial u_{i-1}}\\ 
J_{i,i+1}=& \frac{\partial F_i}{\partial u_{i+1}}= \frac{\partial A_{i,i}}{\partial u_{i+1}}u_i
+ \frac{\partial A_{i,i+1}}{\partial u_{i+1}}u_{i+1}+A_{i,i+1}
- \frac{\partial b_i}{\partial u_{i+1}}\\ 
\end{align*}
$$

The method demands a lot of calculating. Every part of \( J_{i,i} \) will be computed under, as an example. The same principles are used for \( J_{i,i-1} \) and \( J_{i,i+1} \).
$$
\begin{align*}
\frac{\partial A_{i,i-1}}{\partial u_i}u_{i-1}=&-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_i)u_{i-1})\\
\frac{\partial A_{i,i}}{\partial u_i}u_i=&\frac{\Delta t}{2\Delta x^2}(2\alpha'(u_i)u_{i})\\
A_{i,i}=&1+\frac{\Delta t}{2\Delta x^2}(\alpha(u_{i+1})+2\alpha(u_i)+\alpha(u_{i-1}))\\
\frac{\partial A_{i,i+1}}{\partial u_i}u_{i+1}=&-\frac{\Delta t}{\Delta x^2}(\alpha'(u_i)u_{i+1})\\
- \frac{\partial b_i}{\partial u_{i}}=& -b'(u_i)\\
\end{align*}
$$

This gives the matrix
$$
\begin{align*}
J_{i,i} =&-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_i)u_{i-1})+\frac{\Delta t}{2\Delta x^2}(2\alpha'(u_i)u_{i})\\
+&1+\frac{\Delta t}{2\Delta x^2}(\alpha(u_{i+1})+2\alpha(u_i)+\alpha(u_{i-1}))-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_i)u_{i+1})-b'(u_i)\\
J_{i,i-1} =&-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i-1})u_{i-1})-\frac{\Delta t}{2\Delta x^2}(\alpha(u_{i-1})+\alpha(u_i))+\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i-1})u_{i})\\
J_{i,i+1} =&\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i+1})u_{i})-\frac{\Delta t}{2\Delta x^2}(\alpha'(u_{i+1})u_{i+1})-\frac{\Delta t}{2\Delta x^2}(\alpha(u_i)+\alpha(u_{i+1}))
\end{align*}
$$

This matrix can be used to compute the Newton's method. 

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

