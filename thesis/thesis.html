<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Mathematical analysis of epidemic systems- comparison of different models">

<title>Mathematical analysis of epidemic systems- comparison of different models</title>


<style type="text/css">
/* blueish style */

/* Color definitions:  http://www.december.com/html/spec/color0.html
   CSS examples:       http://www.w3schools.com/css/css_examples.asp */

body {
  margin-top: 1.0em;
  background-color: #ffffff;
  font-family: Helvetica, Arial, FreeSans, san-serif;
  color: #000000;
}
h1 { font-size: 1.8em; color: #1e36ce; }
h2 { font-size: 1.6em; color: #1e36ce; }
h3 { font-size: 1.4em; color: #1e36ce; }
a { color: #1e36ce; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(' Introduction ', 0, None, '___sec0'),
              (' ODE models ', 0, None, '___sec1'),
              (' Simple Epidemic Models ', 1, None, '___sec2'),
              (' Threshold phenomenon ', 1, None, '___sec3'),
              (' English Boarding School 1978 ', 1, None, '___sec4'),
              (' Maximum concentration of *Infected* ', 2, None, '___sec5'),
              (' Zombification ', 1, None, '___sec6'),
              (' Parameters used in the model ', 2, None, '___sec7'),
              (' The initial phase ', 3, None, '___sec8'),
              (' The hysterical phase ', 3, None, '___sec9'),
              (' The counter attack ',
               3,
               'section:counter_attack',
               'section:counter_attack'),
              (' The three phases in Walking Dead ', 3, None, '___sec11'),
              (' Discussion ', 1, None, '___sec12'),
              (' PDE models ', 0, None, '___sec13'),
              (' Simple system for spatial spread ', 1, None, '___sec14'),
              (' Travelling wave 1D ', 2, None, '___sec15'),
              (' Verifying the solution ', 2, None, '___sec16'),
              (' Constant solution ', 2, None, '___sec17'),
              (' Manufactured solution ', 2, None, '___sec18'),
              (' Convergence rate ', 2, None, '___sec19'),
              (' The spatial error ', 2, None, '___sec20'),
              (' The temporal error ', 2, None, '___sec21'),
              (' Travelling wave in 2D ', 2, None, '___sec22'),
              (' A gaussian wave ', 2, None, '___sec23'),
              (' Change in initial flow ', 3, None, '___sec24'),
              (' Change in lambda ', 3, None, '___sec25'),
              (' English Boarding School ', 1, None, '___sec26'),
              (' Maximum concentration of *Infected* ', 2, None, '___sec27'),
              (' Introducing a Gaussian distribution of infected ',
               2,
               None,
               '___sec28'),
              (' Zombiefication ', 1, None, '___sec29'),
              (' The position of the *Infected* group ', 2, None, '___sec30'),
              (' Free areas for the *Susceptible* group ',
               2,
               None,
               '___sec31'),
              (' Ten minutes at Frederikkeplassen ', 2, None, '___sec32'),
              (' Discussion ', 1, None, '___sec33'),
              (' Random walk ', 0, None, '___sec34'),
              (' Monte Carlo methods ',
               1,
               'sec:monte_carlo_methods',
               'sec:monte_carlo_methods'),
              (' Random variable ', 2, None, '___sec36'),
              (' Probability distribution functions (PDF) ',
               2,
               None,
               '___sec37'),
              (' Moments of a PDF ', 2, None, '___sec38'),
              (' The pertinent variance $\\sigma ^2$ ', 2, None, '___sec39'),
              (' Random walker ', 1, None, '___sec40'),
              (' English Boarding School ', 1, None, '___sec41'),
              (' Lower maximum concentration for the *Infected* group ',
               2,
               None,
               '___sec42'),
              (' The chance for a disease to spread ', 2, None, '___sec43'),
              (' Zombiefication ', 1, None, '___sec44'),
              (' Random walk ', 2, None, '___sec45'),
              (' Moving smart ', 2, None, '___sec46'),
              (' Three phases in Walking Dead ', 2, None, '___sec47'),
              (' Free areas for the *Susceptible* group ',
               2,
               None,
               '___sec48'),
              (' Conclusion ', 1, None, '___sec49'),
              (' Discussion and conclusion ', 0, None, '___sec50'),
              (' Further work ', 2, None, '___sec51'),
              (' Bibliography ', 1, None, '___sec52')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- ------------------- main content ---------------------- -->



<center><h1>Mathematical analysis of epidemic systems- comparison of different models</h1></center>  <!-- document title -->

<p>
<!-- author(s): Torbj&#248;rn Paschen Seland -->

<center>
<b>Torbj&#248;rn Paschen Seland</b> 
</center>


<p>
<!-- institution(s) -->
<p>
<center><h4>Dec 17, 2014</h4></center> <!-- date -->

<h2>Table of contents</h2>

<p>
<a href="#___sec0"> Introduction </a><br>
<a href="#___sec1"> ODE models </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Simple Epidemic Models </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec3"> Threshold phenomenon </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec4"> English Boarding School 1978 </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec5"> Maximum concentration of <em>Infected</em> </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec6"> Zombification </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec7"> Parameters used in the model </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec8"> The initial phase </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec9"> The hysterical phase </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#section:counter_attack"> The counter attack </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec11"> The three phases in Walking Dead </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec12"> Discussion </a><br>
<a href="#___sec13"> PDE models </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec14"> Simple system for spatial spread </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec15"> Travelling wave 1D </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec16"> Verifying the solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec17"> Constant solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec18"> Manufactured solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec19"> Convergence rate </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec20"> The spatial error </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec21"> The temporal error </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec22"> Travelling wave in 2D </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec23"> A gaussian wave </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec24"> Change in initial flow </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec25"> Change in lambda </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec26"> English Boarding School </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec27"> Maximum concentration of <em>Infected</em> </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec28"> Introducing a Gaussian distribution of infected </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec29"> Zombiefication </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec30"> The position of the <em>Infected</em> group </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec31"> Free areas for the <em>Susceptible</em> group </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec32"> Ten minutes at Frederikkeplassen </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec33"> Discussion </a><br>
<a href="#___sec34"> Random walk </a><br>
&nbsp; &nbsp; &nbsp; <a href="#sec:monte_carlo_methods"> Monte Carlo methods </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec36"> Random variable </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec37"> Probability distribution functions (PDF) </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec38"> Moments of a PDF </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec39"> The pertinent variance \( \sigma ^2 \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec40"> Random walker </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec41"> English Boarding School </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec42"> Lower maximum concentration for the <em>Infected</em> group </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec43"> The chance for a disease to spread </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec44"> Zombiefication </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec45"> Random walk </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec46"> Moving smart </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec47"> Three phases in Walking Dead </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec48"> Free areas for the <em>Susceptible</em> group </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec49"> Conclusion </a><br>
<a href="#___sec50"> Discussion and conclusion </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#___sec51"> Further work </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec52"> Bibliography </a><br>
</p>

<h1>Introduction  <a name="___sec0"></a></h1> <hr>
Throughout history large epidemic diseases have spread around the world, often over large geographical areas. These diseases have done great harm on the population and millions of people have died. The Black Death and Cholera are epidemics that have moved over large distances into Europe. When the Black Death came to Europe in 1347, it killed about a third of the population, which at that time was about 85 million people Ref.<a href="#murray2002mathematical">[1]</a> (p.&nbsp;315). These diseases often gave physical symptoms, which have given important knowledge through history to prevent new outbursts and to cure already infected humans. They have various outbreaks, but are often related to connections between humans and animals. Malaria is an example of a disease that transmits from mosquitoes to humans. There have also been various explanations of the spread and cause of epidemics. AIDS(autoimmune deficiency syndrome) has as an example been ascribed by many as a punishment sent by God. Ref.<a href="#murray2002mathematical">[1]</a> (p.&nbsp;316). 
<br />
<br />
The first major epidemic in the U.S.A was the Yellow Fever, discovered in 1793 in Philadelphia. 5000 of a population of 50 000 died. About 20 000 fled the city and the situation was quite chaotic Ref.<a href="#murray2002mathematical">[1]</a> (p.&nbsp;316). This had a major impact on the subsequent life and politics of the country. The power of a disease can do larger damage, with respect to death, than a war.
<br />
<br />
After World War II, public health strategy has focused on elimination and control of organisms which cause disease. In 1978 United Nations sat a goal of eradicating all diseases by year 2000. A large job has been done and smallpox is an example of a disease that was last seen in Somalia in 1977[Ref:cdc.gov]. AIDS was later recognized and has been difficult to stop the spread.
<br />
<br />
Another important aspect in the current spread of diseases, is the displacement of human populations. About a million people cross international borders daily. The growth of human population, especially in underdeveloped countries, is a factor that affects the spread. These conditions played a key role in the spread of HIV(human immunodeficiency) in the 1980's. World Health Organization has estimated that around 32.6 million are infected with the HIV virus today[web:http://www.who.int/features/factfiles/hiv/en/].
<br />
<br />
Knowledge through history is important for the control of different epidemics, but also important in detecting new diseases. The plague of Athens had been studied in great detail by Thucydides in 430-438 BC. Similar had been done with the 'sweating sickness' in the late 15th and first of the 16th centuries in England. The symptoms of 'sweating sickness' was detected in 1993 in the Southwest U.S.A. Here the disease was called hanta virus. There is likely that this is the same disease, but that the 'sweating sickness' has been dormant for couple of hundred years. Ref.<a href="#murray2002mathematical">[1]</a> (p.&nbsp;317). 
<br />
<br />
There have been done several mathematical studies on different diseases. HIV/AIDS is a field which has been studied by several scientists through the years. <em>Mathematical Modelling of the Transmission Dynamics of HIV Infection and AIDS: a Review</em> was published in 1988 by Valerie Isham Ref.<a href="#isham1988mathematical">[2]</a>. This paper focuses on modelling transmission of infection in the context of AIDS epidemic.In 1999 Alan S. Perelson and Patrick W. Nelson published <em>Mathematical Analysis of HIV-1 Dynamics in Vivo</em> Ref.<a href="#perelson1999mathematical">[3]</a>. They studied the dynamics of HIV-1 pathogenesis to AIDS, where they looked at rapid dynamical processes that occur in short time scales, as hours, while AIDS occurs on a time scale of about 10 years. This affect the way that AIDS patients are treated with drugs. <em>Predicting the HIV/AIDS epidemic and measuring the effect of mobility in mainland China</em> by Xiao et. al Ref.<a href="#xiao2013predicting">[4]</a> is another study done on HIV/AIDS where they look at the geographic variation in the severity of the epidemic in China. 
<br />
<br />
This thesis will study three mathematical models used to simulate epidemic diseases. The first chapter will use an ODE system to model the different groups that consists in an epidemic disease. The chapter will study the variations in each group based on the time aspect. The second chapter will look at a PDE system. This model also takes the spatial spread into account, and the position affects the result. A random walk system is studied in the third chapter. In the two first chapters, the amount in each group has been seen as concentrations. In this chapter, each person will be model as a particle. The person behavior will be based on the group it belongs to and the time and position of the person. 
<br />
<br />
The TV series <em>Walking Dead</em> has through several seasons shown the result of a zombie outburst. A couple of studies have been done on epidemic disease, where papers from Munz et. al Ref.<a href="#munz2009zombies">[5]</a> and Langtangen,Mardal &amp; R&#248;tnes Ref.<a href="#zombie-math">[6]</a> can be mentioned. This thesis will use these papers and develop the models further. It will focus on the first five episodes in the first season of <em>Walking Dead</em> Ref.<a href="#walking_dead">[7]</a>, and use parameter values based on this series. 
<br />
<br />
A couple of choices have been done for this thesis. The systems will be model for a short period of time. The longest simulations are performed for a month, while the third chapter only consists of simulations for an half hour. This is done to study the humans behavior and influence in a zombie attack. The second one is to model all systems as closed systems. The amount in each simulation never exceeds 763 humans and the time aspect is short. Therefore the birth and death rate is close to negligible, and are set to zero.    

$$
\newcommand{\Imax}{I_{\textrm{max}}}
$$

<h1>ODE models  <a name="___sec1"></a></h1> <hr>
This chapter will be split into two different parts. The part includes two sections, which will be based on the chapter <em>Dynamic of Infectious Diseases</em> from Mathematical Biology by J.D Murray <a href="#murray2002mathematical">[1]</a>. <em>Epidemic models</em> will give a historic perspective on different epidemic diseases and their effect on the human population. Furthermore a basic ODE system will be shown and studied to see how this model can give information about the disease. The section will check if a disease is severe for the human population, and based on this called an epidemic disease.
<br />
<br />
The last part will be based on a scenario where the population faces a zombification, one of the most critical and devastating epidemic diseases that can occur. Here, the TV series <em>Walking Dead</em> will be used as reference, and the series will be tested against a model based on the SIR model explained in section <em>Simple Epidemic models</em>. There have been a couple of papers on this model earlier, and this part will be based on these models and try to adjust the system to the TV series.

<h1>Simple Epidemic Models  <a name="___sec2"></a></h1>
Most of the models shown here will have a constant population. The zombie model shown later will have a slight increase considering newborn, but this will be close to negligible. This may differ from the real world, where the population in different areas will vary with population flow. Reasons for doing this are, first of all to simplify the model and second to be able to model a closed system. How the population interacts is another assumption that has to be done. Here this is set to be similar for the whole area that is modeled. To simplify the population can be divided into three different groups. 

<ul>
<li> <em>Susceptible</em> (\( S \)), who are humans that are healthy and at risk of becoming infected.</li> 
<li> <em>Infected</em> (\( I \)), who are humans who have the disease or are carriers of the disease. This group can infect the <em>Susceptible</em>.</li> 
<li> <em>Removed</em> (\( R \)),who are dead or recovering humans, often people that already have had the disease.</li> 
</ul>

The natural order for a human is,
$$
\begin{equation}
S \rightarrow I \rightarrow R.
\end{equation}
$$

This model is called \( SIR \) model, but the number of groups can be changed. \( SI \) only consists of the two first groups and a \( SEIR \) model has added an extra group <em>Exposed</em> ,$E$, where the disease is latent. This can be used to model the incubation time. 
<br />
<br />
The transmission of the infection and incubation period are elementary factors in the spread of a disease. These are reflected in the terms of the equations. Since this is a SIR model, the incubation time is negligible. The amount of people in each group can be seen as a function of time, expressed as \( S(t),I(t) \) and \( R(t) \). The growth of \( I \) caused by <em>Susceptible</em>, can be viewed as a rate proportional to the number of <em>Infected</em> and <em>Susceptible</em> multiplied by a constant,$rSI$, where \( r>0 \). This constant controls the efficiency of the transmission from \( S \) to \( I \). This will appear as a reduction in the function \( S(t) \). The rate of removal from <em>Infected</em> to <em>Removed</em> can be viewed as the number of <em>Infected</em> times a constant,$aI$, where \( a>0 \) controls the time spent in the <em>Infected</em> group. The dynamic model will be,
$$
\begin{equation} \label{eq:SIR_model}
	\begin{aligned} 
	\frac{dS}{dt} &= -rSI \\ 
	\frac{dI}{dt} &= rSI-aI \\ 
	\frac{dR}{dt} &= aI 
	\end{aligned}
\end{equation}
$$

This model is called the Kermack-McKendrick(1927) model <a href="#murray2002mathematical">[1]</a> (p.&nbsp;320). It is considered that the groups are uniformly mixed and that there is equal probability of contact for all individuals. These assumptions will not be correct for all diseases, especially sexually transmitted diseases.&#160;The total number of the population will stay constant, since this is a closed system. This can be seen on the total change.
$$
\begin{equation}
\frac{dS}{dt} + \frac{dI}{dt} + \frac{dR}{dt} = 0
\end{equation}
$$


<p>
Therefore the total size of the population, \( N \), will be constant. 
$$
\begin{equation} \label{eq:SIR_N}
S(t)+I(t)+R(t) = N
\end{equation}
$$

<h1>Threshold phenomenon  <a name="___sec3"></a></h1>
The threshold value is essential when studying an epidemic model. To cause an epidemic situation, the model needs to fulfill \( I(t)> I_0 \) for some \( t>0 \), where \( I_0 \) describes the initial condition of  the <em>Infected</em> group. The initial conditions can be given as,
$$
\begin{equation} \label{eq:thres_val}
S(0)=S_0 > 0,\hspace{8mm} I(0)=I_0>0,\hspace{8mm} R(0) =0.
\end{equation}
$$

These initial conditions given in Eq.\eqref{eq:thres_val} combined with \( r \) and \( a \) controls the epidemic situation. These will affect the spread of the infection. From Eq.\eqref{eq:SIR_model} the function for the <em>Infected</em> group at initial time is,
$$
\begin{equation}
\left[\frac{dI}{dt}\right]_{t=0} = I_0(rS_0-a)
\end{equation}
$$

The expression inside the brackets controls the change in \( I \). The function will increase if \( S_0 > \frac{a}{r} \), this will therefore be the threshold value for the function. The threshold value will be described by the variable \( \rho \),
$$
\begin{equation} \label{eq:threshold_value}
\rho = \frac{a}{r}
\end{equation}
$$

This can be shown with some phase trajectories of the <em>Susceptible</em> and the <em>Infected</em> in Fig.(<a href="#fig:threshold_phenomenon">1</a>).  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 1:  <a name="fig:threshold_phenomenon"></a> Simulations of the SIR model \eqref{eq:SIR_model} with start positions along the blue line. \( I \) increases until \( S \) is equal to the threshold value \( \rho \), which is set to 35. Then \( I \) is reduced to 0. In the simulations where \( S_0 < \rho \), no epidemic situation is achieved. </p></center>
<p><img src="1_fig/threshold_phenomenon.png" align="bottom" ></p>
</center>

<p>
The simulation shows that \( I \) is based on the relation between \( S \) and \( \rho \). This can be described with a reproduction rate,
$$
\begin{equation}
R_0 = \frac{rS_0}{a}
\end{equation}
$$

It will cause an epidemic reaction if \( R_0 > 1 \). This parameter is crucial in the understanding of the work with the disease. To prevent a dispersion, the value of \( R_0 \) has to be under 1. An effective way to get control is by global vaccination programs. Smallpox is an example on a disease that nearly has been eradicated around the world. This is due to a reduction of <em>Susceptible</em>. However there is always a small chance of side effects when using vaccination, and therefore some people choose to skip it. This is quite critical for the fight of total eradication. Not only is it a big risk for the specific person, but it also increases the number of <em>Susceptible</em>. An epidemic situation can quickly grow again if the reproduction rate reaches the threshold.
<br />
<br />
Some analytical studies can be done on the simple model\eqref{eq:SIR_model}.
$$
\begin{equation} 
\frac{dI}{dS} = -\frac{(rS-a)I}{rSI} = -1 + \frac{\rho}{S},\hspace{8mm}\rho=\frac{a}{r}, (I\neq0).
\end{equation}
$$

The singularities will all lie on the I=0 axis. This equation can be integrated and will then give phase plane trajectories in the (I,S) plane. This can be seen in Fig.(<a href="#fig:threshold_phenomenon">1</a>).
$$
\begin{equation} \label{eq:constant}
I+S-\rho \ln S = \textrm{constant} = I_0 + S_0 - \rho \ln S_0
\end{equation}
$$

All initial values satisfy \( I_0+S_0=N \) since \( R(0) = 0 \). This will change when \( t>0 \). If a disease appears it would be important to know the severity of the disease and the chance of developing to an epidemic disease. Therefore it is crucial to know the maximum value \( \Imax \) which occurs when \( S=\rho \). At this point, \( \frac{dI}{dt}=0 \). This can be found by using \eqref{eq:constant}
$$
\begin{align} 
I+S-\rho \ln S =& I_0 + S_0 - \rho \ln S_0 \nonumber \\
\Imax+\rho-\rho \ln \rho =& I_0 + S_0 - \rho \ln S_0\nonumber \\
\Imax=&- \rho+\rho \ln \rho + I_0 + S_0 - \rho \ln S_0\nonumber \\
\Imax=&N - \rho + \rho \ln\frac{\rho}{S_0} \label{eq:max_I}
\end{align}
$$

The different trajectories in Fig.(<a href="#fig:threshold_phenomenon">1</a>) shows the difference between \( S_0 > \rho \) and \( S_0 < \rho \). An increasing of the <em>Infected</em> group will occur in the cases where \( S_0 \) is higher. While a decreasing will happen when \( S_0 \) is lower. An example can be shown. The \( \rho \) in the simulation in Fig.(<a href="#fig:threshold_phenomenon">1</a>) is set to 35, while \( N=100 \) for all trajectories. A calculation can be done on the lowest trajectory which has the initial conditions \( S_0= 90 \) and \( I_0= 10 \)
$$
\begin{align*}
\Imax =& N-\rho + \rho \ln \frac{\rho}{S_0}\\
\Imax =& 100-35 + 35 \ln \frac{35}{90}\\
\Imax =& 31.94
\end{align*}
$$

This situation causes an epidemic situation since \( \Imax \) is much higher than the initial condition \( I_0 \). The Fig.(<a href="#fig:threshold_phenomenon">1</a>) shows that the trajectory of this function starts decreasing after this point. In the two upper trajectories where \( S_0 < \rho \), the <em>Infected</em> group starts decreasing from the initial condition. The <em>Infected</em> group will decrease towards zero as \( t\rightarrow \infty \).
<br />
<br />
The <em>Susceptible</em> will always have a decreasing solution since \( \frac{dS}{dt} < 0 \) when \( S\neq0 \) and \( I\neq0 \). From the ODE system\eqref{eq:SIR_model} some integration can be done,
$$
\begin{equation} \label{eq:S_infty}
	\begin{aligned}
	\frac{dS}{dR} =& -\frac{S}{\rho}\\
	S =& S_0e^{-R/\rho} 
	\end{aligned}
\end{equation}
$$

Then the following term is true,
$$
\begin{equation} 
S = S_0e^{-R/\rho} \geq S_0e^{-N/\rho} > 0
\end{equation}
$$

As \( t\rightarrow \infty \), the total number of <em>Susceptible</em> will be in the range \( 0 < S(\infty)\leq N \). This range can be reduced even more by knowing that \( I \) will increase as long as \( S> \rho \). The number of <em>Susceptible</em> will be in the range \( 0 < S(\infty)\leq \rho \). Since \( I \) will be zero when the time goes towards infinity, the <em>Removed</em> group can be described \( R(\infty)= N -S(\infty) \). Now this can be insert in eq\eqref{eq:S_infty}, which gives,
$$
\begin{equation}
S(\infty) = S_0 \exp\left(-\frac{N-S(\infty)}{\rho}\right)
\end{equation}
$$

\( S(\infty) \) can be found as the positive root in the transcendental equation. This can be used to find the total number of people who catch the disease.
$$
\begin{equation} \label{eq:total_I}
I_{total} = I_0 + S_0 -S(\infty)
\end{equation}
$$

This analysis is based on the implication that the disease dies out because the <em>Infected</em> group goes towards zero, and not because of the lack of <em>Susceptible</em>. It will affect the number of <em>Susceptible</em> that can be infected. The reproduction rate (\( R_0 \)), will vary with respect to different parameters as population density, incubation time and the length of the period of sickness. The two equations shown in Eq.\eqref{eq:max_I} and Eq.\eqref{eq:total_I} gives an understanding of the maximum and total number in the <em>Infected</em> group, but the methods demand the exact numbers of \( \rho,I_0,S_0 \) and \( S \), which is quite hard to get in a real situation. The challenging thing is often to know how many infected there are at each time. The number of <em>Removed</em> is often the easiest group to control.. This group is assisted with medical help. So to model a realistic situation, the number of <em>Removed</em> as a function of time \( dR/dt \) is a realistic model. Here the equations from \eqref{eq:SIR_model} ,\eqref{eq:SIR_N} and \eqref{eq:S_infty} can be used.
$$
\begin{equation} \label{eq:dR_normal}
	\begin{aligned} 
	\frac{dR}{dt} &= aI\\
	&= a(N-R-S)\\
	&= a(N-R-S_0e^{-R/\rho}), R(0)=0,
	\end{aligned}
\end{equation}
$$

This solution demands several parameters as \( a \), \( r \), \( S_0 \) and \( N \) to solve this numerically. It is normal to adjust the parameters after the epidemic situation to get the best result as possible. However, if the epidemic is not to large, \( R/\rho \) will be quite small, at least under 1. Then another model from Kermack and McKendrick(1927) can be used. J.D Murray does a deeper study of this in his book <a href="#murray2002mathematical">[1]</a> (p.&nbsp;324). This chapter will look at an example from a boarding school in England and do some studies on the change in \( \rho \).

<h1>English Boarding School 1978  <a name="___sec4"></a></h1>
The British medical journal published a report from a boarding school in England in 1978. One of the boys had brought with him a disease back to the school. Since this was a boarding school, they were totally isolated from others and had a closed system to model <a href="#murray2002mathematical">[1]</a> (p.&nbsp;325). The simulation can be seen in Fig.(<a href="#fig:english_boarding">2</a>)  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 2:  <a name="fig:english_boarding"></a> An English boarding school is modeled for 15 days with the following parameters: \( N=763 \), \( S_0=762 \), \( I_0=1 \), \( R_0=0 \), \( \rho=202 \) and \( r=2.18 x 10^{-3} \). An increase in the <em>Infected</em> group can be seen since \( S_0 > \rho \). </p></center>
<p><img src="1_fig/English_boarding_school.png" align="bottom" ></p>
</center>

<p>
The parameter value \( \rho \) has a major impact on the result. The epidemic disease could turn out quite differently than in the situation in Fig.(<a href="#fig:english_boarding">2</a>), caused by variations in \( a \) and \( r \). Fig.(<a href="#fig:rho_changes">3</a>) consists of some examples where \( \rho \) varies from 50 to 400.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 3:  <a name="fig:rho_changes"></a> In the first plot where \( \rho=50 \), the <em>Infected</em> group will increase until the number of <em>Susceptible</em> falls down to 50. This will result in a majority of infected students. In the last plot where \( \rho=400 \), the total number of <em>Susceptible</em> stays around 170 students and will go towards a steady number as \( I(\infty)=0 \). </p></center>
<p><img src="1_fig/English_boarding_school_changes.png" align="bottom" ></p>
</center>

<h2>Maximum concentration of <em>Infected</em>  <a name="___sec5"></a></h2>
The maximum concentration of the <em>Infected</em> group can be found by usin the threshold value. The result can be compared to the simulation in Fig.(<a href="#fig:english_boarding">2</a>). Maximum of <em>Infected</em> can be found by the following equation from Eq.\eqref{eq:max_I}
$$
\begin{equation} \label{eq:max_I_eng}
\Imax= N - \rho + \rho \ln\frac{\rho}{S_0} \label{eq:max_I}
\end{equation}
$$

By inserting the parameters from the simulation in Fig.\eqref{english_boarding} in Eq.\eqref{eq:max_I_eng}, the value of \( \Imax = 292 \). The \( \Imax \) of the simulation can be found by checking the maximum number of the infected list. This is similar as the calculated \( \Imax \). This maximum value of the <em>Infeced</em> group occurs when the \( Susceptible \) group is 202, and similar to the value of \( \rho \) in the simulation.

<h1>Zombification  <a name="___sec6"></a></h1>
One of the worst epidemics that can affect the human population is a zombie attack. This will have a huge impact on the way humans live today. Several movies and series has illustrated this type of situation, but it is time that the scientists also take this threat seriously. There have been written a couple of papers about this. Munz et. al<a href="#munz2009zombies">[5]</a> used the SEIR model to simulate a possible upcoming zombiefication, where the latent group(\( E \)), is replaced with an <em>Infected</em> group(\( I \)) and the <em>Infected</em> group(\( I \)) is replaced with a <em>Zombie</em> group(\( Z \)). Here it is important to know that the <em>Infected</em> group in the \( SIZR \) is not the same as in the \( SEIR \) model. The following model was used,

$$
\begin{align*}
\frac{dS}{dt} =& \Sigma -\beta SZ - \delta S \\
\frac{dI}{dt} =& \beta SZ - \varrho I - \delta I\\
\frac{dZ}{dt} =& \varrho I + \zeta R - \alpha SZ\\
\frac{dR}{dt} =& \delta S + \delta I + \alpha SZ - \zeta R
\end{align*}
$$


<p>
This is a bit more complicated than the standard \( SEIR \) model. A presentation of the parameters;

<ul>
<li> \( \Sigma \) describes the birthrate for new <em>Susceptible</em>. \( \frac{dS}{dt} \) is now able to be positive. This is now not a closed system.</li> 
<li> \( \beta SZ \) describes the numbers of <em>Susceptible</em> that become infected , based on interactions between zombies and humans. Similar to the case for \( rSI \) in the SIR model.</li> 
<li> \( \delta \) describes the number of natural deaths in the group. This is used in the <em>Susceptible</em> and the <em>Infected</em> group</li>
<li> \( \varrho I \) describes the probability for an infected human to wake up as a zombie.</li>
<li> \( \zeta R \) controls the number of <em>Removed</em> that arises as <em>Zombie</em>.</li> 
<li> \( \alpha SZ \) describes the number of zombies killed by humans in the zombie attacks.</li> 
</ul>

<br />
<br />
This model was challenged by Langtangen, Mardal and R&#248;tnes <a href="#zombie-math">[6]</a> now referred to as LMR, where they developed another model. They had three objections to the model from Munz et. al <a href="#munz2009zombies">[5]</a>. LMR argue that dead zombies cannot become functioning zombies again. Therefore \( \zeta \) will be zero, if magic is not introduced. They let the parameters in the model change with time, according to different phases. LMR argue that the behavior will change with time during a zombie attack. The parameters in the model is based on the movie <em>The Night of The Living Dead</em>. This is done to reproduce its scenarios and then predict how a zombie outbreak would appear. There is also added a function \( \omega(t) \), which creates a massive attack from the humans. This is controlled by a time variable and give the <em>Susceptible</em> a chance to fight back. The system can be seen in eq\eqref{eq:LMR_model}:
$$
\begin{equation} \label{eq:LMR_model}
	\begin{aligned} 
	\frac{dS}{dt} =& \Sigma -\beta SZ - \delta_SS \\
	\frac{dI}{dt} =& \beta SZ - \varrho I - \delta_II\\
	\frac{dZ}{dt} =& \varrho I- (\alpha+\omega(t))SZ + \zeta R\\
	\frac{dR}{dt} =& \delta_SS +\delta_II -\zeta R + (\alpha+\omega(t))SZ 
	\end{aligned}
\end{equation}
$$

The main change is the \( \omega(t) \). This is a Gaussian curve and can be seen in eq\eqref{eq:omega}.
$$
\begin{equation} \label{eq:omega}
\omega(t) = a \sum^m_{i=0}\exp\left(\frac{1}{2}\left(\frac{t-T_i}{\sigma}\right)^2\right)
\end{equation}
$$

\( \omega(t) \) controls the attacks from the <em>Susceptible</em>, which will be fired at predefined time steps. These are controlled by the three parameters. 

<ul>
<li> \( a \) here works as a similar parameter as \( \alpha \), but will only be activated when the <em>Susceptible</em> group is organized and ready to attack.</li> 
<li> \( T \) contains a list of numbers, which controls the time when the attacks will occur.</li>
<li> \( \sigma \) controls the length of the attack.</li> 
</ul>

This function will be modeled later when it is used in the section <a href="#section:counter_attack">The counter attack</a>
<br />
<br />

<h2>Parameters used in the model  <a name="___sec7"></a></h2>
The parameter values are essential factors when modelling a zombie attack. Data from the movie <em>The Night of The Living Dead</em> was used as basis for the parameters in the ODE system from LMR <a href="#zombie-math">[6]</a>. This thesis is based on a thorough study of the TV series Walking Dead <a href="#walking_dead">[7]</a>. The data will be based on the first five episodes and are constructed after having watched the episodes carefully. The three phases in a zombie attack will be based on the form used in the paper from LMR, but with an extended version in the <em>Counter attack phase</em> .

<h3>The initial phase  <a name="___sec8"></a></h3>

The disease is not yet known in this phase and humans try to save the sick ones by taking them to hospitals or getting some kind of treatment. Because of this ignorance related to the disease, the number in the <em>Infected</em> group is high. This phase is often quite short and humans soon start to realise that the risk of getting infected by saving others is really high. <em>Walking Dead</em> never shows anything from this phase, but the viewer sees the results when the main character sheriff Rick Grimes wakes up at the local hospital. What he sees is the major damage caused in the initial phase, while the society has moved to the hysterical phase.
<br />
<br />
To determine the values for each group in each phase, the length of Ricks coma is essential. There are several factors that give an indication of the time aspect. When Rick wakes up at the hospital, he has grown a smooth beard of about 1 cm. This would correspond with 1 month in average for a male of European origin. He also has some flowers that have dried out. These also give the impression that some weeks have gone by. The hospital is running on its emergency generator. This would probably not last for many days with a fully operational hospital, but the hospital is as well as shut down when Rick wakes up and can give the emergency generator a longer lifetime. Dr. Edwin Jenner gives the viewer some information in episode 5 where he tells the videolog that it was 63 days since the epidemic started spreading. By studying the first five episodes in detail, one gets an impression that the time aspect has not been in focus. Therefore the different phases are constructed from the information that has been given. Rick Grimes has probably been in a coma for a month and what he meets the first days will be the basis for the number in each group. The total amount of objects in the model will be based on the number of humans, dead and zombies seen in the first five episodes. 

<ul>
 <li> The number of humans has been estimated to <b>62</b>. 20 living in the camp with Rick, 40 humans in the old nursing home and the father and son in episode 1.</li> 
 <li> The number of dead is estimated to <b>200</b>. This is based on the amount of dead outside the hospital where Rick woke up.</li> 
 <li> The number of zombies are assumed to be <b>360</b>. These are based on the 30 outside the house of Morgan Jones and his son Duane, 300 zombies in the city Atlanta and 30 zombies attacking the camp.</li> 
</ul>

The total number will be <b>622</b> and the time aspect aroud a month, which means that these numbers are for the hysterical phase.Over the three first days when Rick is awake, 1 human and 20 zombies are killed in battles. This can be used to find the final number in the initial phase by calculating backwards. By going nine similar periods backwards, the number of killed zombies is 190. The same can be done for humans, which then results in 9 killed humans in this period. The final number for the initial phase can then be set to 71 humans, 540 zombies/infected and 20 dead. This is the same number as for the initial values for the hysterical phase, since the phases are connected.
<br />
<br />
Another issue to discuss is the incubation time. Here there are two examples that can be used. The first transformation from human to zombie happens for the character Amy, who was bit in the arm by a zombie. The transformation happens in about 12 hours. The other example is character Jim who has a slower transformation. This lasts for about two days before the rest of the group leave him alongside the road on their way to CDC(Center for Disease Control). An estimate of the incubation time can be set to 24 hours based on these two transformations.
<br />
<br />
Now the ODE system \eqref{eq:LMR_model}can be used to model the initial phase. The expected results are \( S_0 = 621 \) and \( Z_0 = 1 \) while the two other groups are set to zero. The value of \( \beta \) can be found with the expression \( \beta \Delta t S Z \) from the first ODE equation. After three days about 90 percent of the humans are killed.
$$
\begin{equation}
	\begin{aligned}
	\beta\Delta t S Z &= 0.9 S\\
	3\beta   &= 0.9 \\
	\beta &= 0.3 \\
	\end{aligned}
\end{equation}
$$

The probability of a human being infected will be set to \( \beta = 0.3 \). The natural death rate is set to \( \delta_S = 2.2*10^{-5} \) based on numbers from CDC <a href="#CBC_deaths_2011">[8]</a>. It is quite hard to find similar realistic data for infected humans, so \( \delta_I = \delta_S \). The number of births is set to \( \Sigma = 3.45*10^{-5} \). This is based on data from CDC from 2012 <a href="#CBC_births_2012">[9]</a>. Since this is data for the initial phase, zombies are seen as infeteced humans that can be saved. Therefore \( \alpha = 0 \). And the two last parameters are also zero, \( a = \zeta = 0 \). The initial phase is modeled in Fig.(<a href="#fig:initial_phase_1">4</a>):

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 4:  <a name="fig:initial_phase_1"></a> Initial phase for <em>Walking Dead</em>. \( \beta=0.3 \), \( \varrho=1 \) and \( \alpha=0 \) leads to eradication. </p></center>
<p><img src="1_fig/WD_zombie_initial_1.png" align="bottom" ></p>
</center>

<p>
The result from Fig.(<a href="#fig:initial_phase_1">4</a>) shows that the human population is eradicated in about a half day. This is not the case, and some adjustments need to be done. There are three parameters that are interesting to study. The first one is \( \beta \), which describes how many humans that get infected in a human-zombie collision. The second one is \( \varrho \). This parameter controls the incubation time. The last parameter that can affect the number in each group is \( \alpha \). This describes the number of zombies killed in a human-zombie collision. These variables are plotted separately and combined in Fig.(<a href="#fig:initial_parameters">5</a>). The idea here is to produce results that fulfill the final number for the groups <em>Susceptible</em> and <em>Removed</em> , which is 71 and 20. The blue dot in each plot describes this value. A rough estimate has been done for each parameter before using it. This is why they all lie in different regions than the parameter value in Fig.(<a href="#fig:initial_phase_1">4</a>)

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 5:  <a name="fig:initial_parameters"></a> These plots give an important knowledge in the effect of varying the parameters. \( \beta \) and \( \varrho \) mainly affect the number of <em>Susceptible</em> while \( \alpha \) affect them both. </p></center>
<p><img src="1_fig/check_parameters.png" align="bottom" width=800></p>
</center>

<p>
By choosing \( \beta = 0.01155 \), \( \varrho=1.37 \) and \( \alpha=0.00044 \), the following plot can be seen in Fig.(<a href="#fig:initial_phase_2">6</a>):  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 6:  <a name="fig:initial_phase_2"></a> The final values are \( S_n=71.3,I_n=230.8,Z_n=298.9 \) and \( R_n=21 \), which is quite close to the result from the movie. </p></center>
<p><img src="1_fig/WD_zombie_initial_2.png" align="bottom" ></p>
</center>

<p>
It is possible to argue for the changes done in Fig.(<a href="#fig:initial_phase_2">6</a>). Increasing \( \varrho \) to 1.37 reduces the incubation time. Now the average time will be about 17.5 hours, which is realistic. The probability \( \beta \) is sensitive and has a major effect only by small variations. This is due to the term that it is a part of \( \Delta t SZ \beta \). A couple of examples demonstrate this. One hour can be estimated by setting \( \Delta t = 1/24 \). When using the initial values for the groups \( S \) and \( Z \) and \( \beta=0.01155 \) from Fig.(<a href="#fig:initial_phase_2">6</a>), the number in the <em>Infected</em> group in the first hour will be \( (1/24)*721*1*0.01155=0.34 \). About  one-third of a human in the first hour seems as a slow and not very aggressive disease. However when the number of <em>Zombies</em> slowly increases, the number of infected will be affected. By looking at the hour when the values are equal between humans and zombies, about 200 in each group, the number of infected will be 19.25 per hour. This result in about 10 percent of the humans. By changing \( \beta \) to the value from Fig.(<a href="#fig:initial_phase_1">4</a>), the number of infected will be 500 per hour and it is quite easy to see that this will lead to eradication in a short amount of time. The last parameter \( \alpha \) controls the number of zombies that dies in collisions between zombies and humans. While humans still think that the infected can be saved, it is still a chance that the result from a collision can end with a zombie kill. These results can therefore be seen as realistic values.

<h3>The hysterical phase  <a name="___sec9"></a></h3>

Now the humans start to avoid the infected and some try to fight them. The humans often gather in groups and try to find safe spots away from the zombies. Important supplies as weapons and food are their main priorities. Barricades are built and the guarding is strict. When Rick Grimes wakes up, the hospital is abandoned and the halls are filled up with dead people. Quite fast he understand that he needs to reach safety. After a couple of days he ends up in a camp outside Atlanta city. A couple of elementary changes has happened with the interaction between humans and infected/zombies. In the initial phase, the humans tried to help the infected humans. This resulted in a high percent of infected. Now they understand this risk and keep distance to those who are infected. This will give \( \beta \) a lower value. The morality for a zombie kill has dramatically changed. While this was seen as no option in the initial phase, this is now okay. The humans have started to treat zombies and infected as enemies instead of sick allies. This results in a higher death rate among the zombies, which is described by \( \alpha \). 
<br />
<br />
The hysterical model can be constructed based on the data found in the initial phase. 

<p>
<table border="1">
<thead>
<tr><th align="center">hysterical phase</th> <th align="center">initial values</th> <th align="center">final values</th> </tr>
</thead>
<tbody>
<tr><td align="center">   S                   </td> <td align="center">   71.3              </td> <td align="center">   62              </td> </tr>
<tr><td align="center">   I                   </td> <td align="center">   230.8             </td> <td align="center">   -               </td> </tr>
<tr><td align="center">   Z                   </td> <td align="center">   298.9             </td> <td align="center">   360             </td> </tr>
<tr><td align="center">   R                   </td> <td align="center">   21                </td> <td align="center">   200             </td> </tr>
</tbody>
</table>
<p>
Here, the infected and zombies are counted as one group for the final values, since it is difficult to separate these groups in the series. The time aspect will be modeled for 30 days, which results in a ten times longer simulation. Since the final results are known here, a similar adjustment of the parameters can be done. The range of the parameter values have been found by some test simulations.In Fig.(<a href="#fig:hysterical_variations">7</a>) the parameters of \( \beta \),$\varrho$ and \( \alpha \) have been simulated with different values. 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 7:  <a name="fig:hysterical_variations"></a> Variation in three different parameters in the hysterical phase. The last subplot consist of the combination of all. \( \beta=[1*10^{-5},1.2*10^{-5}] \), \( \varrho=[1,2] \) and \( \alpha=[2*10^{-4},2.2*10^{-4}] \) </p></center>
<p><img src="1_fig/check_parameters_hysterical_2.png" align="bottom" width=800></p>
</center>

<p>
Fig.(<a href="#fig:hysterical_variations">7</a>) gives insight in how variations in parameters affect the final result. By decreasing \( \beta \), it will essentially increase the number of <em>Susceptible</em> that will survive, but it will also increase the number of deaths. This may at a first glance seem quite strange. Should not the number of deaths decrease when the number of surviving humans increase? This can be explained with the idea that was shown for \( \beta \) in the initial phase. Since \( \beta SZ \) gets smaller when \( \beta \) gets smaller, the combination of \( SZ \) will stay higher for a longer time . This will again affect \( \alpha SZ \), which regulates the number of killed zombies. The larger this combination is, the more zombies will die. 
<br />
<br />
By increasing \( \alpha \), the number of <em>Removed</em> also increase. However similar to the increasing of the <em>Removed</em> it also has a slight increase on the number of <em>Susceptible</em>. Here the argument for \( \beta \) above can be reversed. Since a higher \( \alpha \) leads to a higher death rate among the zombies, the combination \( SZ \) will be smaller, which makes \( \beta SZ \) smaller.
<br />
<br />
The last parameter, \( \varrho \), has nearly no effect. The red dots show a small decreasing of <em>Removed</em> and increasing of <em>Susceptible</em>  when \( \varrho \) is increased. This parameter varies most, but has least impact. This can be explained with the long time aspect and the low number of infected compared to the number of zombies. Since the number of zombies is much higher, the transformation length from infected to zombie is almost negligible.  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  <a name="fig:hysterical_1"></a> Hysterical phase with parameter values \( \beta = 0.000011 \), \( \varrho = 1.5 \) and \( \alpha = 0.000208 \). </p></center>
<p><img src="1_fig/WD_zombie_hysterical_1.png" align="bottom" ></p>
</center>

<p>
Fig.(<a href="#fig:hysterical_1">8</a>) fulfills the result that was predicted based on the series. These final numbers correspond with the number in each group when Rick woke up at the hospital. The plot shows that the number of zombies increases quickly and reaches its maximum value after a couple of days in this phase, similar to the number of infected that dramatically decreased. Here the humans have been able to stabilize. Since the clashes between humans and zombies are dramatically decreased, nearly no humans get infected. And in the cases where humans have to face zombies, the killing rate has increased. The increase of <em>Removed</em> is close to proportional to the decrease of <em>Zombies</em>, which means that it is mostly zombies that die.

<h3>The counter attack <a name="section:counter_attack"></a></h3>

This counter attack is more complicated to model, since this phase appears simultaneously as the hysterical phase in <em>Walking Dead</em>. The group of humans are trying to avoid the zombies, but when the zombies get too close, the humans need to fight back. These situations are caused by a high density of zombies in some areas, which force the zombies to spread. In <em>Walking dead</em> the counter attack appears when a group of 30 zombies reach the camp. This triggers a fight where all the zombies are killed and 4 of the humans get bitten. This shows that a counter attack from the humans causes a lot of damage. The time aspect is set to 6 hours.  
<br />
<br />
Now the function \( \omega(t) \) will be used. This can be seen in Fig.(<a href="#fig:omega_function">9</a>):

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 9:  <a name="fig:omega_function"></a> \( \omega (t) \) is a Gaussian function where \( a \) controls the maximum value, \( T \) controls the time for maximum value and \( \sigma \) controls the length of the attack. </p></center>
<p><img src="1_fig/omega_function.png" align="bottom" ></p>
</center>

<p>
To get some start values, \( SZ\omega(t)=30 \) can be used. Where \( \omega(t) \) is the area under the function. By inserting the final values from hysterical phase for \( S \) and \( Z \), the area shall be \( \omega (t)=1.34*10^{-3} \). This result can be reproduced by using \( a= 0.00103 \) and \( \sigma = 0.005 \) in \( \omega(t) \). The counter attack is sat to appear during the last part of the day [0.75,1]. The value of T is then set to $T=[0.875].

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 10:  <a name="fig:zombie_counter_1"></a> The counter attack. 8-9 zombies are killed and all humans survive </p></center>
<p><img src="1_fig/WD_zombie_counter_1.png" align="bottom" ></p>
</center>

<p>
This simulation in Fig.(<a href="#fig:zombie_counter_1">10</a>) results in some deaths,but the total number should be higher. Another problem is that no humans died during this battle. The ODE model \eqref{eq:LMR_model} is based on <em>The Night of the Living Dead</em>, where the amount of humans who are killed is close to zero. This is not the case in <em>Walking dead</em>. Therefore the risk of dying is higher for human during a counter attack. This is solved by adding \( \mu \omega (t) SZ \), where \( \mu \) is the risk for a human getting infected compared to a zombie kill during this attack. The model \eqref{eq:LMR_model} can then be expanded to system\eqref{eq:seland_model},

$$
\begin{align*} \label{eq:seland_model}
\frac{dS}{dt} =& \Sigma -(\beta+\mu \omega(t))SZ - \delta_SS \\
\frac{dI}{dt} =& (\beta+\mu \omega(t))SZ - \varrho I - \delta_II\\
\frac{dZ}{dt} =& \varrho I- (\alpha+\omega(t))SZ + \zeta R\\
\frac{dR}{dt} =& \delta_SS +\delta_II -\zeta R + (\alpha+\omega(t))SZ 
\end{align*}
$$


<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 11:  <a name="fig:zombie_counter_2"></a> Counter attack with the new model. Parameter values are set to \( a=0.0073 \) and \( \mu=0.14 \). </p></center>
<p><img src="1_fig/WD_zombie_counter_2.png" align="bottom" ></p>
</center>

<p>
Fig.(<a href="#fig:zombie_counter_2">11</a>) is modeled with the initial values given when Rich woke up, explained in the initial phase. The result after this day is that the humans are reduced to 58 humans. The number in the <em>Infected</em> group is increased to 2.47, which can be explained with the two characters in the series, Amy and Jim. The number of <em>Removed</em> is increased to 231, and is a combination of killed zombies and humans who are attacked. By modelling this for another day, the <em>Removed</em> group will increase with a couple of new deaths. 
<br />
<br />
It would be interesting to check what would happen if this counter attack was repeated over time. Who would survive? An attack every other day will give the following result shown in Fig.(<a href="#fig:counter_series">12</a>)

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 12:  <a name="fig:counter_series"></a> 100 counter attacks during 200 days will result in a higher population of humans. </p></center>
<p><img src="1_fig/WD_zombie_counter_series.png" align="bottom" ></p>
</center>

<p>
After 200 days there would be about 15 humans and 12 zombies left. Then the humans would be able to survive since they are more efficient in battles.

<h3>The three phases in Walking Dead  <a name="___sec11"></a></h3>

By adding these three phases together, the final result after the attack should be possible to match. The simulation here will be done with the parameters used in the earlier sections. This can lead to a small error since the result of the final number in each phase is given with decimals and the initial values are based on assumptions and round off numbers. The different parameter values are listed in Tab.(<a href="#table:param_val">table:param_val</a>). 

<p>
<a name="table:param_val"></a>
<table border="1">
<thead>
<tr><th align="center">  parameter  </th> <th align="center">Initial phase</th> <th align="center">hysterical phase</th> <th align="center">counter attack</th> </tr>
</thead>
<tbody>
<tr><td align="center">   \( \beta \)      </td> <td align="center">   0.01155          </td> <td align="center">   0.000011            </td> <td align="center">   0.00011           </td> </tr>
<tr><td align="center">   \( \varrho \)    </td> <td align="center">   1.37             </td> <td align="center">   1.5                 </td> <td align="center">   1.5               </td> </tr>
<tr><td align="center">   \( \alpha \)     </td> <td align="center">   0.00044          </td> <td align="center">   0.000208            </td> <td align="center">   0.000208          </td> </tr>
<tr><td align="center">   a                </td> <td align="center">   0                </td> <td align="center">   0                   </td> <td align="center">   0.0073            </td> </tr>
<tr><td align="center">   \( \sigma \)     </td> <td align="center">   0                </td> <td align="center">   0                   </td> <td align="center">   0.005             </td> </tr>
<tr><td align="center">   \( \mu \)        </td> <td align="center">   0                </td> <td align="center">   0                   </td> <td align="center">   0.14              </td> </tr>
</tbody>
</table>
<p>
The simulation is run for 34 days. The three first days are in the initial phase, the resisting days are in the hysterical phase. The counter attack is released on day 33 and lasts for about 6 hours. The plot is shown in Fig.(<a href="#fig:all_phases">13</a>)   

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 13:  <a name="fig:all_phases"></a> Walking Dead simulated after 5 episodes. Based on the three different phases. </p></center>
<p><img src="1_fig/WD_zombie_all_phases_1.png" align="bottom" ></p>
</center>

<p>
Fig.(<a href="#fig:all_phases">13</a>) clearly shows that the change in parameter values affect the different phases. The different values are shown in the Tab.(<a href="#table:group_values">table:group_values</a>), where the values are given at the initial time. The last column consist of the final values after 34 days.

<p>
<a name="table:group_values"></a>
<table border="1">
<thead>
<tr><th align="center">   </th> <th align="center">Initial phase</th> <th align="center">hysterical phase</th> <th align="center">counter attack</th> <th align="center">final values</th> </tr>
</thead>
<tbody>
<tr><td align="center">   S_0    </td> <td align="center">   621              </td> <td align="center">   71                  </td> <td align="center">   62                </td> <td align="center">   58              </td> </tr>
<tr><td align="center">   I_0    </td> <td align="center">   0                </td> <td align="center">   231                 </td> <td align="center">   0                 </td> <td align="center">   1               </td> </tr>
<tr><td align="center">   Z_0    </td> <td align="center">   1                </td> <td align="center">   299                 </td> <td align="center">   359               </td> <td align="center">   332             </td> </tr>
<tr><td align="center">   R_0    </td> <td align="center">   0                </td> <td align="center">   21                  </td> <td align="center">   202               </td> <td align="center">   231             </td> </tr>
</tbody>
</table>
<p>
Considering the uncertainty of the parameters, this simulation gives a result close to the expected result. 
<br />
<br />

<h1>Discussion  <a name="___sec12"></a></h1>
Two different ODE models are used in this chapter. The first model is a basic SIR model, and the disease in the <em>English boarding school</em> is based on this model. The expected result was produced. With variations in the value of \( \rho \), it caused large differences in the result for the simulation.
<br />
<br />
The <em>Zombiefication</em> part was based on the model and phases from LMR Ref.(<a href="#zombie-math">[6]</a>). The parameters and the lenght of the phases were adjusted to simulate <em>Walking Dead</em>. Several assumptions were made from the writer to model this series. Since the simulations were based on expected results, the parameters were adjusted to fulfill these demands. The model was able to produce the expected result for the groups, and one can say that the spread can be seen as possible based on these assumptions.    
<br />
<br />
There are several factors that this model don't take into account. How will the number of battles effect the humans and zombies? Will they be tired or more efficient? What about weapons? What would happen if the group of zombies was much larger? Due to different variations in behavior of humans and zombies, one can never predict all situations accurately. This is a weakness with this model, and human behavior is difficult to add to the model.  
<br />
<br />
The parameters found in this model will be used for all three chapters.This model is straight forward to calculate and is easy to use.The model is good if the goal is to find the total amount of each group measured over an area. It demands that the parameters are given. The model gives no information about the spatial spread of the disease. This will therefore be useless in describing how a disease can spread abroad countries and borderlines, or the spatial differences of being infected. The two next chapters will introduce more complicated models which will take the spatial position into account.

<h1>PDE models  <a name="___sec13"></a></h1> <hr>
This chapter will introduce a spatial model for epidemic diseases. The ODE system from the previously chapter can be expanded with a term for geographic spread of the disease. The first section <em>Simple system for spatial spread</em> will be based on the simple SIR model presented in previously chapter, and the chapter <em>Geographic spread and Control of epidemics</em> by Murray <a href="#murray2003mathematical">[10]</a>. The parameters from the <em>English Boarding School</em> in the previously chapter will be used for the model and the results will be compared. The position of the infected student will be studied to see if it affects the number in the <em>Infected</em> group. The last section, <em>Zombiefication</em>, will study and expand the system from Langtangen, Mardal and R&#248;tnes <a href="#zombie-math">[6]</a>. The results and parameter values used to calculate <em>Walking Dead</em> will be compared with the previously ODE system and variations of this PDE.

<h1>Simple system for spatial spread  <a name="___sec14"></a></h1>
A spatial variable, <b>x</b>, will be introduced to the model. This results in both temporal and spatial variations. The difference from a standard ODE system will be the diffusion part added to each equation. The system can be seen in Eq.\eqref{eq:simple_PDE}. 
$$
\begin{equation} \label{eq:simple_PDE}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -rIS + D\nabla ^2 S\\
	\frac{\partial I}{\partial t} &= rIS- aI + D\nabla ^2 I\\
	\frac{\partial R}{\partial t} &= aI + D\nabla ^2 R
	\end{aligned}
\end{equation}
$$

Here \( S \) describes the <em>Susceptible</em> group, \( I \) describes the <em>Infected</em> group and \( R \) describes the <em>Removed</em> group. The following conditions are set for the boundary and initial values:
$$
\begin{equation} \label{eq:boundary_initial}
	\begin{aligned}
	u_x(0,t) &= u_x(X,t) = 0,\quad u = S,I,R\\
	u(x,0) &= f_u(x),\quad u= S,I,R
	\end{aligned}
\end{equation}
$$

This results in Neumann conditions at the boundary. The following implementation can be used at the boundary
$$
\begin{equation}
	\begin{aligned}
	\frac{u_{-1}^n - u_1^n}{2\Delta x} &= 0 \\
	u_{-1}^n &= u_1^n
	\end{aligned}
\end{equation}
$$

This is solved by adding an extra point on each side, called ghost points. The values in these ghost points are updated every time step with values from \( u_1^n \) and \( u_{X-1}^n \). All three groups, \( S,I,R \) in Eq.\eqref{eq:simple_PDE} have the same diffusion coefficient, \( D \). This gives the three groups the same diffusion speed. This can vary between systems. Later in the chapter, in section <em>Zombiefication</em>, different diffusion terms are given to the groups. The two probabilities \( rIS \) and \( aI \) will work in the same way as in the ODE system. Since this model takes the position into account, a group of <em>Infected</em> that move into a uniform population with <em>Susceptible</em> can be model. The group of <em>Susceptible</em> has the density \( S_0 \). A simulation can show the geotemporal spread of the disease. The problem can first be considered as one-dimensional. The system can be nondimensionalised by writing 
$$
\begin{equation} \label{eq:constants_nondimensional}
	\begin{aligned}
	I^* =\frac{I}{S_0},&\quad I^* = \frac{I}{S_0},&\quad R^*= \frac{R}{S_0},&\\
	x^* =\left(\frac{rS_0}{D}\right)^{1/2}x,&\quad t^*=rS_0t,&\quad \lambda =\frac{a}{rS_0},&
	\end{aligned}
\end{equation}
$$

\( S_0 \) is used as a representative population. Now Eq.\eqref{eq:simple_PDE} can be expressed as in Eq.\eqref{eq:simple_non_PDE}. The asterisks have been dropped to make it easier to read.
$$
\begin{equation} \label{eq:simple_non_PDE}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2},\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2},\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

The three parameters \( r \), \( a \) and \( D \) have been replaced by \( \lambda \). The <em>reproduction rate</em> that was presented for the ODE model can be seen as \( 1/\lambda  \).
$$
\begin{equation} \label{eq:reproduction_rate_PDF}
R_0 = \frac{1}{\lambda} = \frac{rS_0}{a}
\end{equation}
$$

The number of secondary infections produced by one primary infected can be seen as \( 1/\lambda \). It can also be used to measure two different time scales. The first one, \( 1/(rS_0) \), measures the contagious time of the disease. The second one looks at the life expectancy for an infected. This can be described as \( 1/a \) <a href="#murray2003mathematical">[10]</a>.

<h2>Travelling wave 1D  <a name="___sec15"></a></h2>
In this case the travelling wave describes how a group of <em>Infected</em> travels through a geographic area of <em>Susceptible</em>. This will be shown by sending a pulse from the <em>Infected</em> group into a group of <em>Susceptible</em>. A travelling wave solution can be described as follows,
$$
\begin{equation} \label{eq:trav_para}
I(x,t)=I(z),\quad S(x,t)=S(z),\quad R(x,t) = R(z),\quad z = x-ct,
\end{equation}
$$

The value \( c \) describes the wave speed. This represents a wave of constant shape that travels in the positive x-direction. Eq.\eqref{eq:trav_para} can be inserted into Eq.\eqref{eq:simple_non_PDE}. This result in the ordinary system Eq.\eqref{eq:ord_diff_sys}
$$
\begin{equation} \label{eq:ord_diff_sys}
	\begin{aligned}
	S'' + cS' - IS &= 0,\\
	I'' + cI' + I(S-\lambda)&=0\\
	R'' + cR  + I\lambda &=0
	\end{aligned}
\end{equation}
$$

This makes an eigenvalue problem. The value of \( \lambda \) needs to stay in a range where \( c > 0 \) is fulfilled. The values \( S \), \( I \) and \( R \) have to stay nonnegative. This leads to
$$
\begin{equation} 
	\begin{aligned}
	0 \leq S(-\infty) < S(\infty)&=1\\
	I(-\infty)=I(\infty)&=0,\\
	1 \geq R(-\infty)\geq R(\infty) &= 0
	\end{aligned}
\end{equation}
$$

An epidemic wave can be seen in Fig.(<a href="#fig:1D_sub">14</a>). The value of \( \lambda \) is set to 0.5. The initial value of <em>Susceptible</em> is 1 for the area and the <em>Removed</em> is set to 0. The <em>Infected</em> group has a Gauss curve around 0 at initial time. In the four subplots in Fig.(<a href="#fig:1D_sub">14</a>), the epidemic wave travels towards the other side. The value \( z \), which is defined in Eq.\eqref{eq:trav_para}, is used to plot the travelling wave measured at a specific point, in this case \( x=15 \). This travelling wave is shown in figure(<a href="#fig:1D_tw">15</a>).       

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 14:  <a name="fig:1D_sub"></a> The system (ref{eq:ord_diff_sys}. A gaussian curve with height 0.2 placed on the left side. This causes an epidemic wave controlled by the parameter \( \lambda=0.5 \). The size is measured at point \( x=15 \) and can be seen in figure (<a href="#fig:1D_tw">15</a>). </p></center>
<p><img src="2_fig/trav_wave_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 15:  <a name="fig:1D_tw"></a> This shows the travelling wave measures at at \( x=15 \) in figure(<a href="#fig:1D_sub">14</a>) </p></center>
<p><img src="2_fig/epidemic_wave_z_lambda_0_5.png" align="bottom" ></p>
</center>

<p>
<br />
The <em>Infective</em> group in Eq.\eqref{eq:ord_diff_sys} can be linearised when \( z\rightarrow \infty \). This leads to \( S\rightarrow 1 \) and \( I \rightarrow 0 \). The result then become 
$$
\begin{equation}
	I'' + cI' + I(S-\lambda) \approx 0 
\end{equation}
$$

This can be found by
$$
\begin{equation}
I(z) \propto \exp\left[(-c \pm {c^2 -4(1-\lambda)}^{1/2})z/2\right]
\end{equation}
$$

Since it is required that \( I(z)\rightarrow 0 \) and \( I(z) > 0 \), oscillations around 0 must be prevented. If a travelling wave exist, it has to satisfy
$$
\begin{equation}
	c \geq 2(1-\lambda)^{1/2}, \lambda < 1
\end{equation}
$$

If \( \lambda > 1 \), no travelling wave will exist. Then the disease will die out. The terms defined in Eq.\eqref{eq:constants_nondimensional} will give the threshold conditions,
$$
\begin{equation}
	\lambda = \frac{a}{rS_0} < 1
\end{equation}
$$

This is the same value that was given for the ODE model in the previously chapter.

<h2>Verifying the solution  <a name="___sec16"></a></h2>
To verify the implementation of the solution, a couple of tests can be done one the system in Eq.\eqref{eq:simple_non_PDE}. The system will be tested with a constant solution and a manufactured solution.

<h2>Constant solution  <a name="___sec17"></a></h2>
A constant solution uses preproduced constant values for the concentrations \( S \), \( I \) and \( R \). These can be replaced by \( S = C_s,I=C_i,R=C_r \). The value of \( C_i \) can only be 0 in Eq.\eqref{eq:simple_non_PDE}. This results in a poor test where several bugs can escape. The system can be expanded by adding a term \( \beta R \) to the <em>Susceptible</em> group and subtracting the same term from the <em>Removed</em> group. Then all three values can be tested. The system will then look like this: 
$$
\begin{equation} \label{eq:simple_non_PDE2}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \beta R + \frac{\partial^2 S}{\partial x^2},\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2},\\
	\frac{\partial R}{\partial t} &= \lambda I - \beta R + \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

By deriving Eq.\eqref{eq:simple_non_PDE2}, the following system Eq.\eqref{eq:constant_PDE} has to be solved
$$
\begin{equation} \label{eq:constant_PDE}
	\begin{aligned}
	C_iC_s &= \beta C_r \\
	C_iC_s &= \lambda C_i \\
	\lambda C_i &= -\beta C_r 
	\end{aligned}
\end{equation}
$$

The values \( \beta \) and \( \lambda \) are based on the constants \( C_s,C_i,C_r \), which can be chosen freely. Here they are set to \( C_s = 1.2,C_i=0.8,C_r=0.6 \). This results in \( \lambda= C_s = 1.2 \) and \( \beta= \frac{C_s C_i}{C_r}=1.6 \). A test is made in python and can be seen below.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_constant_solution</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Test problem where u=u_const is the exact solution, to be</span>
<span style="color: #BA2121; font-style: italic">    reproduced (to machine precision) by any relevant method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution</span>(t):
        <span style="color: #008000; font-weight: bold">return</span> C_s,C_i,C_r
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">lam</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> C_s

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">beta</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (C_s<span style="color: #666666">*</span>C_i)<span style="color: #666666">/</span><span style="color: #008000">float</span>(C_r)

    <span style="color: #408080; font-style: italic">#Constant values</span>
    C_s <span style="color: #666666">=</span> <span style="color: #666666">1.2</span>
    C_i <span style="color: #666666">=</span> <span style="color: #666666">0.8</span>
    C_r <span style="color: #666666">=</span> <span style="color: #666666">0.6</span>
    
    <span style="color: #408080; font-style: italic">#lam = C_s</span>
    <span style="color: #408080; font-style: italic">#beta = (lam*C_i)/float(C_r)</span>
    
    T <span style="color: #666666">=</span> <span style="color: #666666">2</span>; Nt <span style="color: #666666">=</span> <span style="color: #666666">200</span>
    X <span style="color: #666666">=</span> <span style="color: #666666">20</span>; Nx <span style="color: #666666">=</span> <span style="color: #666666">40</span>
    S_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_s
    I_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_i
    R_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(Nx<span style="color: #666666">+3</span>)<span style="color: #666666">*</span>C_r
    
    t,x,S,I,R <span style="color: #666666">=</span> simple_PDE(T,Nx,Nt,X,lam,beta,S_1,I_1,R_1)
    
    S_e,I_e,R_e <span style="color: #666666">=</span> exact_solution(t)
    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(S_e <span style="color: #666666">-</span> S)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I_e <span style="color: #666666">-</span> I)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    difference <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(R_e <span style="color: #666666">-</span> R)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol
</pre></div>
<p>
The test was run with no error, and the three constant values were produced correctly. This test is not good enough to qualify the program alone, however an error here would result in a large error in the program.

<h2>Manufactured solution  <a name="___sec18"></a></h2>
By constructing a function to each equation in the Eq.\eqref{eq:simple_non_PDE}, a manufactured solution can be created. Here \( S \),$I$ and \( R \) are pre produced. The system will be
$$
\begin{equation} \label{eq:simple_non_PDE2}
	\begin{aligned}
	\frac{\partial S}{\partial t} &= -IS + \frac{\partial^2 S}{\partial x^2}+f(x,t),\\
	\frac{\partial I}{\partial t} &= IS- \lambda I + \frac{\partial^2 I}{\partial x^2}+g(x,t),\\
	\frac{\partial R}{\partial t} &= \lambda I + \frac{\partial^2 R}{\partial x^2}+h(x,t),
	\end{aligned}
\end{equation}
$$

where \( f \),$g$ and \( h \) are functions to achieve the expected results for \( S \), \( I \) and \( R \). In this case the functions will be:
$$
\begin{equation}
	\begin{aligned}
	f(x,t) = \frac{\partial S}{\partial t} + IS - \frac{\partial^2 S}{\partial x^2}\\
	g(x,t) = \frac{\partial I}{\partial t} - IS + \lambda I - \frac{\partial^2 I}{\partial x^2}\\
	h(x,t) = \frac{\partial R}{\partial t} -\lambda I - \frac{\partial^2 R}{\partial x^2},
	\end{aligned}
\end{equation}
$$

When choosing the expected function for the groups, it is important that the boundary conditions from Eq.\eqref{eq:boundary_initial} is fulfilled.
$$
\begin{equation}
    u_x(0,t) = u_x(X,t) = 0
\end{equation}
$$

The quantities have been set to:
$$
\begin{equation}
	\begin{aligned}
    S(x,t) = cos(\frac{\pi}{X}x)t\\
    I(x,t) = cos(\frac{\pi}{X}x)t\\
    R(x,t) = cos(\frac{\pi}{X}x)t
	\end{aligned}
\end{equation}
$$

Now <code>sympy</code> can be used to do the calculations for the three functions \( f \), \( g \) and \( h \). The program can be seen in the Appendix. This results in the following equations seen in Eq.\eqref{eq:manu_func} 
$$
\begin{equation} \label{eq:manu_func}
	\begin{aligned}
	f(x,t) &= (t^2\cos(\frac{\pi}{X} x) + \frac{\pi}{X}^2t + 1)\cos(\frac{\pi}{X} x)\\
	g(x,t) &= (\lambda t - t^2\cos(\frac{\pi}{X} x) + \frac{\pi}{X}^2t + 1)\cos(\frac{\pi}{X} x)\\
	h(x,t) &= (-\lambda t + \frac{\pi}{X}^2t + 1)\cos(\frac{\pi}{X} x)
	\end{aligned}
\end{equation}
$$

A similar test made for the constant solution can be used here. While the constant test expected a difference on machine precision, this is not the case here. In this test, an expected convergence rate can be measured. The following manufactured test will be

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_manufactured_solution</span>(T,Nt,X,Nx):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Test problem where u=c*t+I is the exact solution, to be</span>
<span style="color: #BA2121; font-style: italic">    reproduced (to machine precision) by any relevant method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_S</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_I</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">exact_solution_R</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>t


    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">beta</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> exact_solution_S(t,x)<span style="color: #666666">*</span>exact_solution_I(t,x)<span style="color: #666666">/</span>exact_solution_R(t,x)
    lam <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (t<span style="color: #666666">**2*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) 

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (lam<span style="color: #666666">*</span>t <span style="color: #666666">-</span> t<span style="color: #666666">**2*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">h</span>(t,x):
        <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">-</span>lam<span style="color: #666666">*</span>t <span style="color: #666666">+</span> np<span style="color: #666666">.</span>pi<span style="color: #666666">**2*</span>t <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>cos(np<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>x)
        

    dx <span style="color: #666666">=</span> X<span style="color: #666666">/</span><span style="color: #008000">float</span>(Nx)
    dt <span style="color: #666666">=</span> T<span style="color: #666666">/</span><span style="color: #008000">float</span>(Nt)
    S_1 <span style="color: #666666">=</span> exact_solution_S(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
    I_1 <span style="color: #666666">=</span> exact_solution_I(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
    R_1 <span style="color: #666666">=</span> exact_solution_R(<span style="color: #666666">0</span>,np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0-</span>dx,X<span style="color: #666666">+</span>dx,Nx<span style="color: #666666">+3</span>))
     
    t,x,S,I,R <span style="color: #666666">=</span> simple_PDE(T,Nx,Nt,X,lam,beta,S_1,I_1,R_1,f,g,h)
    S_e <span style="color: #666666">=</span> exact_solution_S(t[<span style="color: #666666">-1</span>],x)
    I_e <span style="color: #666666">=</span> exact_solution_I(t[<span style="color: #666666">-1</span>],x)
    R_e <span style="color: #666666">=</span> exact_solution_R(t[<span style="color: #666666">-1</span>],x)
    
    difference_S <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(S_e <span style="color: #666666">-</span> S)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>

    
    <span style="color: #408080; font-style: italic">#for i in range(4):</span>
    <span style="color: #408080; font-style: italic">#    print &quot;n&quot;,i,&quot;S_e&quot;,exact_solution_S(t[i],x)</span>
    
    <span style="color: #408080; font-style: italic">#print &quot;S&quot;,S</span>
    <span style="color: #408080; font-style: italic">#t_tot = np.sum(t[:-1])</span>
    <span style="color: #408080; font-style: italic">#print &quot;t_tot&quot;,t_tot</span>
    <span style="color: #408080; font-style: italic">#difference_exp = t_tot*dt*np.cos(x*np.pi)*((2*(np.cos(np.pi*dx)-1))/dx**2+np.pi**2)</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff_exp&quot;, (abs(difference_exp)).max()</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;diff&quot;</span>,difference_S
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
    
    difference_I <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I_e <span style="color: #666666">-</span> I)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff&quot;,difference_I</span>
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
   
    difference_R <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(R_e <span style="color: #666666">-</span> R)<span style="color: #666666">.</span>max()  <span style="color: #408080; font-style: italic"># max deviation</span>
    <span style="color: #408080; font-style: italic">#print &quot;diff&quot;,difference_R</span>
    <span style="color: #408080; font-style: italic">#tol = 1E-14</span>
    <span style="color: #408080; font-style: italic">#assert difference &lt; tol</span>
    <span style="color: #008000; font-weight: bold">return</span> difference_S,difference_I,difference_R
</pre></div>

<h2>Convergence rate  <a name="___sec19"></a></h2>
The program can be controlled by checking the convergence rate. The error term  for this equation can be described as  
$$
\begin{equation} \label{eq:error}
    \epsilon = C_x\Delta x^2 + C_t \Delta t
\end{equation}
$$

With Eq.\eqref{eq:error}, the expected convergence rate can be found for both \( \Delta x \) and \( \Delta t \). To be able to separate the $\Delta$s, the other value has to be close to eliminated. To study the value \( \Delta x \), the following term has to be fullfilled: \( \Delta t \ll \Delta x \). This will lead to \( C_t\Delta t \approx 0 \), and the error term for \( \Delta x \) can be found. The opposite thing can  be done for \( \Delta t \). A table for the error is produced for different values for \( \Delta t = 0.05 \) and \( \Delta x=0.1 \).

<p>
<a name="table:error_numbers"></a>
<table border="1">
<thead>
<tr><th align="center">                         </th> <td align="center">\( \Delta x \)</td> <td align="center">\( \frac{\Delta x}{2} \)</td> <td align="center">\( \frac{\Delta x}{4} \)</td> <td align="center">\( \frac{\Delta x}{8} \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   \( \Delta t      \)          </td> <td align="center">   9.9E-3            </td> <td align="center">   -                           </td> <td align="center">   -                           </td> <td align="center">   -                           </td> </tr>
<tr><td align="center">   \( \frac{\Delta t}{4}  \)    </td> <td align="center">   9.9E-3            </td> <td align="center">   2.5E-3                      </td> <td align="center">   -                           </td> <td align="center">   -                           </td> </tr>
<tr><td align="center">   \( \frac{\Delta t}{8}  \)    </td> <td align="center">   9.9E-3            </td> <td align="center">   2.5E-3                      </td> <td align="center">   6.1E-4                      </td> <td align="center">   -                           </td> </tr>
<tr><td align="center">   \( \frac{\Delta t}{16} \)    </td> <td align="center">   9.9E-3            </td> <td align="center">   2.5E-3                      </td> <td align="center">   6.1E-4                      </td> <td align="center">   1.5E-4                      </td> </tr>
</tbody>
</table>
<!-- 0.00988006143376,0.00246039081619,-,- -->
<!-- 0.00988361769746,0.00246127510994,0.000614719954035 -->
<!-- 0.00988450717896,0.00246149628689,0.000614775174047,0.000153656409034 -->

<h2>The spatial error  <a name="___sec20"></a></h2>
The Tab.(<a href="#table:error_numbers">table:error_numbers</a>) gives information about the error when \( \Delta t \) and \( \Delta x \) are reduced. By studying the row where \( \Delta t/16 \), the \( C_t \Delta t \) can be seen as close to negligible in Eq.\eqref{eq:error}. The error can be expressed 
$$
\begin{equation}
    \epsilon \propto \Delta x^r
\end{equation}
$$

The value is expected to be \( r=2 \), since Crank Nicolson is used in the spatial discretization. By comparing the error for different \( \Delta x \), the convergence rate, \( r \), can be expressed, 
$$
\begin{equation} \label{eq:conv_rate}
 r_{12} \simeq \frac{\log(\epsilon_1/\epsilon_2)}{\log(\Delta x_1/\Delta x_2)}
\end{equation}
$$

Since the table above has four different error values, these can be used to give three different convergence rates. \( \Delta x_1 = \Delta x, \Delta x_2 = \Delta x/2... \). The same notation has been used for the different error values, \( \epsilon \).
<table border="1">
<thead>
<tr><th align="center"> </th> <td align="center">\( \epsilon_1/\epsilon_2 \)</td> <td align="center">\( \epsilon_2/\epsilon_3 \)</td> <td align="center">\( \epsilon_3/\epsilon_4 \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   r    </td> <td align="center">   2.0056                         </td> <td align="center">   2.0014                         </td> <td align="center">   2.0004                         </td> </tr>
</tbody>
</table>
<p>
Here the rate goes towards 2, and a 2.order convergence rate seems to be fulfilled.

<h2>The temporal error  <a name="___sec21"></a></h2>
The temporal error is hard to find since the <em>Stability criteria</em> expects \( \Delta t \) to fulfill the criteria in Eq.\eqref{eq:stability_cr} to avoid oscillations.
$$
\begin{equation} \label{eq:stability_cr}
 \Delta t \leq \frac{\Delta x^2}{2}
\end{equation}
$$

As a result, \( \Delta x \ll \Delta t \) is impossible, because this only leads to an unstable solution. By looking at the column for \( \frac{\Delta x}{8} \), the only stable solution is for \( \frac{\Delta t}{16} \). Therefore the technique used for the spatial error cannot be used here. By studying the diagonal numbers in the table, the expected convergence rate is fulfilled for both \( \Delta x \), which gives \( r = 2 \) and for \( \Delta t \), which gives \( r=1 \)

<h2>Travelling wave in 2D  <a name="___sec22"></a></h2>
The Eq.\eqref{eq:simple_non_PDE} can be discretized for a 2D area. This is more realistic when simulating a geographic spread of an epidemic disease. The non dimensional system  can be discretized with Forward Euler in time and Crank Nicolson in space
$$
\begin{equation} \label{eq:SIR_disc}
	\begin{aligned}
    \frac{S^{n+1}_{i,j}-S^n_{i,j}}{\Delta t} &= -I^{n}_{i,j}S^{n}_{i,j} + \left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{I^{n+1}_{i,j}-I^n_{i,j}}{\Delta t} &= I^{n}_{i,j}S^{n}_{i,j} -\lambda I^{n}_{i,j} + \left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{R^{n+1}_{i,j}-R^n_{i,j}}{\Delta t} &= \lambda I^{n}_{i,j}+\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right) 
	\end{aligned}
\end{equation}
$$

The known values can be placed on the right side. The system will then be
$$
\begin{equation}
	\begin{aligned}
    S^{n+1}_{i,j} &= S^{n}_{i,j}+\Delta t\left(-I^{n}_{i,j}S^{n}_{i,j} + \left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right)\right) \\
    I^{n+1}_{i,j} &= I^{n}_{i,j}+\Delta t\left(I^{n}_{i,j}S^{n}_{i,j} -\lambda I^{n}_{i,j} + \left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right)\right) \\
    R^{n+1}_{i,j} &= R^{n}_{i,j}+\Delta t\left(\lambda I^{n}_{i,j}+\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right)\right) 
	\end{aligned}
\end{equation}
$$

This results in an explicit system, which is easy to code. It consists of known values on the right side and only one unknown value on the left side.

<h2>A gaussian wave  <a name="___sec23"></a></h2>
In the PDE system for the 1D equation, a Gaussian quantity of infected humans was placed on the left side in the initial value. This resulted in a wave of <em>Infected</em> spreading along the x-axis. A similar procedure can be done for the 2D simulation. A couple of simulations have been produced for the 2D system. The first simulation is calculated with a Gaussian function along the points(0,y) for the <em>Infected</em> group at initial time. The second simulation has placed the Gaussian function at point(0,0) for the <em>Infected</em> group at initial value. Both simulations can be seen in the Appendix.  
<br />
<br />
The size of the epidemic wave can be measured and compared by studying the travelling wave at a certain point. In these two 2D simulations in Fig.(<a href="#fig:2D_trav_wave">16</a>), the wave are measured in the point (15,15), while the travelling wave in the 1D simulation was measured at point(15). 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 16:  <a name="fig:2D_trav_wave"></a> Travelling wave measured at point (15,15) with two different initial values for the <em>Infected</em> group. I:The initial value is set as a Gaussian line along (0,y).II:The initial value is set as a Gaussian point (0,0). </p></center>
<p><img src="2_fig/Trav_wave_2D.png" align="bottom" height=400 width=800></p>
</center>

<p>
<br />
<br />
The shapes of the two travelling waves in Fig.(<a href="#fig:2D_trav_wave">16</a>) are similar. The only difference is the time when the wave occurs. The plot for 1D wave in Fig.(<a href="#fig:1D_tw">15</a>) has the same shape. With a closer study, the area under the function can be measured in all three cases. The result can be seen in Tab.(<a href="#table:wave_values">table:wave_values</a>)   

<p>
<!-- 1D -->
<!-- 1.4340793845 -->
<!-- 1.43143259034 dt = \( 1\cdot10^{-3} \), dx = 0.05 -->
<!-- 1.43195870243 dt = 0.0002, dx^2 = 0.000625 -->
<!-- 2D wave line: -->
<!-- 1.43345609926 dt =0.0004, dx^2 =  0.0016 -->
<!-- 2D wave point: -->
<!-- 1.43352971688 -->

<p>
<a name="table:wave_values"></a>
<table border="1">
<thead>
<tr><th align="center">1D wave</th> <th align="center">2D wave line</th> <th align="center">2D wave point</th> </tr>
</thead>
<tbody>
<tr><td align="center">   1.43       </td> <td align="center">   1.43            </td> <td align="center">   1.43             </td> </tr>
</tbody>
</table>
<p>
The area in all three simulations approach the same area when \( \Delta t \) and \( \Delta x \) are reduced. The size and shape will not change by  expanding the system from 1D to 2D. However, by studying Fig.(<a href="#fig:2D_trav_wave">16</a>), one can see that the wave occurs at different times. This is caused by the distance from the start position for the Gaussian wave. The first subplot that starts with a Gaussian function along the \( x=0 \) axis gets a wave from the <em>Infected</em> group that flows along the x axis. This can be seen as a wave on the beach. Everyone that have the same distance from the ocean will be hit simultaneously. The travelling wave for the 1D simulation and the first subplot occurs at the same time, because they are measured at the same distance from the starting point. The last plot is also measured at (15,15), but occurs later. Since the wave starts at point (0,0), the distance to (15,15) is 21.21. This means that the wave will reach the point 6.21 time steps later. This is a reasonable conclusion based on the plot.

<h3>Change in initial flow  <a name="___sec24"></a></h3>

By increasing the initial wave of the <em>Infected</em> group, the initial value of <em>Infected</em> can be studied. The simulation is run with the same parameters as for the three simulations above and the only difference is the initial value for the <em>Infected</em> group. The Gaussian wave of <em>Infected</em> is placed at point(0,0) as for subplot II in Fig.(<a href="#fig:2D_trav_wave">16</a>). The simulation can be seen in Fig.(<a href="#fig:initial_value">17</a>).  
<!-- Volume ordinary = 0.3141592653589793 -->
<!-- Volume extreme = 157.07963267948966 -->
<!-- Volume under graph 1.43345609926 -->

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 17:  <a name="fig:initial_value"></a> A major flow of <em>Infected</em> spread outwards in the field. After a certain time, the wave has passed the area and the number in each group stabilized. </p></center>
<p><img src="2_fig/2D_initial_variable_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
The size and shape can be compared by measuring the travelling wave at point(15,15). The travelling wave for this simulation can be seen in Fig.(<a href="#fig:initial_trav_wave">18</a>) and the area for the travelling wave is measured to 1.43, which is similar to the three other simulations.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 18:  <a name="fig:initial_trav_wave"></a> The travelling wave with a major increase of <em>Infected</em> at the initial time. </p></center>
<p><img src="2_fig/TW_2D_initial_z_lambda_0_5.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
The size of the travelling  wave will not be affected by changing the value of the <em>Infected</em> group. However there is a difference in the time when the wave occurs. In the simulation where the initial value is higher, the travelling wave reaches the measuring point (15,15) earlier. This can be explained by the idea of a ball dropped from a large height. If the ball is released or thrown to the ground, it will only affect the acceleration of the ball, not the terminal velocity. After a certain time the released ball and the thrown ball will reach the same maximum speed. This is the case for the speed of the travelling wave.

<h3>Change in lambda  <a name="___sec25"></a></h3>

The one thing that affects the speed and size, is the \( \lambda \) variable in the PDE system\eqref{eq:simple_non_PDE}. This \( \lambda \) is a combination of \( a \), which controls deaths among the <em>Infected</em> group, \( r \), which controls the number from the <em>Susceptible</em> group that gets infected in meetings between the <em>Infected</em> and <em>Susceptible</em> groups. The last parameter in \( \lambda \) is the concentration of Susceptible, \( S_0 \). By changing this parameter, the travelling wave will change in both size and shape. In Fig.(<a href="#fig:change_lambda">19</a>), the simulation is run with four different values of \( \lambda \).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 19:  <a name="fig:change_lambda"></a> The travelling wave simulated with \( \lambda \) values in the range of 0.01 to 1. </p></center>
<p><img src="2_fig/2D_lambda_variable.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
To understand the results in Fig.(<a href="#fig:change_lambda">19</a>), the \( \lambda  \) function can be studied,
$$
\begin{equation} \label{eq:lambda}
 \lambda =\frac{a}{rS_0},
\end{equation}
$$

A major and aggressive travelling wave is caused when \( \lambda \rightarrow 0 \). In Fig.(<a href="#fig:change_lambda">19</a>), \( \lambda \) is run with value 0.01 in the first subplot. This results in a travelling wave of <em>Infected</em> that eradicates the <em>Susceptible</em> group in a short time. The wave starts decreasing when all <em>Susceptible</em> are infected. By looking at Eq.\eqref{eq:lambda},one can see that a small value is caused by a small \( a \) compared to \( r \) and \( S_0 \). If \( a \) is low, this results in few deaths/immune in the <em>Infected</em> group. This means that the <em>Infected</em> group will grow and be able to infect even more humans from the <em>Susceptible</em> group. The same thing will happen if \( r \) is large. A result of a large \( r \) will be an aggressive disease that infects  a major part of the population. The same result will happen if \( S_0 \) is large. Then there are several possible humans to infect. Therefore an outburst of a disease is more critical in a crowded city than in the wilderness, far from other humans.
<br />
<br />
If \( \lambda \) increases above 1, the disease will not be able to spread. The number of <em>Infected</em> will decrease, since the number in the <em>Removed</em> group caused by the <em>Infected</em> group is higher than the amount of <em>Infected</em> humans from the <em>Susceptible</em> group. After a certain time, the number of <em>Infected</em> will die out. If \( \lambda \) stays at 1, the number of <em>Infected</em> will be equal the whole time.

<h1>English Boarding School  <a name="___sec26"></a></h1>
An example from an English boarding school was presented in the previously chapter <em>Epidemic models</em> . This example was based on the book from J.D Murray <a href="#murray2002mathematical">[1]</a>, and was modeled for an ODE system. A similar result should appear for the PDE system with the same parameter values and a uniform distribution of the groups. The school had 763 students, and one of the students brought a disease back to the school. The following numbers were used for the ODE system in chapter one. \( N=763, S_0=762,I_0=1,R_0=0,\rho=202 \) and \( r = 2.18\cdot 10^{-3} \). 
<br />
<br />
The first simulation is produced with uniform distributed concentration, This is done to verify the implementation. A person is defined as one cubic. The total volume of the whole group is spread over the area. The area is set to be 100 m x 100 m, which results in an average height of \( 1/10000 \) m per person. This is done to get a uniformed distribution. This would of course be more difficult in real life, particularly if the person would be alive. Since the <em>Infected</em> group only consists of one person, the total height will be 0.0001 for the whole area. The <em>Susceptible</em> group consists of 762 students and the total height at each point will be 0.0762 The simulation can be seen in the Appendix. 
<br />
<br />
The results from subplot I in Fig.(<a href="#fig:british_number">20</a>) are equal to the results from the ODE system modeled in the previously chapter.This can be seen in Tab.(<a href="#table:british_number_table">table:british_number_table</a>). This is as expected, since the diffusion term is negligible in this system. The simulation results in a group of separate ODE systems modeled over an area.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 20:  <a name="fig:british_number"></a> English Boarding School modeled with three different initial values for the infected student. The amount of students in each group modeled over 15 days. Subplot 1: uniform distribution. Subplot 2: The student is placed as a Gaussian function in center. Subplot 3: The student is placed as a Gaussian function in the corner (0,0). </p></center>
<p><img src="2_fig/british_number.png" align="bottom" height=600 width=300></p>
</center>

<h2>Maximum concentration of <em>Infected</em>  <a name="___sec27"></a></h2>
The maximum concentration of the <em>Infected</em> group was found for the ODE system in the previous chapter. The expected value of \( \Imax \) was first calculated, and later verified with the numberical solution of the ODE system. The reproduction rate found for the PDE system in Eq.\eqref{reproduction_rate_PDF} was given by the same parameters as for the ODE system. A similar maximum value is expected from the PDE solution. The maximum value for the <em>Infected</em> array is \( \Imax=292 \) and is similar to the \( \Imax \) for the ODE solution. 

<p>
A table with the values from the three simulations performed for this English boarding school are compared to ODE system from the previous chapter.

<p>
<a name="table:british_number_table"></a>
<table border="1">
<thead>
<tr><th align="center">           </th> <th align="center"> ODE system</th> <th align="center">  PDE uniform dist </th> <th align="center"> PDE center</th> <th align="center"> PDE corner</th> </tr>
</thead>
<tbody>
<tr><td align="center">   5 Days         </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -----------    </td> <td align="center">   -----------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   444.62         </td> <td align="center">   444.62                 </td> <td align="center">   748.03         </td> <td align="center">   757.33         </td> </tr>
<tr><td align="center">   Infective      </td> <td align="center">   209.56         </td> <td align="center">   209.56                 </td> <td align="center">   7.36           </td> <td align="center">   2.35           </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   108.82         </td> <td align="center">   108.82                 </td> <td align="center">   7.60           </td> <td align="center">   3.32           </td> </tr>
<tr><td align="center">   10 Days        </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -----------    </td> <td align="center">   -----------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   37.59          </td> <td align="center">   37.59                  </td> <td align="center">   697.71         </td> <td align="center">   743.58         </td> </tr>
<tr><td align="center">   Infective      </td> <td align="center">   117.59         </td> <td align="center">   117.59                 </td> <td align="center">   24.43          </td> <td align="center">   6.66           </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   607.82         </td> <td align="center">   607.82                 </td> <td align="center">   40.86          </td> <td align="center">   12.76          </td> </tr>
<tr><td align="center">   15 Days        </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -----------    </td> <td align="center">   -----------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   21.09          </td> <td align="center">   21.09                  </td> <td align="center">   597.01         </td> <td align="center">   717.02         </td> </tr>
<tr><td align="center">   Infective      </td> <td align="center">   17.30          </td> <td align="center">   17.30                  </td> <td align="center">   46.96          </td> <td align="center">   12.37          </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   724.62         </td> <td align="center">   724.62                 </td> <td align="center">   119.03         </td> <td align="center">   33.61          </td> </tr>
</tbody>
</table>
<!-- dx = 0.04 -->
<!-- dx^2 = 1.6E-3 -->
<!-- ODE = 1.5E-4 -->

<h2>Introducing a Gaussian distribution of infected  <a name="___sec28"></a></h2>
An assumption one can make is that a person is not able to be evenly distributed over an area. In this example, with only one infected student at initial time, the chance of being infected increases the closer the <em>Susceptible</em> group gets the infected student. The student is represented by a Gaussian function in the middle of the school yard, to see if the position affects the result. The height is set to 1 and the volume of the Gauss function is set to 1 cubic. The simulation can be seen in Fig.(<a href="#fig:gauss_sub">21</a>) and the total amount of students in each group can be be seen in Fig.(<a href="#fig:british_number">20</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 21:  <a name="fig:gauss_sub"></a> The infected student is placed in the center as a Gaussian function at initial time. The height of the Gaussian function is set to 1 m and volume is set to 1 cubic. </p></center>
<p><img src="2_fig/2D_british_school_gauss_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
The results from the uniform distributed and Gaussian distributed simulations show various results. The initial position of the <em>Infected</em> group is the difference between the simulations. This has a major impact. Since the only ones that can be infected by the Gaussian distribution are the students close to the infected student, this restricts the spread of the epidemic. The chance of getting infected in this area is higher. The Fig.(<a href="#fig:gauss_sub">21</a>) shows that the amount of <em>Infective</em> quickly grows in the center, where the infected was placed. Subplot IV in Fig.(<a href="#fig:gauss_sub">21</a>) shows that the amount from the <em>Removed</em> group in the center is close to the maximum of the initial value of <em>Susceptible</em>, while the students along the boundary of the schoolyard seem to be unaffected after 15 days. This simulation shows that the position of the <em>Infected</em> group has a major role in the simulation.
<br />
<br />
The position of the <em>Infected</em> group, here as a Gaussian function, also affects the outcome. Subplot III in Fig.(<a href="#fig:british_number">20</a>) describes a simulation where the Gaussian function is placed in the corner with position(0,0). The total volume of the function is increased to 4 since only a quarter of the function is placed in the area. Tab.(<a href="#table:british_number_table">table:british_number_table</a>) shows that the total number of <em>Infected</em> is lower than for the centered placed Gaussian function. The infected student is only able to spread the disease to a quarter of the population compared to the infected student in the center. The simulation can be seen in the Appendix.
<br />
<br />
If the simulations are run for a long time, the difference between each group will decrease. After 100 days there will be about 18 students in the <em>Susceptible</em> group in the uniform distributed simulation, compared to 25 students in both of the Gaussian simulations. The simulations can be seen in the Appendix.

<p>
<!-- !split -->

<h1>Zombiefication  <a name="___sec29"></a></h1>
The previous chapter studied an ODE system designed to calculate the number in the four groups: <em>Susceptible</em>, <em>Infected</em>, <em>Zombie</em> and <em>Removed</em> during the five first episodes in the TV series <em>Walking Dead</em> Ref.<a href="#walking_dead">[7]</a>. The model was based on the model from Langtangen, Mardal and R&#248;tnes Ref.<a href="#zombie-math">[6]</a>, with an extra term in the <em>counter attack</em> phase. The ODE system from the chapter <em>Epidemic models</em> can be expanded with a diffusion term in each group to make a PDE system. This can be seen in Eq.\eqref{eq:seland_model_PDE}  
$$
\begin{equation} \label{eq:seland_model_PDE}
	\begin{aligned} 
	\frac{\partial S}{\partial t} &= \Sigma -(\beta+\mu \omega(t))SZ - \delta_SS +D_s\nabla^2 S \\
	\frac{\partial I}{\partial t} &= (\beta+\mu \omega(t))SZ - \varrho I - \delta_II+D_i\nabla^2 I \\
	\frac{\partial Z}{\partial t} &= \varrho I- (\alpha+\omega(t))SZ + \zeta R+D_z\nabla^2 Z \\
	\frac{\partial R}{\partial t} &= \delta_SS +\delta_II -\zeta R + (\alpha+\omega(t))SZ+D_r\nabla^2 R 
	\end{aligned}
\end{equation}
$$

The Eq.\eqref{eq:seland_model_PDE} can be solved numerically by discretization. Forward Euler is used for the time derivative and Crank Nicolson for the space derivative. This is solved with the same technique as for the SIR model\eqref{eq:SIR_disc}. The system can be seen in Eq.\eqref{eq:SIZR_disc}
$$
\begin{equation} \label{eq:SIZR_disc}
	\begin{aligned}
    \frac{S^{n+1}_{i,j}-S^n_{i,j}}{\Delta t} &= \Sigma - (\beta+\mu \omega(t))S^{n}_{i,j}Z^{n}_{i,j}- \delta_S S^{n}_{i,j} \\
        &+D_s\left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{I^{n+1}_{i,j}-I^n_{i,j}}{\Delta t} &= (\beta+\mu \omega(t))S^{n}_{i,j}Z^{n}_{i,j}-\varrho I^{n}_{i,j}- \delta_I I^{n}_{i,j} \\
        &+D_i\left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{Z^{n+1}_{i,j}-Z^n_{i,j}}{\Delta t} &= \varrho I^{n}_{i,j}-(\alpha+\omega(t))S^{n}_{i,j}Z^{n}_{i,j}+ \zeta R^{n}_{i,j} \\
        &+D_z\left(\frac{Z^{n}_{i-1,j}-2Z^{n}_{i,j}+Z^{n}_{i+1,j}}{\Delta x^2}+\frac{Z^{n}_{i,j-1}-2Z^{n}_{i,j}+Z^{n}_{i,j+1}}{\Delta y^2}\right) \\
    \frac{R^{n+1}_{i,j}-R^n_{i,j}}{\Delta t} &= \delta_S S^{n}_{i,j}+\delta_I I^{n}_{i,j}-\zeta R^{n}_{i,j}+(\alpha+\omega(t))S^{n}_{i,j}Z^{n}_{i,j} \\
        &+D_r\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right) 
	\end{aligned}
\end{equation}
$$

By setting the unknown to the left, the following system \eqref{eq:SIZR_disc2} can be solved: 
$$
\begin{equation} \label{eq:SIZR_disc2}
	\begin{aligned}
    S^{n+1}_{i,j} &= S^n_{i,j} + \Delta t \Bigl( \Sigma - (\beta+\mu \omega(t))S^{n}_{i,j}Z^{n}_{i,j}- \delta_S S^{n}_{i,j} \\
        &+ D_s\left(\frac{S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j}}{\Delta x^2}+\frac{S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1}}{\Delta y^2}\right)\Bigr) \\
    I^{n+1}_{i,j} &= I^n_{i,j} + \Delta t \Bigl((\beta+\mu \omega(t))S^{n}_{i,j}Z^{n}_{i,j}-\varrho I^{n}_{i,j}- \delta_I I^{n}_{i,j} \\
        &+ D_i\left(\frac{I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j}}{\Delta x^2}+\frac{I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1}}{\Delta y^2}\right)\Bigr) \\ 
    Z^{n+1}_{i,j} &= Z^n_{i,j} +\Delta t \Bigl( \varrho I^{n}_{i,j}-(\alpha+\omega(t))S^{n}_{i,j}Z^{n}_{i,j}+ \zeta R^{n}_{i,j} \\
        &+D_z\left(\frac{Z^{n}_{i-1,j}-2Z^{n}_{i,j}+Z^{n}_{i+1,j}}{\Delta x^2}+\frac{Z^{n}_{i,j-1}-2Z^{n}_{i,j}+Z^{n}_{i,j+1}}{\Delta y^2}\right)\Bigr) \\
    R^{n+1}_{i,j} &= R^n_{i,j} +\Delta t \Bigl(\delta_S S^{n}_{i,j}+\delta_I I^{n}_{i,j}-\zeta R^{n}_{i,j}+(\alpha+\omega(t))S^{n}_{i,j}Z^{n}_{i,j} \\
        &+D_r\left(\frac{R^{n}_{i-1,j}-2R^{n}_{i,j}+R^{n}_{i+1,j}}{\Delta x^2}+\frac{R^{n}_{i,j-1}-2R^{n}_{i,j}+R^{n}_{i,j+1}}{\Delta y^2}\right)\Bigr) 
	\end{aligned}
\end{equation}
$$

A simulation with uniform distributed groups can be done to verify the implementation of the system. The result is expected to be similar to the ODE system in the previous chapter. A zombie attack can be separated into three different phases, based on the paper from Langtangen, Mardal and R&#248;tnes <a href="#zombie-math">[6]</a>. The first phase is short, and it is called the <em>Initial phase</em>. The humans are unfamiliar with the disease in this phase and are as a consequence quite naive to the disease. This result in a high chance of getting infected. The next phase is called the <em>Hysterical phase</em>. The humans are now more familiar with the situation and try to avoid the <em>Infected</em> group. This result in a lower chance of getting infected. The last phase, which happens at the same time as the <em>Hysterical phase</em>, is the <em>Counter attack</em>. This phase is often initiated when humans are attacked by zombies. The following parameters that were used for simulating the first episodes of <em>Walking Dead</em> will be used here. These can be seen in Tab.(<a href="#table:param_val">table:param_val</a>). By computing the system for all three phases, the value in each phase can be compared to the ones from the ODE system. This will give an indication of whether the discretization is done correct. 

<p>
<a name="table:param_val"></a>
<table border="1">
<thead>
<tr><th align="center">  parameter  </th> <th align="center">Initial phase</th> <th align="center">hysterical phase</th> <th align="center">counter attack</th> </tr>
</thead>
<tbody>
<tr><td align="center">   \( \beta \)      </td> <td align="center">   0.01155          </td> <td align="center">   0.000011            </td> <td align="center">   0.00011           </td> </tr>
<tr><td align="center">   \( \varrho \)    </td> <td align="center">   1.37             </td> <td align="center">   1.5                 </td> <td align="center">   1.5               </td> </tr>
<tr><td align="center">   \( \alpha \)     </td> <td align="center">   0.00044          </td> <td align="center">   0.000208            </td> <td align="center">   0.000208          </td> </tr>
<tr><td align="center">   a                </td> <td align="center">   0                </td> <td align="center">   0                   </td> <td align="center">   0.0073            </td> </tr>
<tr><td align="center">   \( \sigma \)     </td> <td align="center">   0                </td> <td align="center">   0                   </td> <td align="center">   0.005             </td> </tr>
<tr><td align="center">   \( \mu \)        </td> <td align="center">   0                </td> <td align="center">   0                   </td> <td align="center">   0.14              </td> </tr>
</tbody>
</table>
<p>
The simulation in Fig.(<a href="#fig:zombie_three_number">22</a>) seems to match the results from the ODE system. A closer check can be done by comparing the groups in each phase. This result can be seen in Tab.(<a href="#table:compare_phases_zombie">table:compare_phases_zombie</a>) 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 22:  <a name="fig:zombie_three_number"></a> The Eq.\eqref{eq:SIZR_disc2} modeled with uniformed distributed groups. Initial values S_0 = 621,I_0 = 0, Z_0 = 0 R_0 = 0 with parameters from (<a href="#table:param_val">table:param_val</a>). </p></center>
<p><img src="2_fig/2D_zombie_three_phases_number.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
The initial values for the four groups are set to \( S_0=621 \), \( I_0=0 \), \( Z_0=1 \) and \( R_0= 0 \) in all simulations. The values in Tab.(<a href="#table:compare_phases_zombie">table:compare_phases_zombie</a>) are measured at the final time for each phase. The <em>Initial phase</em> lasts for three days and the values are measured at \( time=3 \). The <em>Hysterical phase</em> is a continuous phase, and will not stop until an eventual eradication. The values are therefore given before the <em>Counter attack</em> at \( time=33 \). The <em>Counter attack</em> lasts for some hours, and is measured at \( time=34 \), which is a day after the attack. The value of \( \Delta t \) is set to 1E-3. 

<p>
<a name="table:compare_phases_zombie"></a>
<table border="1">
<thead>
<tr><th align="center">                </th> <th align="center"> ODE system</th> <th align="center">  PDE uniform dist </th> <th align="center">  PDE gauss center </th> </tr>
</thead>
<tbody>
<tr><td align="center">   Initial phase       </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   71.3           </td> <td align="center">   71.3                   </td> <td align="center">   81.12                  </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   230.8          </td> <td align="center">   230.8                  </td> <td align="center">   210.94                 </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   298.9          </td> <td align="center">   298.9                  </td> <td align="center">   310.11                 </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   21.0           </td> <td align="center">   21.0                   </td> <td align="center">   20.60                  </td> </tr>
<tr><td align="center">   Hysterical phase    </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   61.6           </td> <td align="center">   61.6                   </td> <td align="center">   70.55                  </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   0.3            </td> <td align="center">   0.3                    </td> <td align="center">   0.34                   </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   358.6          </td> <td align="center">   355.6                  </td> <td align="center">   334.33                 </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   201.5          </td> <td align="center">   201.5                  </td> <td align="center">   217.56                 </td> </tr>
<tr><td align="center">   Counter attack      </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   57.8           </td> <td align="center">   57.8                   </td> <td align="center">   66.50                  </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   1.2            </td> <td align="center">   1.2                    </td> <td align="center">   1.23                   </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   331.8          </td> <td align="center">   331.8                  </td> <td align="center">   305.86                 </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   231.3          </td> <td align="center">   231.3                  </td> <td align="center">   249.19                 </td> </tr>
</tbody>
</table>
<p>
These results shows that the PDE system gives the same results as the ODE system.

<p>
<!-- # -->
<!-- # -->
<!-- # -->
<!-- # -->

<h2>The position of the <em>Infected</em> group  <a name="___sec30"></a></h2>
In the previous section, <em>English boarding school</em>, the location of the <em>Infected</em> group was proven to have a major influence on the result. However here the <em>Susceptible</em> group was uniformly distributed over the schoolyard. The number in each group, based on the study of <em>Walking Dead</em>, was seen in three different locations in the TV series. By only studying the TV series, it is hard to decide the geographical distance between these three locations. Therefore they have been placed with a certain distance from each other. The following simulations are done on a grid with size(40 x 40) with the following positions for the towns: Small town(6,6) with size 21, middle town(12,25) with size 200 and large town(25,12) with size 400. Since these values were based on the humans and zombies seen in the series, these can be scaled up by 1000 to correspond a realistic population. A large town can be seen as an area with a population of 400 000. The length can be measured in kilometres. Then the distance between the middle and large town will be 18.38 km. Compared to the distance between Oslo and B&#230;rum(Sandvika) which is 15 km, the simulation can be seen as a rough estimate of the area around Oslo, if the fjord is frozen and the mobility for the area is similar.
<br />
<br />
The diffusion term describes the diffusion for each group. This can be seen as the speed towards equilibrium for each group. If the diffusion constant is large, the flow towards equilibrium will go faster. The values have been set as follows. 

<ul>
<li> \( D_s=1 \), The <em>Susceptible</em> has a basic moving speed. The other groups are based on the speed of a healthy human.</li>
<li> \( D_i=0.5 \), The <em>Infected</em> are often injured caused by recent fights. This affects their mobility.</li>
<li> \( D_z=0.9 \), The average moving speed for a zombie. There are zombies with the mobility of a human, but there are also zombies that drag themselves forward with only one arm. This results in a major difference in speed and therefore a lower average speed for the zombies.</li>
<li> \( D_r=0 \), The removed are here seen as dead, therefore there is no mobility.</li>
</ul>

<br />
<br />
The parameters from Tab.(<a href="#table:param_val">table:param_val</a>) will be used here, and the three phases will be modeled as shown for the uniformed distributed PDE system. The values will be used for three different simulations with the similar initial value for the different groups. The position of initial values can be seen in Fig.(<a href="#fig:initial_value_susceptible">23</a>) and are based on the data given for each town above. The difference in the three simulations will be the position of the zombie at initial time. The zombie will be placed in center of the small, middle and large town.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 23:  <a name="fig:initial_value_susceptible"></a> The initial value for the <em>Susceptible</em> group for three simulations. Small group(6,6) with volume 21, middle group(12,25) with volume 200 and large group(25,12) with volume 400. All three groups are build up with a Gaussian function. </p></center>
<p><img src="2_fig/initial_value_susceptible.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
Fig.(<a href="#fig:large_town">24</a>) shows the simulation where the zombie is placed in the large town. The simulations of the small and middle town can be seen in the Appendix. The four subplots are from the different phases that arise during a zombie attack. The different groups have the same color as introduced in Fig.(<a href="#fig:zombie_three_number">22</a>). It is difficult to separate the three groups <em>Infected</em>, <em>Zombie</em> and <em>Removed</em>, since they all have a low value at initial time. The development of the amount can easier be seen in the Fig.(<a href="#fig:compare_towns">25</a>), which also shows the results from the small and middle town. Since the amount of <em>Susceptible</em> is quite low in the small town where the zombie arises, the disease is not able to infect too many before the society has moved to the next phase, assuming that the broadcasting about the disease works okay for the first days. This results in an eradication of the disease in about a month. The table(<a href="#table:compare_phases_zombie">table:compare_phases_zombie</a>) shows that the number of zombies decreases towards zero after a month. 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 24:  <a name="fig:large_town"></a> <em>Walking Dead</em> simulated with the zombie at initial time in the large town. Subplots shown at each phase. </p></center>
<p><img src="2_fig/2D_zombie_three_phases_zombie_large_town_2_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
By placing the zombie in the middle town, the amount in the <em>Zombie</em> group increases to a higher level. The amount can be seen as subplot II in Fig.(<a href="#fig:compare_towns">25</a>). The damages are higher, and after a month the total population of <em>Susceptible</em> is reduced to 427. The last calculation done for the large town in Fig.(<a href="#fig:large_town">24</a>) shows major damages. Here the amount in the <em>Zombie</em> group increases above the number of <em>Susceptible</em>. The <em>Infected</em> group also increases to above 100 after a couple of days in the initial phase. This can be explained by the high number of meetings between susceptible and zombies. By studying the subplot II in Fig.(<a href="#fig:large_town">24</a>), the zombies are grouped in the large town, while the middle and small town mostly consist of <em>Susceptible</em>. By counting the loss of <em>Susceptible</em> during the first phase, the Tab.(<a href="#table:compare_towns">table:compare_towns</a>) shows that this amount corresponds with the size of the towns where the zombie was placed, given by the number 17,188 and 362 in the small,middle and large group. The percent is highest in the middle town with 94 percent. The percent in the large and small group are 90 and 81.  The simulation in the middle town has the highest percent because the <em>Susceptible</em> group in the large town also gets infected. These towns are coupled together, and the epidemic disease is able to spread. The small town, which can be seen as Nesodden(a peninsula outside Oslo), has the lowest percent. The reason is that the disease is not able to spread to the other towns, and therefore is causes less damage.  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 25:  <a name="fig:compare_towns"></a> The values for each group counted during 34 days in <em>Walking Dead</em>. Initial phase from day 0 to day 3, Hysterical phase from day 3 to day 33 and Counter attack from day 33 to day 34. </p></center>
<p><img src="2_fig/2D_compare_towns.png" align="bottom" height=1000 width=400></p>
</center>

<p>
<br />
<br />
The results from the uniformed distributed simulation is still much higher for the <em>Zombie</em> group the in these three simulations. This shows that using the parameters from the ODE system in a geographical area makes little sense. A realistic assumption is that a zombie is restricted to a given area, and therefore the parameters will not be equal for all. The chance of getting infected is much higher if a person from the  <em>Susceptible</em> group is close to an infected. There is also a greater chance of getting infected if the <em>Susceptible</em> group has a high density. 

<p>
<!-- FIGURE:[2_fig/2D_zombie_three_phases_zombie_small_town_2_number.png, height=600 width=800 frac=0.8] -->

<p>
<!-- FIGURE:[plots/2D_zombie_three_phases_zombie_middle_town_2_number.png, height=600 width=800 frac=0.8] -->

<p>
<!-- FIGURE:[plots/2D_zombie_three_phases_zombie_large_town_2_number.png, height=600 width=800 frac=0.8] -->

<p>
time=0.000000
Susceptible = 619.99
Infective = 0.00
Zombies = 1.00
Removed = 0.00
time=3.000000
Susceptible = 259.20
Infective = 50.94
Zombies = 297.24
Removed = 13.78
time=33.000000
Susceptible = 251.14
Infective = 0.35
Zombies = 178.45
Removed = 192.90
time=34.000000
Susceptible = 247.33
Infective = 1.17
Zombies = 151.44
Removed = 222.96

<p>
<a name="table:compare_towns"></a>
<table border="1">
<thead>
<tr><th align="center">                </th> <th align="center"> Small town</th> <th align="center">    Middle town    </th> <th align="center">       Large       </th> </tr>
</thead>
<tbody>
<tr><td align="center">   Initial phase       </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   603.74         </td> <td align="center">   433.22                 </td> <td align="center">   259.20                 </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   2.96           </td> <td align="center">   25.51                  </td> <td align="center">   50.94                  </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   13.79          </td> <td align="center">   155.27                 </td> <td align="center">   297.24                 </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   0.66           </td> <td align="center">   7.16                   </td> <td align="center">   13.78                  </td> </tr>
<tr><td align="center">   Hysterical phase    </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   604.42         </td> <td align="center">   429.35                 </td> <td align="center">   251.14                 </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   0.03           </td> <td align="center">   0.18                   </td> <td align="center">   0.35                   </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   6.25           </td> <td align="center">   87.31                  </td> <td align="center">   178.45                 </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   12.14          </td> <td align="center">   106.00                 </td> <td align="center">   192.90                 </td> </tr>
<tr><td align="center">   Counter attack      </td> <td align="center">   -----------    </td> <td align="center">   -------------------    </td> <td align="center">   -------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   604.21         </td> <td align="center">   427.45                 </td> <td align="center">   247.33                 </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   0.08           </td> <td align="center">   0.59                   </td> <td align="center">   1.17                   </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   4.49           </td> <td align="center">   73.70                  </td> <td align="center">   151.44                 </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   14.11          </td> <td align="center">   121.16                 </td> <td align="center">   222.96                 </td> </tr>
</tbody>
</table>

<h2>Free areas for the <em>Susceptible</em> group  <a name="___sec31"></a></h2>
To model a realistic zombie attack, humans ability to think logically is crucial in the fight. The mobility was presented as a factor in the previous section. Another important skill that the <em>Susceptible</em> group holds, is the ability to decide the safety of an area. In the TV series <em>Walking Dead</em>, the humans build barricades to keep the zombies outside. This gives the <em>Susceptible</em> group free areas where they can stay. This idea can be transfered to the PDE system by rewriting the Eq.\eqref{eq:seland_model} with spatial dependent diffusion terms. The diffusion constant \( D_u \) is now replaced with a diffusion function \( \gamma_u(x) \) for \( u= S,I,Z,R \), which is spatial discretized. Since a diffusion equation always goes towards equilibrium, this rewriting will only slow down/stop the selected group to diffuse into an area. In this case it will stop the <em>Zombie</em> group from diffusing into the buildings. 
$$
\begin{equation} \label{eq:seland_model_diff}
    \begin{aligned} 
    \frac{\partial S}{\partial t} =& \Sigma -(\beta+\mu \omega(t))SZ - \delta_SS +\nabla(\gamma_S(x) \nabla S) \\
    \frac{\partial I}{\partial t} =& (\beta+\mu \omega(t))SZ - \varrho I - D_i\delta_II+\nabla(\gamma_I(x) \nabla I)\\
    \frac{\partial Z}{\partial t} =& \varrho I- (\alpha+\omega(t))SZ + \zeta R+\nabla(\gamma_Z(x) \nabla Z)\\
    \frac{\partial R}{\partial t} =& \delta_SS +\delta_II -\zeta R + (\alpha+\omega(t))SZ+\nabla(\gamma_R(x) \nabla R) 
    \end{aligned}
\end{equation}
$$

The diffusion term is the difference between this system and Eq.\eqref{eq:seland_model}. The discretization can be shown for for a general \( \gamma \). This will be similar for all groups. A Crank Nicolson discretization is used in space.
$$
\begin{equation} \label{eq:gamma}
    \begin{aligned}
    &=\nabla(\gamma(x) \nabla S) \\
    &=(\gamma(x) S_x)_x+(\gamma(x) S_y)_y \\
    &= \left(\gamma(x) \frac{S^{n}_{i+1/2,j}-S^{n}_{i-1/2,j}}{\Delta x}\right)_x+\left(\gamma(x) \frac{S^{n}_{i,j+1/2}-S^{n}_{i,j-1/2}}{\Delta y}\right)_y \\
    &= \left(\frac{\gamma(x_{i+1/2,j})(S^{n}_{i+1,j}-S^{n}_{i,j})-\gamma(x_{i-1/2,j})(S^{n}_{i,j}-S^{n}_{i-1,j})}{\Delta x^2}\right) \\
    &+ \left(\frac{\gamma(x_{i,j+1/2})(S^{n}_{i,j+1}-S^{n}_{i,j})-\gamma(x_{i,j-1/2})(S^{n}_{i,j}-S^{n}_{i,j-})}{\Delta y^2}\right)
    \end{aligned}
\end{equation}
$$

Since the calculations are based on spatial points, the values inside the function of \( \gamma \) need to be adjusted. This can be done by the use of an arithmetic mean, which can be seen in Eq.\eqref{eq:arith_mean}. The notation \( q_{i+1/2} \) is a simplification of the function \( q(x_{i+1/2}) \) with \( x_{i+1/2} = x_i + 1/2 \Delta x \)
$$
\begin{equation} \label{eq:arith_mean}
q_{i+1/2} \approx \frac{1}{2}(q_i +q_{i+1})
\end{equation}
$$

This arithmetic mean can be inserted for all \( \gamma \)'s in the system. The system can be expressed:
$$
\begin{equation} \label{eq:SIZR_disc3}
	\begin{aligned}
    S^{n+1}_{i,j}   &= S^n_{i,j} + \Delta t \Bigl( \Sigma - (\beta+\mu \omega(t))S^{n}_{i,j}Z^{n}_{i,j}- \delta_S S^{n}_{i,j} \\
                    &+ \frac{1}{2\Delta x^2}\left(\gamma_S(x_{i-1,j})(S^{n}_{i-1,j}-S^{n}_{i,j})+\gamma_S(x_{i,j})(S^{n}_{i-1,j}-2S^{n}_{i,j}+S^{n}_{i+1,j})+\gamma_S(x_{i+1,j})(-S^{n}_{i,j}+S^{n}_{i+1,j})\right) \\
                    &+ \frac{1}{2\Delta y^2}\left(\gamma_S(x_{i,j-1})(S^{n}_{i,j-1}-S^{n}_{i,j})+\gamma_S(x_{i,j})(S^{n}_{i,j-1}-2S^{n}_{i,j}+S^{n}_{i,j+1})+\gamma_S(x_{i,j+1})(-S^{n}_{i,j}+S^{n}_{i,j+1})\right)\Bigr)\\
    I^{n+1}_{i,j}   &= I^n_{i,j} + \Delta t \Bigl((\beta+\mu \omega(t))S^{n}_{i,j}Z^{n}_{i,j}-\varrho I^{n}_{i,j}- \delta_I I^{n}_{i,j} \\
                    &+ \frac{1}{2\Delta x^2}\left(\gamma_I(x_{i-1,j})(I^{n}_{i-1,j}-I^{n}_{i,j})+\gamma_I(x_{i,j})(I^{n}_{i-1,j}-2I^{n}_{i,j}+I^{n}_{i+1,j})+\gamma_I(x_{i+1,j})(-I^{n}_{i,j}+I^{n}_{i+1,j})\right) \\
                    &+ \frac{1}{2\Delta y^2}\left(\gamma_I(x_{i,j-1})(I^{n}_{i,j-1}-I^{n}_{i,j})+\gamma_I(x_{i,j})(I^{n}_{i,j-1}-2I^{n}_{i,j}+I^{n}_{i,j+1})+\gamma_I(x_{i,j+1})(-I^{n}_{i,j}+I^{n}_{i,j+1})\right)\Bigr)\\
    Z^{n+1}_{i,j}   &= Z^n_{i,j} +\Delta t \Bigl( \varrho I^{n}_{i,j}-(\alpha+\omega(t))S^{n}_{i,j}Z^{n}_{i,j}+ \zeta R^{n}_{i,j} \\
                    &+ \frac{1}{2\Delta x^2}\left(\gamma_Z(x_{i-1,j})(Z^{n}_{i-1,j}-Z^{n}_{i,j})+\gamma_Z(x_{i,j})(Z^{n}_{i-1,j}-2Z^{n}_{i,j}+Z^{n}_{i+1,j})+\gamma_Z(x_{i+1,j})(-Z^{n}_{i,j}+Z^{n}_{i+1,j})\right) \\
                    &+ \frac{1}{2\Delta y^2}\left(\gamma_Z(x_{i,j-1})(Z^{n}_{i,j-1}-Z^{n}_{i,j})+\gamma_Z(x_{i,j})(Z^{n}_{i,j-1}-2Z^{n}_{i,j}+Z^{n}_{i,j+1})+\gamma_Z(x_{i,j+1})(-Z^{n}_{i,j}+Z^{n}_{i,j+1})\right)\Bigr)\\
    R^{n+1}_{i,j}   &= R^n_{i,j} +\Delta t \left(\delta_S S^{n}_{i,j}+\delta_I I^{n}_{i,j}-\zeta R^{n}_{i,j}+(\alpha+\omega(t))S^{n}_{i,j}Z^{n}_{i,j}\right)
	\end{aligned}
\end{equation}
$$

The diffusion term for the <em>Removed</em> group is taken away, since dead people are not able to move. This system looks quite messy, but it is straight forward to calculate. All values on the right side are known values and the system is easy to solve. Now every point will be controlled by the diffusion constants given in \( \gamma(x) \). This makes it easier to control the flow in each group. With a high diffusion constant, the diffusion will spread fast. When the diffusion constant goes towards zero, the flow will decrease towards zero flow. This will result in a set of ODE systems modeled for each point.

<h2>Ten minutes at Frederikkeplassen  <a name="___sec32"></a></h2>
Frederikkeplassen at the University of Oslo is a possible area for an upcoming zombie attack. This simulation will try to model a ten minute sequence with the diffusion parameter added in this section. Since students often learn and interact fast, they will only use three minutes before they realize the danger and transitions into the <em>Hysterical phase</em>. A map of Frederikkeplassen is used to define the safe and critical areas. The buildings are set as areas where only the <em>Susceptible</em> are allowed to move. This is done by setting the diffusion constant to zero for the <em>Zombie</em> and <em>Infected</em> groups. Since the buildings are safe spots for the <em>Susceptible</em>, an idea would be to express this in the diffusion term by forcing the <em>Susceptible</em> for other areas into the buildings. This is more difficult, since the concentrations in each group wants to diffuse towards equilibrium. A way to delay this process is by setting the diffusion constant to be low in the buildings and high outside. This will result in a fast diffusion in the open areas and a slow diffusion inside the buildings. 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 26:  <a name="fig:frederikke_numbers"></a> The amount in each group for two simulations of Frederikkeplassen modeled same parameters for 10 minutes/hours. a)Plot with uniformed distributed groups and same diffusion constants for all groups. b)Plot based on figure(<a href="#fig:frederikke_free_area">27</a>) with different initial values for each group. </p></center>
<p><img src="2_fig/2D_compare_Frederikke.png" align="bottom" height=400 width=800></p>
</center>

<p>
<br />
<br />
Two simulations have been done at Frederikkeplassen. The amount in each group can be seen in Fig.(<a href="#fig:frederikke_numbers">26</a>). The first simulation has a solution based on the ODE system, with uniformed distributed groups, equal diffusion constants and no free areas for the <em>Susceptible</em>. The second simulation is modeled with three groups of <em>Susceptible</em>, as in the previous section. The small group with 21 students is placed at point(4,4), the middle group with 200 students is placed at point(15,8) and the large group with 400 students is placed at point(8,13). The zombie is placed at point(8,10). The \( \gamma(x) \) is set to zero in the buildings for the <em>Zombie</em> and <em>Infected</em> group, and one in the rest of the area. For the <em>Susceptible</em> group, \( \gamma(x) \) is set to 0.1 in the buildings, which causes slow diffusion. In the outside areas, \( \gamma(x) \) is set to 5 for the <em>Susceptible</em>. The desired result is to push them into the buildings, but this will only happen if there is a lower concentration inside the buildings. Therefore this will not reflect a realistic flow of a <em>Susceptible</em> population. This simulation can be seen in Fig.(<a href="#fig:frederikke_free_area">27</a>)  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 27:  <a name="fig:frederikke_free_area"></a> Frederikkeplassen modeled with free areas for the <em>Susceptible</em> group. The diffusion function \( \gamma(x) \) is set to zero for the <em>Zombie</em> and <em>Infected</em> group in the buildings. The zombie at initial time is placed in the center of Frederikkeplassen </p></center>
<p><img src="2_fig/2D_Frederikke_contourf_sub.png" align="bottom" height=600 width=800></p>
</center>

<p>
<br />
<br />
The results in Tab.(<a href="#table:frederikke_table">table:frederikke_table</a>) shows that the three first minutes are crucial. The number after three minutes shows that only 72 humans survived the attack in the uniformed solution, compared to 252 in the free areas. The number in the <em>Zombie</em> group is quite similar in <em>Uniformed distribution</em> and <em>Free areas</em> measured at \( t=3 \). However at \( t=7 \) the difference is major. This can be explained by looking at Fig.(<a href="#fig:frederikke_free_area">27</a>) and the building with the middle group placed inside. When the zombie starts attacking at \( t=0 \), the large group is exposed. This group is placed close to the zombie and the position is in an open area. The zombie can attack right away and the number in the <em>Infected</em> and <em>Zombie</em> groups increases fast. In the two first minutes, a major part of the large group is infected and the <em>Zombie</em> group starts to spread. After 2-3 minutes, the group has reached the buildings with the middle group. Here the diffusion is set to 0, and the spread of zombies stop. Since the diffusion variable for the <em>Susceptible</em> is quite low inside the buildings, it takes time before the group diffuses. Maybe the right diffusion value along the buildings would be 0, to avoid any leakage. This would again cause problem for the diffusion of <em>Susceptible</em> into the buildings. It is also reasonable to think that the <em>Susceptible</em> group needs to diffuse after a certain time. The lack of supplies would force them out.

<p>
<!-- # -->
<!-- # -->

<p>
<a name="table:frederikke_table"></a>
<table border="1">
<thead>
<tr><th align="center">           </th> <th align="center">    Uniform distribution   </th> <th align="center">   Free areas  </th> </tr>
</thead>
<tbody>
<tr><td align="center">   3 Minutes      </td> <td align="center">   ---------------------------    </td> <td align="center">   ---------------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   72.23                          </td> <td align="center">   252.72             </td> </tr>
<tr><td align="center">   Infected       </td> <td align="center">   229.65                         </td> <td align="center">   75.69              </td> </tr>
<tr><td align="center">   Zombie         </td> <td align="center">   296.67                         </td> <td align="center">   276.55             </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   20.84                          </td> <td align="center">   13.94              </td> </tr>
<tr><td align="center">   7 Minutes      </td> <td align="center">   ---------------------------    </td> <td align="center">   ---------------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   70.78                          </td> <td align="center">   251.35             </td> </tr>
<tr><td align="center">   Infected       </td> <td align="center">   0.83                           </td> <td align="center">   0.51               </td> </tr>
<tr><td align="center">   Zombie         </td> <td align="center">   498.72                         </td> <td align="center">   325.54             </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   49.12                          </td> <td align="center">   41.26              </td> </tr>
<tr><td align="center">   10 Minutes     </td> <td align="center">   ---------------------------    </td> <td align="center">   ---------------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   69.69                          </td> <td align="center">   249.84             </td> </tr>
<tr><td align="center">   Infected       </td> <td align="center">   0.25                           </td> <td align="center">   0.38               </td> </tr>
<tr><td align="center">   Zombie         </td> <td align="center">   479.00                         </td> <td align="center">   295.71             </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   70.55                          </td> <td align="center">   72.36              </td> </tr>
</tbody>
</table>

<h1>Discussion  <a name="___sec33"></a></h1>
This chapter expand the study of the disease, by adding the opportunity to analyse the disease for a spatial area. The travelling wave is essential for a disease to spread in an area. If the reproduction rate seen in Eq.\eqref{reproduction_rate_PDF} was below 1, the travelling wave would decrease towars zero and the disease would dissapear. By varying \( \lambda \), one could see that a low value would cause a total eradication of the <em>Susceptible</em>. By setting \( \lambda>=1 \), the damage from the epidemic wave would be close to zero and the disease would die out.
<br />
<br />
The results from the English boarding school shows that the position of the infected student has a major impact on the result. A uniform distribution was first calculated and compared with the ODE simulation in the previous chapter. This gave the same result. By varying the position of the infected student, the result was affected. When simulating the disease for a long time, the number of <em>Infected</em> students seems to be similar. Therefore the parameter values in the system will not be enough to say anything about the concentrations measured in time for each group. The position will also affect the result. 
<br />
<br />
The section <em>Zombiefication</em> verified the uniform distribued PDF solution with the ODE solution from the previous chapter. These were expected to be similar. The English boarding school studied the result of varying the position of the infected with a uniform distributed group of <em>Susceptible</em>. This section tried to expand this idea byspread the group of <em>Susceptible</em> into three groups. The position of the zombie was placed in center of all three groups. The amount of <em>Infected</em> in these three simulations was proportional to the size of the group where the zombie was placed. The position of the infected student was shown to have an impact on the spread of the disease. This section shows that the <em>Susceptible</em> group also affects the result.
<br />
<br />
The last part <em>Ten minutes at Frederikke</em> tries to implement human behavior by giving the <em>Susceptible</em> group the ability to keep zombies outside the buildings. This was crucial in <em>Walking Dead</em> to prevent meetings between zombies and humans. One can see from the results that this gives the <em>Susceptible</em> group a greater chance of surviving. The concentrations for each group will go towards equilibrium. Therefore this simulation will differ from human behavior. The next chapter will use random walks to simulate this zombie outburst. This will build on <em>Ten minutes ad Frederikke</em>, and introduce different conditions based on the phase the zombies and humans are in. 

<p>
\externaldocument{../1_ODE_models/biological_models.do.txt}
\externaldocument{../2_PDE_Fisher_Kolmogoroff/2_PDE_FK.do.txt}

<h1>Random walk  <a name="___sec34"></a></h1> <hr>
The last chapter will study a third way to model epidemic diseases. This will be done by using random walk. This technique is quite different from the two models presented earlier. Here Monte Carlo simulations and probabilities are used instead of differential equations, which have been in focus earlier. The first section will be an introduction to general principles for Monte Carlo methods and Random walk based on the paper from M.H. Jensen Ref. <a href="#hjorth2011computational">[11]</a>. The next sections will use the parameters from the <em>English Boarding School</em> and <em>Walking Dead</em> to see if a random walk system can expand the knowledge about epidemics by adding human behavior.

<h1>Monte Carlo methods <a name="sec:monte_carlo_methods"></a></h1>
Techniques from Monte Carlo are widely used in several fields as chemistry, physics, medicine, biology and in finance Ref. <a href="#hjorth2011computational">[11]</a>. These numerical methods can be seen in general terms as statistical simulation methods, which use random numbers to perform the simulations. Four terms are required to understand the Monte Carlo strategy:

<ul>
<li> Random variable</li>
<li> Probability distribution functions (PDF)</li>
<li> Moments of a PDE</li>
<li> The pertinent variance \( \sigma ^2 \)</li>
</ul>

The two first terms are important when modelling a random walk simulation, while the two last terms are important when studying the result. The four terms are explained below.

<h2>Random variable  <a name="___sec36"></a></h2>
Random variable can be seen as a stochastic variable, where the outcome cannot be presumed. Examples as tossing dice, flipping coins or gambling are based on this principle. Although the outcome is unknown, knowledge about the probability and the range can be studied. The numbers in the <em>domain</em> for two dice are
$$
\begin{equation*}
\{2,3,4,5,6,7,8,9,10,11,12\}
\end{equation*}
$$

with the corresponding <em>probabilities</em> are
$$
\begin{equation*}
\{1,2,3,4,5,6,5,4,3,2,1\}\frac{1}{36}
\end{equation*}
$$

By throwing two dice once, there is no guarantee that the result will be 7, though this has the highest probability. However, by repeating this operation, the distribution would reflect the <em>probabilities</em> above. A stochastic variable can either be discrete or continuous, but will in both cases be denoted as capital letters, \( X,Y \). A discrete example is the example above, where the domain is given with exact values, \( {x_1,x_2,x_3,...,x_n} \). The continuous case can be seen as the probability in a given area. An example can be the distance from a dart to the center, after trowing a dart randomly.
<br />
<br />
This chapter will use random variable for several decisions. The path of the walker will be controlled by two random variables. The first will control the direction of the walker, by drawing a random number between \( 0 \) and \( 2\pi \). The second random variable will control the number of time steps walked in the chosen direction. Here a number between 1 and 20 is drawn. This is done to create a more realistic movement pattern. Random variables will be drawn for each parameter value given in the previous ODE and PDE systems. Here the outcome will be based on the random variable and the probability given by the parameter value.

<h2>Probability distribution functions (PDF)  <a name="___sec37"></a></h2>
The PDF is a function \( p(x) \) on the domain that gives the probability or relative frequency for a outcome. In the discrete case, the function can be seen as
$$
\begin{equation}
p(x) = Prob(X=x)
\end{equation}
$$

The PDF in the continuous case is not able to directly depict the actual probability. The probability is instead defined as the density around \( x \) with an infinitesimal interval. This can therefore be seen as an integral, since it is the density of the probability rather than the probability Ref.<a href="#hjorth2011computational">[11]</a>. This can be defined.
$$
\begin{equation}
 Prob(a\leq X \leq b) = \int^b_a p(x)dx
\end{equation}
$$

To quote M.H. Jensen "Qualitatively speaking, a stochastic variable represents the values of numbers chosen as if by chance from some specified PDF so that the selection of a large set of these numbers reproduces this PDF." Ref.<a href="#hjorth2011computational">[11]</a>. This sums up the relation between random variables and the PDF. If this is not fulfilled, the group of stochastic variables does not fulfill the criteria for random numbers. 

<p>
There are two properties that the PDF must fulfill. The first one is the size of \( p(x) \). This has to be in the interval \( 0\leq p(x) \leq 1 \), since the probability cannot be negative or larger than 1 for an event to happen. The sum of all events has to be 1, both for discrete and continuous PDFs, and can be seen as follows
$$
\begin{equation}
	\begin{aligned}
    \sum_{x_i \in \mathbb{D}}\\
    \int_{x \in \mathbb{D}}
	\end{aligned}
\end{equation} 
$$


<p>
There are several distributions that are essential when looking at continuous PDFs. The main PDF in this chapter will be uniform distribution and can be seen in Eq.\eqref{eq:uni_dist}.
$$
\begin{equation} \label{eq:uni_dist}
p(x) = \frac{1}{b-a}\theta(x-a)\theta(b-x)
\end{equation}
$$

with:
$$
\begin{equation}
	\begin{aligned}
    \theta(x) = 0,\quad x < 0 \\
    \theta(x) = 1,\quad x \geq 0
	\end{aligned}
\end{equation}
$$

This is used to disperse the group of walkers at initial time over the area. The chance will be equal for all positions. This PDF is also used in the movement pattern and for the spread of the disease. To get a correct estimate, it is important that the set of random numbers is large enough. Gaussian distribution is the second PDF used in this chapter. This is often called normal distribution and can be seen in Eq.\eqref{eq:gauss_dist}
$$
\begin{equation} \label{eq:gauss_dist}
	\begin{aligned}
    p(x) = \frac{1}{\sigma \sqrt{2\pi}} \exp(-\frac{(x-\mu)^2}{2\sigma^2})
	\end{aligned}
\end{equation}
$$

This will give the same distribution as the Gaussian function used in the previous chapter. Here it will be used for the simulations of all three phases, to describe the initial positions of the walkers.

<h2>Moments of a PDF  <a name="___sec38"></a></h2>
By defining \( h(x) \) as an arbitrary function, the <em>expectation value</em> can be written
$$
\begin{equation}
    \langle h \rangle_X \equiv \int h(x)p(x)dx
\end{equation}
$$

Here, defined on the domain of the stochastic variable \( X \), with PDE \( p(x) \). A more general way to write the expectation is by adding a power of, \( n \), to the equation. This can now be seen as the <em>moments</em>. The \( n \)-th moment is defined
$$
\begin{equation}
    \langle x^n \rangle \equiv \int x^np(x)dx
\end{equation}
$$

The value of \( n \) can be set to zero. This results in \( \langle 1 \rangle \) and creates a normalized condition for \( p \). The first order is called <em>mean</em> and is often defined with a \( \mu \).
$$
\begin{equation}
    \langle x \rangle = \mu \equiv \int xp(x)dx
\end{equation}
$$

This represents the average value of PDF and is often called the expectation value of \( p \) Ref.<a href="#hjorth2011computational">[11]</a>. Since this system consists of small group of walkers, which is modeled over a short period, the results from the simulations will vary. Therefore a set of simulations will be performed and the average values will be used.

<h2>The pertinent variance \( \sigma ^2 \)  <a name="___sec39"></a></h2>
<em>Central moments</em> is a special case of moments defined as
$$
\begin{equation}
    \langle (x-\langle x \rangle)^n \rangle \equiv \int (x-\langle x \rangle)^np(x)dx
\end{equation}
$$

The first two central-moments are trivial and only result in 1 and 0, respectively for \( n=0 \) and \( n=1 \). However, the second central-moment is more interesting to study. This is denoted as \( \sigma^2_X \) or Var(X), called the variance. This can be shown.
$$
\begin{equation}
    \sigma^2_X  = \langle x^2\rangle -\langle x \rangle^2 
\end{equation}
$$

The square root of the variance, \( \sigma = \sqrt{\langle (x-\langle x \rangle)^2 \rangle} \) is called <em>standard deviation</em>. This can be seen as the spread around the mean of the PDF. Since the result is based on the average value of a set of simulations, the <em>standard deviation</em> also gives essential information. If the <em>standard deviation</em> is major, one can expect large variations when modelling a system. This will make it more difficult to predict the result of an outcome. Since these systems are quite small, one can expect major variations and a large <em>standard deviation</em>.

<h1>Random walker  <a name="___sec40"></a></h1>
Now a random walker can be introduced in 1D. This can either jump to the left or to the right with a lenght of \( \Delta x = l \). It is an equal probability for both directions. \( L=R=1/2 \). Then the average displacement will be 
$$
\begin{equation}
 \langle x(n) \rangle = \sum^n_i \Delta x_i = 0, \quad \Delta x_i = \pm l,
\end{equation}
$$

after \( n \) jumps. The variance can be found by first finding \( \langle x(n)^2 \rangle \).
$$
\begin{equation}
\langle x(n)^2 \rangle = \left(\sum^n_i \Delta x_i\right)\left(\sum^n_j \Delta x_j\right) = \sum^n_i \Delta x_i^2 + \sum^n_i \Delta x_i \Delta x_j = l^2n
\end{equation}
$$

The last term here will disappear after enough steps.  
$$
\begin{equation}
\sum^n_i \Delta x_i \Delta x_j = 0
\end{equation}
$$

This gives the variance
$$
\begin{equation}
\langle x(n)^2 \rangle-\langle x(n) \rangle^2 = l^2n
\end{equation}
$$

Now this variance from a random walker can be coupled with the variance from a diffusion equation. By setting \( n = t/\Delta t \). The random walker gets the following variance
$$
\begin{equation}
\langle x(n)^2 \rangle-\langle x(n) \rangle^2 = l^2\frac{t}{\Delta t}
\end{equation}
$$

Then the diffusion constant in \eqref{eq:diff_var} can be replaced by
$$
\begin{equation}
D = \frac{l^2}{\Delta t}
\end{equation}
$$

And the variance between these can be compared.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 28:  <a name="fig:gauss_random"></a> 10000 random walkers placed at x=0 at t=0. Every step has the length \( \Delta x = 0.01 \) and with a random step every \( \Delta t = 0.01 \). </p></center>
<p><img src="3_fig/random_compare.png" align="bottom" height=500 width=800></p>
</center>

<p>
The standard deviation can be found for this simulation. This is given by the square root of the variance
$$
\begin{equation}
\sigma = \sqrt{l^2\frac{t}{\Delta t}}
\end{equation}
$$


<p>
To study if the average random walker develops as expected, a table can with the outputs can be added. 

<p>
<a name="table:gauss_random"></a>
<table border="1">
<thead>
<tr><th align="center">                      </th> <th align="center"> time=2 </th> <th align="center">  time=8 </th> </tr>
</thead>
<tbody>
<tr><td align="center">   average displacement      </td> <td align="center">   0.000662    </td> <td align="center">   -0.002416    </td> </tr>
<tr><td align="center">   standard deviation(SD)    </td> <td align="center">   0.1414      </td> <td align="center">   0.2828       </td> </tr>
<tr><td align="center">   percent inside SD         </td> <td align="center">   70.96 %     </td> <td align="center">   69.02 %      </td> </tr>
<tr><td align="center">   percent inside gauss      </td> <td align="center">   68.26 %     </td> <td align="center">   68.26 %      </td> </tr>
</tbody>
</table>
<p>
The average displacement and the standard deviation shows that a group of random walkes spread similar as a standard diffusion function. This result in a major group of random walkers. In the simulation in Fig.(<a href="#fig:gauss_random">28</a>), 10000 random walkers are used. By increasing the amount om random walkers, the precision will be better.

<h1>English Boarding School  <a name="___sec41"></a></h1>
This example has been common for all three systems, and will be used in this chapter. The chance of getting infected by influenza requires a meeting between an infected person and a susceptible person. A random walker will after enough steps cover the whole area. A simulation is done for a student with a random position at initial time. 1000 random steps are performed every day, which results in a step every 90 seconds. The step length is set to 5.7024 m, and is based on the average distance a person walks every day. The simulation is performed for 15 days, which results in 15000 random steps. The size of the schoolyard is set to 100 m x 100 m, and the disease can spread within a distance of 5 meters.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 29:  <a name="fig:random_walker_days"></a> The positions a random walker has covered in 1,5 and 15 days. A random step with length 5.7024 m is performed every minute. The positions are plotted for every ten minutes. </p></center>
<p><img src="3_fig/random_walk_days.png" align="bottom" height=300 width=900></p>
</center>

<p>
Fig.(<a href="#fig:random_walker_days">29</a>) shows that a random walker will be distributed over the area after enough steps. The students in the school are divided into three groups. 

<ul>
<li> The <em>Susceptible</em> group: This group consists of susceptible students, and this group is at risk of getting infected. This group is described by \( S \).</li> 
<li> The <em>Infected</em> group: This group consists of infected students. The group is described by \( I \).</li> 
<li> The <em>Removed</em> group: This group consists of students who are immune to the disease. This group is described by \( R \).</li> 
</ul>

The total number of students is \( N=763 \). The initial values are: \( S_0=762 \), \( I_0=1 \) and \( R_0=0 \). There are two parameters that are used in the simulation. The first parameter \( r \), describes the gain of infected students from the <em>Susceptible</em> group. This is rate proportional to the number of susceptible and infected students and is given by \( rSI \). The second parameter \( a \) describes the rate of removal of <em>Infected</em> to the <em>Removed</em> group. These two parameters are set to \( r=2.18\cdot 10^{-3} \) and \( a=0.44036 \) for the ODE system simulated in the first chapter. The ODE system can be seen in Eq.\eqref{eq:SIR_model_random}
$$
\begin{equation} \label{eq:SIR_model_random}
	\begin{aligned} 
	\frac{dS}{dt} &= -rSI \\ 
	\frac{dI}{dt} &= rSI-aI \\ 
	\frac{dR}{dt} &= aI 
	\end{aligned}
\end{equation}
$$

The parameters \( r \) and \( a \) must be adapted to the random walk simulation. The parameter \( r \) is used in
$$
\begin{equation} \label{eq:rSI}
rSI
\end{equation}
$$

and is based on the fact that all possible combinations of \( S \) and \( I \) are performed during one time unit. This is necessarily not the case in a random simulation. The meetings in a random simulation depends on the number of random walkers, the possibility for a meeting and number of time steps during one time unit. If the possibility for a meeting is small, the students have to be close to transmit the disease. If the number of time steps is high, the chance of meeting is higher. The following term has to be fulfilled: 
$$
\begin{equation} \label{eq:m_0}
r_r m_0 = rS_0I_0
\end{equation}
$$

Here \( m_0 \) is a constant value and represents number of meetings between the <em>Susceptible</em> group and the <em>Infected</em> group at initial time. This can be found by a numerical simulation of the random walkers. The number of meetings for the infected student during one day is simulated for 1000 rounds, the average number of meetings during one time unit is \( m_0=1905.223 \). Now Eq.\eqref{eq:m_0} can be rewritten and \( r_r \) can be expressed by known values: 
$$
\begin{equation} \label{eq:m_0_2}
	\begin{aligned} 
	r_r &= \frac{rS_0I_0}{m_0}
	\end{aligned}
\end{equation}
$$

The parameter \( r_r \) is now used to calculate the risk of getting infected in a meeting between a susceptible student and an infected student. 
<br />
<br />
The value of \( a \) also has to be adjusted. This parameter is only affected by the time. The random simulation is performed for 1000 random steps during one day. The parameter value for \( a_r \) can be found by study the average period of illness. This can be found by \( \frac{1}{a} \). The average period is 2.27 days. The value of \( a_r \) can be set to 0.00044036. With a numerical simulation of 100 000 random walkers and the parameter value \( a_r=0.00044036 \) for becoming immune, one can see that the average number will be 2.27 days. The simulation of the English boarding school can be seen in Fig.(<a href="#fig:english_school_random">30</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 30:  <a name="fig:english_school_random"></a>Random walk compared to an ODE simulation of Eq.(ref{eq:SIR_model_random}. The random function is shown with a dashed line, with the standard deviation shown as the colored area around the dashed line. The random function is based on the average of a series of simulations. </p></center>
<p><img src="3_fig/english_school_random.png" align="bottom" height=500 width=500></p>
</center>

<h2>Lower maximum concentration for the <em>Infected</em> group  <a name="___sec42"></a></h2>
In the previous chapters, the threshold value was found for the epidemic systems. The reproduction rate could be used to check if the disease would develop into an epidemic disease. The reproduction rate can be seen in Eq.\eqref{eq:rep_rate}
$$
\begin{equation} \label{eq:rep_rate}
R_0 = \frac{rS_0}{a}
\end{equation}
$$

If \( R_0> 1 \) was fulfilled, an epidemic situation would occur. The result will be \( R_0 = 3.77 \) with the parameters from the ODE simulation. This information could be used to find the maximum concentration for the <em>Infected</em> group. This was shown in the Sec.(ref{sec:1threshold_phenomenon}} in chapter <em>ODE models</em>. In the two previous chapters, the maximum value of <em>Infected</em>, given by \( I_{max} \) has been set to 292.8. By studying the Fig.(<a href="#fig:english_school_random">30</a>), one can see that the maximum value of the random walk simulation is lower, and occur later. The maximum value of the <em>Infected</em> group is here measured to be 263.2. 
<br />
<br />
Since the transformation for a student from the <em>Susceptible</em> group to the <em>Infected</em> group only requires one successful meeting, where successful is seen as the transmission of the disease. There will be no difference in the result if the transmission of the disease happens once or several times during one time step. This is reasonable to be the case when the amount of <em>Infected</em> increases. If a person gets infected, the incubation time will be set and not vary related to the amount of sick ones around. Based on a report from Centers for Disease Control and Prevention from 2008, the incubation time for influenza is between 1 and 4 days, and the average is 2 days. 
<!-- http://www.cdc.gov/flu/professionals/acip/clinical.htm -->

<h2>The chance for a disease to spread  <a name="___sec43"></a></h2>
When calculating the group of simulations, only 75 percent of the simulations resulted in an epidemic disease. 25 percent resulted in a transmission of the infected student to the <em>Removed</em> group, before the student was able to infect other students. This simulations were performed on a small group, and the results may differ in larger groups. A removal rate above one will not necessarily lead to an epidemic disease, if the group is small enough.

<p>
<!-- max inf 263.186666667 -->

<h1>Zombiefication  <a name="___sec44"></a></h1>
The ODE system given in chapter <em>ODE models</em> will be used for this simulation. This can be seen in Eq.\eqref{eq:seland_model_random}. The parameters has to be adjusted for this simulation, similar as shown for the English boarding school. Frederikkeplassen at Blindern will be used as the area where the simulations will be done. The area is estimated to be 100m x 100m and the disease will be able to spread if the distance is closer than 4 meters. There will be done four different simulations in this section, where the influence from human behavior to the model will be study. The time unit will be set to minutes, and the simulations will be from 10 minutes to 34 minutes for the two last simulations. There will be performed 100 random walks each minute.       
$$
\begin{equation} \label{eq:seland_model_random}
    \begin{aligned} 
    \frac{dS}{dt} =& \Sigma -(\beta+\mu \omega(t))SZ - \delta_SS \\
    \frac{dI}{dt} =& (\beta+\mu \omega(t))SZ - \varrho I - \delta_II\\
    \frac{dZ}{dt} =& \varrho I- (\alpha+\omega(t))SZ + \zeta R\\
    \frac{dR}{dt} =& \delta_SS +\delta_II -\zeta R + (\alpha+\omega(t))SZ 
    \end{aligned}
\end{equation}
$$


<p>
As similar for the English boarding school, the parameters in Eq.\eqref{eq:seland_model_random} have to be adjusted. The parameters from the two first phases in <em>Walking Dead</em> will be used. These can be seen in the table below. The number of meetings per minute is set to \( m_0 = 98.64 \), based on the average from 300 time steps. This is used to find the value of \( \beta_r \) and \( \alpha_r \), similar to the method shown in the previous section. The value for \( \varrho \) has been adjusted by first finding the average incubation time for the <em>Infected</em> group. This has been done by setting \( 1/\varrho \). The average incubation time is 0.72 minute. This is really fast, and is not a realistic number, based on the TV Series <em>Walking Dead</em>. By numerical simulations, the value of \( \varrho_r \) can be set to 0.0137 for each simulation. This will result in a average incubation time of 0.72 minute. The same can be done for the value in the hysterical phase.  

<p>
<a name="table:param_val_random"></a>
<table border="1">
<thead>
<tr><th align="center">   parameter   </th> <th align="center">Initial phase</th> <th align="center">hysterical phase</th> </tr>
</thead>
<tbody>
<tr><td align="center">   \( \beta \)        </td> <td align="center">   0.01155          </td> <td align="center">   0.000011            </td> </tr>
<tr><td align="center">   \( \beta_r \)      </td> <td align="center">   0.07271          </td> <td align="center">   0.000693            </td> </tr>
<tr><td align="center">   \( \varrho \)      </td> <td align="center">   1.37             </td> <td align="center">   1.5                 </td> </tr>
<tr><td align="center">   \( \varrho_r \)    </td> <td align="center">   0.0137           </td> <td align="center">   0.015               </td> </tr>
<tr><td align="center">   \( \alpha \)       </td> <td align="center">   0.00044          </td> <td align="center">   0.000208            </td> </tr>
<tr><td align="center">   \( \alpha_r \)     </td> <td align="center">   0.00277          </td> <td align="center">   0.001309            </td> </tr>
</tbody>
</table>
<p>
These parameter values are used for all simulations. The previous chapter <em>Geographic models</em> introduced the spatial effect and the ability for humans to seek safe areas. This chapter will introduce different conditions for the walkers. These conditions will affect the interaction between the groups. In chapter <em>ODE models</em>, the simulated period was estimated to 34 days. This will be different in this chapter. The section <em>Ten minutes at Frederikkeplassen</em> in the previous chapter will be used as preference for the results.

<h2>Random walk  <a name="___sec45"></a></h2>
Random walk will be the first condition for each walker. This results in a smooth distribution of the whole group. The simulation will be done for ten minutes at Frederikkeplassen. The simulations are shown in <Pygame>, where the random walkers are represented with different images. These can be seen in Fig.(<a href="#fig:figure_images">31</a>).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 31:  <a name="fig:figure_images"></a> Figures used in the simulation. All seen from the sky. I: The walkers in the <em>Susceptible</em> group can be seen as humans with green sweater. II: The walkers in the <em>Infected</em> group can be seen with a red and green sweater, with one arm in front. III: The walkers in the <em>Zombie</em> group can be seen with a white sweater and both arms in front. IV: the walkers in the <em>Removed</em> group can be seen as a tombstone. </p></center>
<p><img src="3_fig/figure_images.png" align="bottom" height=50 width=400></p>
</center>

<p>
The initial values for the four groups are similar as for the previous chapter. \( S_0 = 621 \), \( I_0 = 0 \), \( Z_0 = 1 \) and \( R_0 = 0 \). The walkers are randomly distributed over Frederikkeplassen at initial time. The initial positions on one simulation can be seen in subplot I in Fig.(<a href="#fig:initial_final">32</a>).The probability distribution function for the walkers are here set to be uniform. The walkers will therefore have the same probability for walking in all directions. The step length is based on an average pace on 5 kilometers per hour. This result in a step length of 0.83 m for each random walk. The first simulation is run for 10 minutes. The parameters from the <em>Initial phase</em> are used from 0 to 3 minutes. From 3 to 10 minutes, the parameters from the <em>Hysterical phase</em> are used. The result after 10 minutes can be seen in subplot II in Fig.(<a href="#fig:initial_final">32</a>). 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 32:  <a name="fig:initial_final"></a> Positions from the simulations of Frederikkeplassen. I: Initial position for 621 susceptible humans and 1 zombie. II: Final position of a simulation of Frederikkeplassen. </p></center>
<p><img src="3_fig/Frederikke_initial_final.png" align="bottom" height=600 width=400></p>
</center>

<p>
There are performed 200 simulations with these parameter values, and the average and standard deviation of the simulations are plotted in Fig(<a href="#fig:walking_dead">33</a>). 95 percent of the simulations led to an epidemic disease. However, the standard deviation is large. By study the second phase from 3 minutes to 10 minutes, one can see that the amount in each group varies. In the <em>Hysterical phase</em>, the standard deviation is high for the <em>Susceptible</em>  and the <em>Zombie</em> group. Therefore the outcome from a random chosen simulation is hard to predict.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 33:  <a name="fig:walking_dead"></a>The average and standard deviation of 190 simulations on Frederikkeplassen. The <em>Initial phase</em> lasts from 0 to 3 minutes.The <em>Hysterical phase</em> lasts from 3 to 10 minutes. The parameter values can be seen in Tab.(<a href="#table:param_val_random">table:param_val_random</a>). </p></center>
<p><img src="3_fig/Walking_dead_Frederikke.png" align="bottom" height=500 width=500></p>
</center>

<p>
By comparing the average result with the PDE simulation from <em>Ten minutes at Frederikkeplassen</em> in previous chapter, one can see that the average results differ from the PDE results. The average number of the <em>Susceptible</em> group is higher than the result from the PDE simulation. 

<p>
<a name="table:frederikke_table_random"></a>
<table border="1">
<thead>
<tr><th align="center">           </th> <th align="center">  Uniform distribution PDE </th> <th align="center"> Uniform distribution Random walk</th> <th align="center">Uniform distribution Moving smart</th> </tr>
</thead>
<tbody>
<tr><td align="center">   3 Minutes      </td> <td align="center">   ---------------------------    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   72.23                          </td> <td align="center">   279.2                                </td> <td align="center">   87.51                                </td> </tr>
<tr><td align="center">   Infected       </td> <td align="center">   229.65                         </td> <td align="center">   162.05                               </td> <td align="center">   229.02                               </td> </tr>
<tr><td align="center">   Zombie         </td> <td align="center">   296.67                         </td> <td align="center">   167.57                               </td> <td align="center">   284.88                               </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   20.84                          </td> <td align="center">   13.168                               </td> <td align="center">   20.59                                </td> </tr>
<tr><td align="center">   7 Minutes      </td> <td align="center">   ---------------------------    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   70.78                          </td> <td align="center">   276.36                               </td> <td align="center">   82.79                                </td> </tr>
<tr><td align="center">   Infected       </td> <td align="center">   0.83                           </td> <td align="center">   0.6421                               </td> <td align="center">   35.35                                </td> </tr>
<tr><td align="center">   Zombie         </td> <td align="center">   498.72                         </td> <td align="center">   278.87                               </td> <td align="center">   397.46                               </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   49.12                          </td> <td align="center">   66.115                               </td> <td align="center">   106.4                                </td> </tr>
<tr><td align="center">   10 Minutes     </td> <td align="center">   ---------------------------    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> </tr>
<tr><td align="center">   Susceptible    </td> <td align="center">   69.69                          </td> <td align="center">   274.34                               </td> <td align="center">   79.96                                </td> </tr>
<tr><td align="center">   Infected       </td> <td align="center">   0.25                           </td> <td align="center">   0.4736                               </td> <td align="center">   34.87                                </td> </tr>
<tr><td align="center">   Zombie         </td> <td align="center">   479.00                         </td> <td align="center">   243.48                               </td> <td align="center">   350.15                               </td> </tr>
<tr><td align="center">   Removed        </td> <td align="center">   70.55                          </td> <td align="center">   103.69                               </td> <td align="center">   157.02                               </td> </tr>
</tbody>
</table>

<h2>Moving smart  <a name="___sec46"></a></h2>
Next phase is based on the movement pattern that would be more realistic based on the TV series <em>Walking Dead</em>. Here the <em>Zombie</em> group search after <em>Susceptible</em> humans in the area around them. If there are humans that are close enough, the zombie will start moving towards the human. The same is done for the humans in the *Susceptible*group. The humans search around after possible attacks from the zombies. In the zombies are close enough, the humans will walk away. If the distance between the zombie and human is to high, they will randomly move around. 
<br />
<br />
Similar as for the random walk condition above, the moving smart condition is calculated for 200 simulations. The step length has been set to equal for the <em>Susceptible</em> group and the <em>Zombie</em> group. Therefore the number of zombies are set to 10, to avoid a chasing game, where one zombie run after the group of <em>Susceptible</em> with the equal distance the whole time. A screenshot of one simulation can be seen in Fig.\eqref{fig:screenshot_moving_smart}. One can see that the zombies chase the humans around. The zombies have to cooperate to be able to get close enough to attack the humans.  

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 34:  <a name="fig:screenshoot_moving_smart"></a> Three Screenshots of the moving pattern for the <em>Zombie</em> and <em>Susceptible</em> group with the moving smart condition.I:Close after initial time. The zombies are chasing the humans.II: A large group of humans have recently been infected in the upper left corner. III: Close to total eradication for the human group. Only a small group left in the center of Frederikke. </p></center>
<p><img src="3_fig/screenshots_moving_smart.png" align="bottom" height=800 width=300></p>
</center>

<p>
Some simulations was first tried where only one zombie was initialized at the start. This resulted in zero infected humans and a chasing zombie as explained above. However, when the amount of zombies was increased to 10, it gave a major difference in the result. One can see in Tab.(<a href="#table:frederikke_table_random">table:frederikke_table_random</a>) that after the <em>Initial phase</em>, there are only 100 susceptible humans left in the average moving smart. The cooperating force from the <em>Zombie</em> group gets stronger as the group increases. Then they are able to chase the <em>Susceptible</em> group from several fronts, and it is difficult for the <em>Susceptible</em> group to avoid fights. Similar things are seen in <em>Walking Dead</em>. In the city Atlanta, where the amount of zombies is high, the ability to escape is difficult. While when the main character Rick Grimes meets individual zombies, he can easily escape the danger. A plot of the average result with the standard deviation can be seen in Fig.(<a href="#fig:average_moving_smart">35</a>). 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 35:  <a name="fig:average_moving_smart"></a> </p></center>
<p><img src="3_fig/Moving_smart_average.png" align="bottom" height=500 width=500></p>
</center>

<p>
A result of this cooperating force from the <em>Zombie</em> group is that the group is able to eradicate the <em>Susceptible</em> group in several simulations. After the <em>Initial phase</em> 19 of the 200 simulations results in eradication for the <em>Susceptible</em> group. At final time the number of simulations that causes eradication has increased to 97 simulations. Close to 50 percent of all simulations result in eradication, and this moving smart condition seems to give the <em>Zombie</em> group the greatest advantage.

<h2>Three phases in Walking Dead  <a name="___sec47"></a></h2>
A natural idea is to use different conditions for different phases. The first phase, <em>Initial phase</em> will include a random walk condition for all groups. While the <em>Hysterical phase</em> will include a smart moving condition for the <em>Susceptible</em> and <em>Zombie</em> group. The <em>Infected</em> group will move randomly around as in the <em>Initial phase</em>. The third phase will be the <em>Counter attack</em>. Where the <em>Susceptible</em> group will stop running and then counter attack the zombies. The strength of the attack depends on the density of humans around. If the density of humans is high in an area, the strength of the <em>Susceptible</em> group will increase. This is not the case for the <em>Zombie</em> group. The simulation will be performed for 34 minutes, where the three phases have been scaled down from days to minutes. This simulation will not be able to say anything about the result for 34 days. This will demand other values. This result will give an insight into how human behavior will affect the result.  
<br />
<br />
The <em>Susceptible</em> group will at initial time be split into three groups. The distribution in the groups will be based on a Gaussian distribution explained in Sec.(<a href="#sec:monte_carlo_methods">Monte Carlo methods</a>). The <em>Susceptible</em> groups are placed at the following positions: 21 humans at position(6,6), 200 humans at position(12,25) and 400 humans at (25,12). The initial position for the zombie is randomly placed around for all simulations. 200 simulations are performed. Screenshots from a simulation can be seen in Fig.(<a href="#fig:screenshots_three_phases">36</a>). 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 36:  <a name="fig:screenshots_three_phases"></a> Three screenshots from a simulation of the three phases. I: Shows the initial position of the <em>Susceptible</em> and <em>Zombie</em> group. II: Shows the position and number before the <em>Hysterical phase</em>. III: shows the result after the <em>Hysterical phase</em>. </p></center>
<p><img src="3_fig/three_phases_random.png" align="bottom" height=800 width=300></p>
</center>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 37:  The standard deviation of three phases compared to an ODE simulation. </p></center>
<p><img src="3_fig/three_phases_ODE_sd.png" align="bottom" height=500 width=500></p>
</center>

<p>
<!-- Data: 187 success -->
<!-- Eradication 3:0 -->
<!-- Eradication 33:0 -->
<!-- Eradication 34:0 -->

<p>
By studying the Tab.(<a href="#table:compare_ODE_random">table:compare_ODE_random</a>)The three phases gives the <em>Susceptible</em> group a greater chance of staying alive. One can see that there are only 1 person from the <em>Susceptible</em> group that dies in the Hysterical phase compared to 4 in the ODE simulation. The similar result can be seen for the <em>Zombie</em> group. There are several that dies in the ODE simulation that in the Random walk simulation. This can be explained by the fact that the <em>Susceptible</em> group tries to avoid fights by running away. 

<p>
<a name="table:compare_ODE_random"></a>
<table border="1">
<thead>
<tr><th align="center">                </th> <th align="center">               ODE               </th> <th align="center">           Random walk           </th> <th align="center">            Free areas           </th> </tr>
</thead>
<tbody>
<tr><td align="center">   Initial phase       </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   71                                   </td> <td align="center">   340                                  </td> <td align="center">   289.05                               </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   231                                  </td> <td align="center">   149                                  </td> <td align="center">   144.42                               </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   299                                  </td> <td align="center">   123                                  </td> <td align="center">   174.26                               </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   21                                   </td> <td align="center">   10                                   </td> <td align="center">   14.263                               </td> </tr>
<tr><td align="center">   Hysterical phase    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   62                                   </td> <td align="center">   326                                  </td> <td align="center">   287.57                               </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   0                                    </td> <td align="center">   0                                    </td> <td align="center">   0.0                                  </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   359                                  </td> <td align="center">   15                                   </td> <td align="center">   294.21                               </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   202                                  </td> <td align="center">   280                                  </td> <td align="center">   40.210                               </td> </tr>
<tr><td align="center">   Counter attack      </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> <td align="center">   ---------------------------------    </td> </tr>
<tr><td align="center">   Susceptible         </td> <td align="center">   58                                   </td> <td align="center">   326                                  </td> <td align="center">   287.57                               </td> </tr>
<tr><td align="center">   Infected            </td> <td align="center">   1                                    </td> <td align="center">   0.0                                  </td> <td align="center">   0.0                                  </td> </tr>
<tr><td align="center">   Zombie              </td> <td align="center">   332                                  </td> <td align="center">   14                                   </td> <td align="center">   293.94                               </td> </tr>
<tr><td align="center">   Removed             </td> <td align="center">   231                                  </td> <td align="center">   282.0                                </td> <td align="center">   40.473                               </td> </tr>
</tbody>
</table>
<p>
<!-- susc265.2 -->
<!-- inf 139.2 -->
<!-- zom 192.4 -->
<!-- rem 16.2 -->
<!-- ODE susc 76.3257731062 -->
<!-- ODE inf 232.837911837 -->
<!-- ODE zom 292.086820699 -->
<!-- ODE rem 20.7494943579 -->
<!-- susc172.2 -->
<!-- inf 1.0 -->
<!-- zom 250.4 -->
<!-- rem 189.4 -->
<!-- ODE susc 66.2402712021 -->
<!-- ODE inf 0.302849884509 -->
<!-- ODE zom 345.609711654 -->
<!-- ODE rem 209.847167259 -->
<!-- susc170.6 -->
<!-- inf 1.2 -->
<!-- zom 238.4 -->
<!-- rem 202.8 -->
<!-- ODE susc 62.2706113563 -->
<!-- ODE inf 1.20422990329 -->
<!-- ODE zom 317.700755652 -->
<!-- ODE rem 240.824403089 -->

<h2>Free areas for the <em>Susceptible</em> group  <a name="___sec48"></a></h2>
The last advantage the <em>Susceptible</em> group will get, is to be able to move into buildings to escape the zombies. A similar thing was done for in the previous chapter, <em>PDE models</em>, however the effect is more efficient here. The free areas are found by using the pixel values for the backgroud picture. The value of the buildings is similar for all buildings, and is used to control the direction of the <em>Zombie</em> group. Nothing is done for the <em>Susceptible</em> group. The movement pattern for the susceptible students will only be affected by the positions of the zombies. A screenshot after 10 minutes can be seen in Fig.(<a href="#fig:screenshot_three_phases_free">38</a>)

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 38:  <a name="fig:screenshot_three_phases_free"></a> A screenshot of the situation after 10 minutes. </p></center>
<p><img src="3_fig/screenshot_three_phases_free.png" align="bottom" height=500 width=600></p>
</center>

<p>
One can see from Fig.(<a href="#fig:screenshot_three_phases_free">38</a>) that the humans moves into the buildings. These are not defined as any free areas. However, the zombies are not able to go in here, and the result is that this becomes the desired area for the humans. By studying Fig.(<a href="#fig:three_phases_free">39</a>), one can see that the change in amount of zombies and humans flattens out over time, this can be explained by the fact that the humans are now able to avoid battles. 

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 39:  <a name="fig:three_phases_free"></a> </p></center>
<p><img src="3_fig/three_phases_free.png" align="bottom" height=500 width=500></p>
</center>

<p>
The <em>Counter attack</em> phase in negligible. Since the humans are able to avoid connections with the zombies, the counter attack disappears.

<h1>Conclusion  <a name="___sec49"></a></h1>
The results from the English boarding school shows that the maximum concentration of the <em>Infected</em> is reduced when using random walk to simulate the disease. The incubation time for influenza has one day as the shortest incubation time. The model used for the English boarding school is a SIR model, and skips this incubation phase. This will not be the case for the random walk. The incubation time is set to one time step for the random simulation.
<br />
<br />
Another result from the English boarding school was the number of successful epidemic simulations. 25 % of the simulations resulted in no epidemic situation. The infected student was transposed to the <em>Removed</em> group before he was able to infect other students. When modelling closed systems, specially with a small group, the chance of an epidemic is lower than for a larger group.  
<br />
<br />
The zombiefication part for this chapter was only modeled for minutes. The idea was to study the effect of human behavior. The average result from the random walk simulations in Fig.(<a href="#fig:walking_dead">33</a>) showed a large standard deviation for the groups. It is therefore difficult to predict the result. The similar situation was for the other condition moving smart. This condition was first given to improve the humans ability to survive. With a small group of zombies, this was the case. However, when the group of zombies increased the cooperation force become strong. These simulations were performed on a small area which gave the zombies an advantage. It was then easier for the <em>Zombie</em> group to surround the <em>Susceptible</em> group. This leads to a total eradication in about 50 percent of the simulations done for the moving smart simulation.
<br />
<br />
The two lasts sections consists of simulations of all three phases from <em>Walking Dead</em>. These are modeled for a shorter time than the series. However, these simulations gives some interesting results. The first simulation of the three phases tries to add the movement pattern that is realistic based on the series <em>Walking Dead</em>. This result in the ability to avoid battles, and the loss of <em>Susceptible</em> is reduced. An interesting study further, would be if the moving smart phase could compensate for the changes in parameter values in each phase. The idea by changing the parameter values in the ODE and PDE systems, is to illustrate changes in the behavior. The last simulation add the free areas for the <em>Susceptible</em> group. A similar thing was done for the PDE system in the previous chapter. However, the expected result was easier achieved in this simulation. It is interesting to see that the preferred area for the humans was the buildings. The <em>Susceptible</em> group had no knowledge about the safety in the buildings, only a desire to avoid the zombies. 

<p>
Zombiefication

<dl>
<dt>%s<dd>
  Random walk gives a high standard deviation for a small group
<dt>%s<dd>
  Different conditions based on the phases. More realistic simulations
<dt>%s<dd>
  Moving smart, advantage for who?
<dt>%s<dd>
  Eradication
<dt>%s<dd>
  Three phases gives a more realistic picture
<dt>%s<dd>
  Free areas are good for the susceptible
</dl>

<h1>Discussion and conclusion  <a name="___sec50"></a></h1> <hr>
This paper has used three different systems to model epidemic diseases. These three models gives different possibilities related to the adaptation to real epidemic situations. The first chapter <em>ODE systems</em>, models the changes in different groups based on the time aspect. This does not take into account the spatial distribution and is easy to use if a model should be adapted to a already given result, or if the simulation is done for a large, uniform group. The three phases in <em>Walking Dead</em> were modeled by adjusting the parameter values to fulfill the expected amount for each group. The model is good to use in the result is known. However, since the spatial factor plays a major role in how a disease spred, this model will not take this information into account. 
<br />
<br />
The chapter <em>PDE models</em> added the spatial factor. From the English boarding school, one could see that the position of the infected student had a major impact on the result. This was expanded for the <em>Zombiefication</em> model, where the <em>Susceptible</em> group was spread. One could see that the positions for the groups was important. This chapter also introduce <em>Ten minutes at Frederikke</em>, where the idea is to add human behavior to the model. The diffusion term gave restrictions for the areas where the zombies could move, which resulted i a higher amount of humans that survived. This idea did not work that good, since the concentrations in a PDE system wants fullfil equilibirum. 
<br />
<br />
Random walk gave the opportunity to add human behavior in an easier way. Since the random walk model is based on a set of choises that the random walker needs to do every time step, the expected behavoir can be implemented. Compared to <em>Walking Dead</em>, the different conditions in the random walk model reflects the behavior from the humans and zombies in the series. The moving smart condition takes away some of the random walk aspect. However, it also adds a more realistic behavoir. By presenting the situation where a zombie outbust would happen, a random walk would not be a natural and realistic way to move. Neither for a larger group. 
<br />
<br />
The idea by adding areas where the zombies could not move, worked a lot better for the random walk model than the PDE model. The group that was simulated here, aws quite small and the result would may differ if the group was larger. The focus in this thesis has been on small groups the the ability to add human behavior. The random walk model was the one that gave the best results. However, it also demands most computational force.

<h2>Further work  <a name="___sec51"></a></h2>
It would be interesting to expand the random model by simulating for a longer time scale with a higher amount of people. The code in this thesis has been written i python,which results in a slow simulating. By paralellisizing the code and divide the different simulations into different areas, one could done a more qualified simulation of a zombie outburst.
<br />
<br />
The idea of adding more parameters to the random walker, would make it more realistic. The skills for a human was similar for all in the <em>Susceptible</em> group. This is not the case in the real world. All humans have different skills and would behave different in meeting with a zombie. Interesting skills to add would be:

<ul>
<li> weapons for the <em>Susceptible</em> group</li>
<li> noise sensitive for the <em>Zombie</em> group</li>
<li> The ability to cooperate</li>
</ul>

This would all make the random walk model more realistic in the idea of simulating a zombie outburst.

<h1>Bibliography  <a name="___sec52"></a></h1>

<p>
<!-- begin bibliography -->

<ol>
 <li> <a name="murray2002mathematical"></a> <b>J. Murray</b>. 
    <em>Mathematical Biology: I. an Introduction</em>,
    Springer,
    2002,
    <a href="http://books.google.no/books?id=4WbpP90Gk1YC" target="_self"><tt>http://books.google.no/books?id=4WbpP90Gk1YC</tt></a>.</li>
 <li> <a name="isham1988mathematical"></a> <b>V. Isham</b>. 
    Mathematical Modelling of the Transmission Dynamics of HIV Infection and AIDS: a Review,
    <em>Journal of the Royal Statistical Society. Series A (Statistics in Society)</em>,
    pp. 5-49,
    1988.</li>
 <li> <a name="perelson1999mathematical"></a> <b>A. S. Perelson and P. W. Nelson</b>. 
    Mathematical Analysis of HIV-1 Dynamics in Vivo,
    <em>SIAM review</em>,
    41(1),
    pp. 3-44,
    1999.</li>
 <li> <a name="xiao2013predicting"></a> <b>Y. Xiao, S. Tang, Y. Zhou, R. J. Smith, J. Wu and N. Wang</b>. 
    Predicting the HIV/AIDS Epidemic and Measuring the Effect of Mobility in Mainland China,
    <em>Journal of Object Technology</em>,
    317,
    pp. 271-285,
    2013.</li>
 <li> <a name="munz2009zombies"></a> <b>P. Munz, I. Hudea, J. Imad and R. J. Smith</b>. 
    When Zombies Attack!: Mathematical Modelling of an Outbreak of Zombie Infection,
    <em>Infectious Disease Modelling Research Progress</em>,
    4,
    pp. 133-150,
    2009.</li>
 <li> <a name="zombie-math"></a> <b>H. P. Langtangen, K.-A. Mardal and P. R\otnes</b>. 
    Escaping the Zombie Threat by Mathematics,
    Zombies in the Academy: living death in higher education,
    edited by <b>C. M. A. Whelan and R. Walker</b>,
    University of Chicago Press,
    Chapter 3.6,
    pp. pp. x-y,
    2013.</li>
 <li> <a name="walking_dead"></a> <b>F. Darabont and G. A. Hurd</b>. 
    Walking Dead: Season 1,
    2010-2011.</li>
 <li> <a name="CBC_deaths_2011"></a> <b>D. L.Hoyert and J. Xu</b>. 
    Deaths:Preliminary Data for 2011,
    <em>Division of Vital Statistics</em>,
    2012.</li>
 <li> <a name="CBC_births_2012"></a> <b>J. A. Martin, B. E. Hamilton, M. J. Osterman, S. C. Curtin and T. Mathews</b>. 
    Births: Final Data From 2012,
    <em>Division of Vital Statistics</em>,
    2013.</li>
<li> <a name="murray2003mathematical"></a> <b>J. Murray</b>. 
    <em>Mathematical Biology II: Spatial Models and Biomedical Applications</em>,
    Springer,
    2003,
    <a href="http://books.google.no/books?id=2d-RLuD\_MX8C" target="_self"><tt>http://books.google.no/books?id=2d-RLuD\_MX8C</tt></a>.</li>
<li> <a name="hjorth2011computational"></a> <b>M. Hjorth-Jensen</b>. 
    Computational Physics,
    <em>Lecture notes</em>,
    2011.</li>
</ol>

<!-- end bibliography -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

